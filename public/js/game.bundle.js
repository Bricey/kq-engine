!function(e){function t(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var a={};t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=28)}([function(e,t,a){!function(t,a){e.exports=a()}(0,function(){return function(e){function t(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";e.exports=a(1)},function(e,t,a){/**
	 * @author Piotr Kowalski <piecioshka@gmail.com> (https://piecioshka.pl/)
	 * @name super-event-emitter
	 * @description Super small (2KB) and simple interpretation of popular event management.
	 * @version 4.1.4
	 * @license MIT
	 * @example
	 * var bar = {}; // Or any other object.
	 * EventEmitter.mixin(bar);
	 * bar.on('foo', function () {
	 *     console.log('foo event emitted');
	 * });
	 * bar.emit('foo');
	 */
"use strict";function n(e,t){if("forEach"in Array.prototype)e.forEach(t);else for(var a=0;a<e.length;a+=1)t(e[a])}function o(e,t){if("filter"in Array.prototype)return e.filter(t);for(var a=[],n=0;n<e.length;n+=1){var o=e[n];t(o)&&a.push(o)}return a}function i(e,t){if(!e)throw new Error(t)}function r(e){return"string"==typeof e}function s(e){return"function"==typeof e}function l(){return this instanceof l?void(this._listeners=[]):new l}var h=a(2),c={on:function(e,t,a){return i(r(e),"EventEmitter#on: name is not a string"),i(s(t),"EventEmitter#on: fn is not a function"),a=a||this,this._listeners.push({name:e,fn:t,ctx:a}),this},once:function(e,t,a){function n(){t.apply(a,arguments),o.off(e,n)}a=a||this;var o=this;return this.on(e,n,a),this},off:function(e,t){return this._listeners=e?o(this._listeners,function(a){return a.name!==e||!!s(t)&&a.fn!==t}):[],this},emit:function(e,t){return i(r(e),"EventEmitter#emit: name is not a string"),n(this._listeners,function(a){a.name===e&&a.fn.call(a.ctx,t),/^all|\*$/.test(a.name)&&a.fn.call(a.ctx,e,t)}),this}};c.addEventListener=c.addListener=c.bind=c.on,c.removeEventListener=c.removeListener=c.unbind=c.off,c.dispatchEventListener=c.dispatchListener=c.trigger=c.emit,l.prototype=c,l.mixin=function(e){var t=new l;for(var a in t)e[a]=t[a];return e},l.prototype.mixin=l.mixin,l.VERSION=h.version,e.exports=l},function(e,t){e.exports={name:"super-event-emitter",description:"Super small (2KB) and simple interpretation of popular event management.",version:"4.1.4",license:"MIT",author:{name:"Piotr Kowalski",email:"piecioshka@gmail.com",url:"https://piecioshka.pl/"},scripts:{build:"webpack --profile",watch:"webpack -w",test:"jasmine JASMINE_CONFIG_PATH=test/unit/jasmine.json",coverage:"istanbul cover jasmine JASMINE_CONFIG_PATH=test/unit/jasmine.json",coveralls:"npm run coverage && cat ./coverage/lcov.info | coveralls -v"},repository:{type:"git",url:"http://github.com/piecioshka/super-event-emitter.git"},devDependencies:{coveralls:"^2.11.12",istanbul:"^0.4.4",jasmine:"^2.4.1","json-loader":"^0.5.4","string-replace-loader":"^1.0.3",webpack:"^1.12.14"},files:["dist","lib","index.js","package.json","README.md"],keywords:["super","event","emitter","mixin","on","off","emit","trigger","simple"],main:"./dist/super-event-emitter.min.js"}}])})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BOOTSTRAP_COMPLETED:"state:bootstrap-completed",LOADING_COMPLETED:"state:loading-completed",EXAMPLE_COMPLETED:"state:example-completed"}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PickupItem=void 0;var r=a(18),s=function(e){return e&&e.__esModule?e:{default:e}}(r);t.PickupItem=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",l=arguments[4],h=arguments[5],c=arguments[6];n(this,t);var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,l,h));return u.initPowerup=function(){"health"===u.data.class?(u.game.sfx.play("sfx_health"),u.game.player.restoreHealth(s.default[u.data.subClass])):"maxHealth"===u.data.class||"increaseMaxHealth"===u.data.class&&(u.game.data.players.jasonKenney.maxHealth+=2,u.game.player.maxHealth+=2,u.game.healthPanel.redrawIcons(),u.game.player.restoreHealth(u.game.player.maxHealth))},u.initInventoryItem=function(e){console.log("INVENTORY ITEM ADDED!"),u.game.player.data.inventory.length<5&&(u.game.player.data.inventory.push(s.default[e.itemName]),console.log("ITEM ADDED",u.game.player.data.inventory),u.game.sfx.play("sfx_item"),u.game.dialogue.alert(e.itemName+" acquired!","acquired"),void 0!==e.initFunction&&u.game.npcFunctions[e.initFunction]())},u.game=e,u.data=h,u.frameName=null===l?u.data.subClass+".png":l+".png",c&&"powerup"===u.data.key&&(e.physics.arcade.enable(u),u.body.onOverlap=new Phaser.Signal,u.body.immovable=!0,u.body.collideWorldBounds=!0,u.body.setSize(16,16,0,0),u.anchor.setTo(.5),u.game.pickupGroup.add(u),u.body.velocity.x=60*Phaser.Utils.randomChoice(1,-1),u.body.velocity.y=60*Phaser.Utils.randomChoice(1,-1),u.velocityTimer=u.game.time.events.add(300,function(){u.body.velocity.setTo(0)})),u}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.NPC=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return e.add.existing(h),e.physics.arcade.enable(h),h.body.collideWorldBounds=!0,l.isCompanion||(h.body.immovable=!0),l.isCompanion||(h.body.onCollide=new Phaser.Signal),h.data=l,l.engageDistance&&(h.engageDistance=l.engageDistance),h.movementTimer=null,h.anchor.setTo(.5),h.body.setSize(36,40,0,8),h.currentState="_PAUSED",h.isType="NPC",h.static=l.static,h._SPEED=h.data.speed||40,h.isMoving=!1,h.hasMoveAssignment=!1,h.animSpeed=6,"John Horgan"!==l.character?(h.animations.add("walk-forward",Phaser.Animation.generateFrameNames("npc-"+l.id+"-mf/_0",1,4,".png"),h.animSpeed,!0),h.animations.add("walk-backward",Phaser.Animation.generateFrameNames("npc-"+l.id+"-mb/_0",1,4,".png"),h.animSpeed,!0),h.animations.add("walk-left",Phaser.Animation.generateFrameNames("npc-"+l.id+"-ml/_0",1,4,".png"),h.animSpeed,!0),h.animations.add("walk-right",Phaser.Animation.generateFrameNames("npc-"+l.id+"-mr/_0",1,4,".png"),h.animSpeed,!0),h.animations.add("laugh",Phaser.Animation.generateFrameNames("npc-"+l.id+"-laf/_0",1,2,".png"),4,!0),h.animations.add("celebrate",Phaser.Animation.generateFrameNames("npc-"+l.id+"-cel/_0",1,2,".png"),4,!0),s?h.frameName=s:(console.log(h.data.character),h.animations.play("walk-forward").stop())):h.animations.add("gesticulate",Phaser.Animation.generateFrameNames("horgan_",0,1,".png"),6,!0),16===l.id&&(h.animations.add("show-crystal",Phaser.Animation.generateFrameNames("npc-16-crystal/_0",1,1,".png"),1,!1),h.animations.add("dance",Phaser.Animation.generateFrameNames("npc-16-pride-cel/_0",0,1,".png"),6,!0)),19===l.id&&h.body.setSize(52,88,0,0),12===l.id&&h.data.dying&&h.animations.add("wounded",Phaser.Animation.generateFrameNames("npc-12-death/_0",1,2,".png"),7,!0),45===l.id&&h.body.setSize(130,72,0,0),h.static||h.assignMovementCoords(),h.data.isCompanion&&(h.animSpeed=1),h}return i(t,e),r(t,[{key:"update",value:function(){if(this.game.player.isTalking||this.game.player.questsActive||this.game.player.inventoryActive)return void this.body.velocity.setTo(0);if(this.data.isCompanion&&this.data.isFollowing)return void(this.game.physics.arcade.distanceBetween(this,this.game.player)>=120?(this.currentState,this.game.physics.arcade.moveToObject(this,this.game.player,this.game.player.maxSpeed/1.2),this.animations.play("walk-"+this.calcMovementDirection()),this.game.physics.arcade.distanceBetween(this,this.game.player)>=500&&this.position.setTo(this.game.player.x+36,this.game.player.y)):(this.animations.stop(),this.currentState,this.body.velocity.setTo(0)));if(!this.static)if("_MOVING"===this.currentState);else if("_PAUSED"===this.currentState)return}},{key:"assignMovementCoords",value:function(){var e=this;this.isMoving=!0,this.body.velocity.set(this.game.rnd.integerInRange(-1,1)*this._SPEED,this.game.rnd.integerInRange(-1,1)*this._SPEED),this.animations.play("walk-"+this.calcMovementDirection()),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1200,2200),function(){e.isMoving=!1,e.setPauseState()})}},{key:"calcMovementDirection",value:function(){var e=this.body.velocity.x,t=this.body.velocity.y;return 0===t?0===e?"forward":e<0?"right":"left":t<0?"backward":"forward"}},{key:"setPauseState",value:function(){var e=this;this.animations.stop(),this.frameName="npc-"+this.data.id+"-mf/_01.png",this.body.velocity.set(0),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1500,2600),function(){e.assignMovementCoords()})}},{key:"setWalkingState",value:function(){}},{key:"stopMovement",value:function(){this.game.time.events.remove(this.movementTimer),this.body.velocity.set(0)}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.Obj=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));switch(h.setNode=function(){h.anchor.setTo(.5,1),h.frameName="trigger.png"},h.setCrystalHolder=function(){h.anchor.setTo(.5),h.frameName="crystal-holder.png",h.game.physics.arcade.enable(h),h.body.immovable=!0,h.isType="OBJECT";var e=h.game.add.sprite(0,8,"sprites","lightening-01.png");e.anchor.setTo(.5,0),e.animations.add("pulse",Phaser.Animation.generateFrameNames("lightening-0",1,2,".png"),10,!0),e.animations.play("pulse"),h.addChild(e)},h.setSigil=function(){h.anchor.setTo(.5,1),h.frameName="sygil-"+h.data.colour+"-off.png",h.game.physics.arcade.enable(h),h.body.immovable=!0,h.engageDistance=90,h.body.setSize(32,32,0,32),h.isType="OBJECT",h.activated=!1},h.setSmartCar=function(){if(h.anchor.setTo(.5),h.game.physics.arcade.enable(h),h.body.immovable=!0,h.body.setSize(55,75,0,12),h.frameName="smartcar_"+h.data.colour+"_00.png",h.animations.add("drive",Phaser.Animation.generateFrameNames("smartcar_"+h.data.colour+"_0",0,1,".png"),6,!0),h.data.flag){var e=h.game.add.sprite(h.width/2,h.height/3,"sprites","flag_ndp_0.png");e.anchor.setTo(.5,1),e.animations.add("drive",Phaser.Animation.generateFrameNames("flag_ndp_",0,1,".png"),5,!0),h.addChild(e)}},h.setFire=function(){h.anchor.setTo(.5,1),h.game.physics.arcade.enable(h),h.body.immovable=!0,h.animations.add("burn",Phaser.Animation.generateFrameNames("fire_",0,7,".png"),8,!0),h.animations.play("burn")},h.setSiegeTower=function(){h.anchor.setTo(.5,.82),h.frameName="siege-tower_0.png",h.game.physics.arcade.enable(h),h.body.immovable=!0,h.body.setSize(64,48,0,80),h.animations.add("drive",Phaser.Animation.generateFrameNames("siege-tower_",0,1,".png"),6,!0)},h.setBrokenSiegeTower=function(){h.anchor.setTo(.5),h.frameName="siege-tower_2.png",h.game.physics.arcade.enable(h),h.body.immovable=!0,h.body.setSize(64,93,0,6)},h.setBoat=function(){h.anchor.setTo(.5),h.frameName="boat.png"},h.setBlueFire=function(){h.anchor.setTo(.5,.92),h.animations.add("burn",Phaser.Animation.generateFrameNames("fire-blue/_0",1,5,".png"),7,!0),h.animations.play("burn")},h.setSign=function(){h.frameName="trigger.png",h.game.physics.arcade.enable(h),h.body.setSize(40,40,0,0),h.body.immovable=!0,h.anchor.setTo(.5),h.isType="OBJECT",h.targetDistance=72},h.setTruck=function(){h.game.physics.arcade.enable(h),h.body.onCollide=new Phaser.Signal,h.body.immovable=!0,h.anchor.setTo(.5),h.isType="OBJECT";var e=h.parseCoords(h.data.direction);if(h.animations.add("drive-LR",Phaser.Animation.generateFrameNames(h.data.colour+"_0",1,2,".png"),5,!0),h.animations.add("drive-down",Phaser.Animation.generateFrameNames(h.data.colour+"_0",3,4,".png"),5,!0),h.animations.add("drive-up",Phaser.Animation.generateFrameNames(h.data.colour+"_0",5,6,".png"),5,!0),h.engageDistance=120,0!==e[0]?(h.frameName=h.data.colour+"_01.png",h.scale.x=e[0],h.body.setSize(192,50,0,38)):(h.body.setSize(56,100,10,26),e[1]>0?h.frameName=h.data.colour+"_03.png":h.frameName=h.data.colour+"_05.png"),h.data.flag){var t=h.data.ndp?"ndp":"ucp",a=h.game.add.sprite(0,0,"sprites","flag_"+t+"_0.png");a.anchor.setTo(.5,0),a.animations.add("drive",Phaser.Animation.generateFrameNames("flag_"+t+"_",0,1,".png "),5,!0),h.addChild(a),console.log("FLAG ADDED!")}"sigil-truck"===h.data.objectType&&(h.isHonking=!1)},h.setPantheonStatue=function(){h.isType="OBJECT",h.game.physics.arcade.enable(h),h.body.immovable=!0,h.body.onCollide=new Phaser.Signal,h.anchor.setTo(.5),h.frameName="pantheon-statue.png",h.scale.x=1*h.data.direction},h.setBBQ=function(){h.game.physics.arcade.enable(h),h.body.onCollide=new Phaser.Signal,h.body.immovable=!0,h.anchor.setTo(.5),h.frameName="barbecue.png",h.body.setSize(64,30,0,9),h.isType="OBJECT";var e=h.game.add.sprite(0,0,"sprites","bbq-smoke/_01.png");console.log("SMOKE IS",e),e.animations.add("smoke",Phaser.Animation.generateFrameNames("bbq-smoke/_0",1,3,".png"),5,!0),e.animations.play("smoke"),h.addChild(e)},h.parseCoords=function(e){var t=[],a=e.split(",");return t.push(parseInt(a[0])),t.push(parseInt(a[1])),t},h.game=e,h.data=l,h.game.objGroup.add(h),h.data.objectType){case"blue-fire":h.setBlueFire();break;case"sign":case"chest":h.setSign();break;case"truck":h.setTruck();break;case"pantheon-statue":h.setPantheonStatue();break;case"bbq":h.setBBQ();break;case"sigil":h.setSigil();break;case"boat":h.setBoat();break;case"siege-tower":h.setSiegeTower();break;case"broken-siege-tower":h.setBrokenSiegeTower();break;case"fire":h.setFire();break;case"smartcar":h.setSmartCar();break;case"sigil-truck":h.setTruck();break;case"waypoint-node":h.setNode();break;case"crystalHolder":h.setCrystalHolder()}return h}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2),l=a(18);(function(e){e&&e.__esModule})(l),t.Player=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));h.displayCrystals=function(){var e=h.data.crystals.length;console.log("CRYSTALS",h.data.crystals);for(var t=0;t<3;t++){var a=t<e?"ui-crystal-active.png":"ui-crystal-inactive.png",n=h.game.add.sprite(h.game.camera.width/2-40+30*t,30,"sprites",a);"ui-crystal-inactive.png"===a&&(n.alpha=.55),n.fixedToCamera=!0,n.anchor.setTo(.5),n.scale.setTo(.85),h.game.UIGroup.add(n)}},h.updateCrystals=function(){},h.stop=function(){h.animations.stop();var e=h.game.atlas[h.game.currentStage].isDungeon?"maf":"mf";h.frameName="hero-"+e+"/_01.png"},h.addQuest=function(e,t){if(h.data.quests.find(function(t){return t.id===e})||h.data.completedQuests.find(function(t){return t===e}))return void console.log("already exists or has been completed");h.data.quests[h.game.player.data.quests.length++]=h.game.quests[e],console.log("!!!!!!!!!!!!!!!!!!! ADDING QUEST:"),console.log(h.game.player.data.quests),h.game.dialogue.alert("Quest acquired!","acquired"),h.updateWaypoints(e,t)},h.updateQuest=function(e,t,a){console.log("quest id is:",e),console.log("preveNodeIndex is",t);for(var n=0;h.data.quests.length>n;n++){if(h.data.quests[n].id===e){h.data.quests[n].nodes[t].complete=!0;var o=t+1;return console.log("node list is:",h.data.quests[n].nodes),console.log("next node is:",h.data.quests[n].nodes[o]),a?void 0===h.data.quests[n].nodes[o]?(console.log("Returned untrue"),h.removeQuest(e),"quest complete"):h.data.quests[n].nodes[o]:void 0}if(n===h.data.quests.length-1&&(h.addQuest(e),a))return h.data.quests[h.game.player.data.quests.length-1].nodes[t++]}},h.getQuestTarget=function(e,t){console.log("Returning: "+e+", "+t)},h.removeQuest=function(e){for(var t=0;h.data.quests.length>t;t++)h.game.player.data.quests[t].id===e?(console.log("WE HAVE A MATCH"),console.log("i equals "+t),h.data.quests.splice(t,1),h.data.completedQuests.push(e),h.game.dialogue.alert("Quest completed!","completed")):console.error("removeQuest fn: No quest with given id found")},h.getPlayerQuestIndex=function(e){var t=h.data.quests,a=0;return t.map(function(t,n){t.id===e&&(console.log("FOUND MATCHING QUEST in getPlayerQuestIndex",t,n),a=n)}),a},h.updateWaypoints=function(e,t){console.log("waypoints",h.game.waypointGroup.children);h.game.waypointGroup.children;console.log("PLAYER CURRENT QUESTS",h.data.quests);var a=h.data.quests[h.getPlayerQuestIndex(e)];console.log(a);var n=a.nodes.find(function(e){if(!1===e.complete)return e});console.log("activeQuestNode is:",n),t&&void 0!==n?h.game.mapWorld.createSingleCharacterQuestWaypoint(n):(console.log("ACTIVE QUEST NODE IS: ",n.target),h.game.mapWorld.updateWaypoint(n.target))},h.hasItem=function(e){return void 0!==h.data.inventory.find(function(t){return t.id===e})},h.crystalAcquired=function(e,t){h.game.musicHandler.stop(),h.game.musicHandler.play("achievement"),h.game.time.events.add(4840,function(){h.game.musicHandler.setMusic(h.game.currentStage)}),h.game.data.players.jasonKenney.crystals.push(e),h.frameName="hero-cheer/_01.png",h.game.dialogue.alert(e+" acquired!"),h.game.time.events.add(3e3,function(){h.frameName="hero-maf/_01.png",t&&t()})},e.add.existing(h),e.physics.arcade.enable(h),h.data=l,h.anchor.setTo(.5),h.body.collideWorldBounds=!0,h.body.setSize(36,48,0,0),h.maxHealth=h.data.maxHealth,h.isHit=!1,h.isTalking=!1,h._STRIKE_VELOCITY=480,h.maxSpeed=500,h.isAttacking=!1,h.inventoryActive=!1,h.questsActive=!1,h.health=h.data.health,h.health>h.maxHealth&&(h.health=h.maxHealth);var c=null;switch(h.game.currentCharacter){case"jasonKenney":c=h.game.data.players.jasonKenney.inDisguise?"npc-48":"hero";break;case"rachelNotley":c="npc-16";break;case"derekFildebrandt":c="npc-33"}return h.animations.add("walk-forward",Phaser.Animation.generateFrameNames(c+"-mf/_0",1,4,".png"),6,!0),h.animations.add("walk-backward",Phaser.Animation.generateFrameNames(c+"-mb/_0",1,4,".png"),6,!0),h.animations.add("walk-left",Phaser.Animation.generateFrameNames(c+"-ml/_0",1,4,".png"),6,!0),h.animations.add("walk-right",Phaser.Animation.generateFrameNames(c+"-mr/_0",1,4,".png"),6,!0),h.animations.add("armed-forward",Phaser.Animation.generateFrameNames("hero-maf/_0",1,4,".png"),6,!0),h.animations.add("armed-backward",Phaser.Animation.generateFrameNames("hero-mab/_0",1,4,".png"),6,!0),h.animations.add("armed-left",Phaser.Animation.generateFrameNames("hero-mal/_0",1,4,".png"),6,!0),h.animations.add("armed-right",Phaser.Animation.generateFrameNames("hero-mar/_0",1,4,".png"),6,!0),h.attackFwd=h.animations.add("attack-forward",Phaser.Animation.generateFrameNames("hero-af/_0",1,3,".png"),12,!1),h.attackBwd=h.animations.add("attack-backward",Phaser.Animation.generateFrameNames("hero-ab/_0",1,3,".png"),12,!1),h.attackLft=h.animations.add("attack-left",Phaser.Animation.generateFrameNames("hero-al/_0",1,3,".png"),12,!1),h.attackRgt=h.animations.add("attack-right",Phaser.Animation.generateFrameNames("hero-ar/_0",1,3,".png"),12,!1),h.animations.add("death",Phaser.Animation.generateFrameNames("hero-death-spin/_0",1,4,".png"),6,!0),h.attackFwd.onComplete.add(h.resetAttackState,h),h.attackBwd.onComplete.add(h.resetAttackState,h),h.attackLft.onComplete.add(h.resetAttackState,h),h.attackRgt.onComplete.add(h.resetAttackState,h),h.currentState="_NEUTRAL",h}return i(t,e),r(t,[{key:"update",value:function(){"_NEUTRAL"!==this.currentState&&this.currentState}},{key:"engage",value:function(){if(console.log("ACTIVATING ENGAGE!!!"),!this.questsActive&&!this.inventoryActive){for(var e=[],t=e.concat(this.game.enemyGroup.children,this.game.NPCGroup.children,this.game.objGroup.children),a=0;t.length>a;a++){var n=t[a],o=this.game.physics.arcade.angleToXY(n,this.x,this.y),i=n.engageDistance||62;if(console.log("TARGET ANGLE:",o),console.log("DISTANCE?:",this.game.physics.arcade.distanceBetween(n,this)<=i),this.game.physics.arcade.distanceBetween(n,this)<=i)if(console.log("CHECKING TARGET ANGLE"),"BOSS"===n.isType){if(o<2.9&&o>.312)return void this.confirmTarget("backward",n)}else{if(o>-.785&&o<.785)return Phaser.Device.desktop&&this.getPlayerDirection(),void this.confirmTarget("left",n);if(o>.785&&o<2.356)return Phaser.Device.desktop&&this.getPlayerDirection(),void this.confirmTarget("backward",n);if(o<-.785&&o>-2.356)return Phaser.Device.desktop&&this.getPlayerDirection(),void this.confirmTarget("forward",n);if(o>-2.356||o<-2.356)return Phaser.Device.desktop&&this.getPlayerDirection(),void this.confirmTarget("right",n)}}this.game.atlas[this.game.currentStage].isDungeon&&this.attack(this.getPlayerDirection(),null)}}},{key:"confirmTarget",value:function(e,t){switch(t.isType){case"ENEMY":"jasonKenney"===this.game.currentCharacter&&this.attack(e,t);break;case"NPC":this.talk(e,t);break;case"OBJECT":this.engageItem(t);break;case"BOSS":this.attack(e,t)}}},{key:"getPlayerDirection",value:function(){var e="";return"walk-forward"===this.animations.currentAnim.name||"armed-forward"===this.animations.currentAnim.name||"attack-forward"===this.animations.currentAnim.name?e="forward":"walk-backward"===this.animations.currentAnim.name||"armed-backward"===this.animations.currentAnim.name||"attack-backward"===this.animations.currentAnim.name?e="backward":"walk-left"===this.animations.currentAnim.name||"armed-left"===this.animations.currentAnim.name||"attack-right"===this.animations.currentAnim.name?e="right":"walk-right"!==this.animations.currentAnim.name&&"armed-right"!==this.animations.currentAnim.name&&"attack-left"!==this.animations.currentAnim.name||(e="left"),e}},{key:"attack",value:function(e,t){if(!this.isAttacking){if(this.body.velocity.setTo(0),this.isAttacking=!0,this.currentState="_ATTACKING",null!==t){this.game.time.events.add(36,function(){t.hit(e)})}switch(e){case"forward":this.attackFwd.play();break;case"backward":this.attackBwd.play();break;case"left":this.attackRgt.play();break;case"right":this.attackLft.play()}}}},{key:"resetAttackState",value:function(){this.isAttacking=!1,this.currentState="_NEUTRAL",this.animations.play("armed-"+this.getPlayerDirection()).stop()}},{key:"read",value:function(e){this.game.dialogue.initRead(e)}},{key:"talk",value:function(e,t){this.game.dialogue.initDialogue(e,t)}},{key:"engageItem",value:function(e){switch(e.data.objectType){case"sign":e.data.hasOwnProperty("itemFunction")?(this.game.npcFunctions[e.data.itemFunction](),e.destroy()):this.game.dialogue.sign(e.data.message,e.data.objectType);break;case"bbq":this.game.camera.flash(16777215,800),this.restoreHealth(this.maxHealth),this.game.sfx.play("sfx_healthFull");break;case"sigil":this.game.actions.activateSigil(e);break;case"sigil-truck":this.game.actions.playHorn(e);break;case"chest":if("Axe Head"===e.data.itemName||"Axe Handle"===e.data.itemName)this.axeCheck(e.data.itemName);else if("Max Health Increased"===e.data.itemName)this.game.data.players.jasonKenney.maxHealth=this.game.data.players.jasonKenney.maxHealth+2,this.game.player.maxHealth=this.game.data.players.jasonKenney.maxHealth,this.game.player.health=this.game.player.maxHealth,this.game.healthPanel.redrawIcons(),this.game.dialogue.alert(""+e.data.itemName,"acquired"),this.game.actions.removeCacheObject("kq02-mountains-00",["type","object"],["objectType","chest"]);else{var t=new s.PickupItem(this.game,0,0,"sprites","trigger.png",e.data);this.game.mapWorld.pickupItem(null,t),this.game.dialogue.alert(""+e.data.itemName,"acquired"),this.game.actions.removeCacheObject("kq02-mountains-00",["type","object"],["objectType","chest"])}e.destroy()}}},{key:"axeCheck",value:function(e){var t=this,a=function(){t.removeInventoryItem("Axe Head"),t.removeInventoryItem("Axe Handle"),t.game.dialogue.alert(e+" acquired! You now have the Great Carbon Tax Axe!","acquired"),t.game.actions.removeCacheObject("kq02-mountains-00",["type","object"],["objectType","chest"],["itemName",e]),e="Great Axe"};"Axe Head"===e&&this.hasItem("Axe Handle")?a():"Axe Handle"===e&&this.hasItem("Axe Head")?a():(this.game.dialogue.alert(e+" acquired!","acquired"),this.game.actions.removeCacheObject("kq02-mountains-00",["type","object"],["objectType","chest"],["itemName",e]));var n={itemName:e,key:"inventoryItem"},o=new s.PickupItem(this.game,0,0,"sprites","trigger.png",n);this.game.mapWorld.pickupItem(null,o)}},{key:"restoreHealth",value:function(e){this.health=this.health+e,this.game.data.players.jasonKenney.health=this.health+e,this.health>this.maxHealth&&(this.health=this.maxHealth),this.game.healthPanel.drawHealthIcons(this.health)}},{key:"removeInventoryItem",value:function(e){var t=this;this.data.inventory.forEach(function(a,n){a.id===e&&t.data.inventory.splice(n,1)})}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Orientation=function(){function e(t){n(this,e),this.game=t,this.game.scale.forceOrientation(!0,!1),this.game.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this),this.game.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this),this.game.device.mobileSafari&&this.safariSetup(),this.game.device.webApp,this.game.device.windowsPhone,this.game.device.firefox,this.game.device.chromeOS,this.game.device.android}return o(e,[{key:"enterIncorrectOrientation",value:function(){this.game.paused=!0,console.log("INCORRECT ORIENTATION!!!!");this.blackScreen?(this.blackScreen.reset(),this.warningText.reset()):(this.blackScreen=this.game.add.graphics(0,0),this.blackScreen.fixedToCamera=!0,this.blackScreen.beginFill(0,.65),this.blackScreen.drawRect(0,0,this.game.width,this.game.height),this.blackScreen.endFill(),this.warningText=this.game.add.text(this.game.camera.width/2,this.game.camera.height/2-20,"Turn your device to play",this.game.data.textStyle),this.warningText.anchor.setTo(.5),this.warningText.fixedToCamera=!0),console.log(this.blackScreen),!this.game.device.desktop&&this.game.controls.stick&&(this.game.controls.stick.visible=!1,this.game.controls.buttonA.visible=!1),this.game.world.bringToTop(this.blackScreen),this.game.world.bringToTop(this.warningText)}},{key:"leaveIncorrectOrientation",value:function(){this.game.paused=!1,this.blackScreen.kill(),this.warningText.kill(),!this.game.device.desktop&&this.game.controls.stick&&(this.game.controls.stick.visible=!0,this.game.controls.buttonA.visible=!0),this.game.scale.refresh()}},{key:"safariSetup",value:function(){}},{key:"androidSetup",value:function(){}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Enemy=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(13),l=a(2);t.Enemy=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return e.add.existing(h),e.physics.arcade.enable(h),h.body.collideWorldBounds=!0,h.body.immovable=!0,h.body.onCollide=new Phaser.Signal,h.data=l,h.anchor.x=.5,h.anchor.y=.5,h.body.setSize(36,40,0,8),h.isType="ENEMY",h.isMoving=!1,h.isPaused=!1,h.isAlerted=!1,h.isAttacking=!1,h.isMovingTimeout=null,h.isPausedTimeout=null,h.isDead=!1,h.prevVel=0,h.movementTimer=null,h.isDead=!1,h}return i(t,e),r(t,[{key:"update",value:function(){}},{key:"faceDirection",value:function(e,t,a){var n=this.game.physics.arcade.angleToXY(this,e,t);if(n>-.785&&n<.785){if(a)return"right"}else if(n>.785&&n<2.356){if(a)return"forward"}else if(n<-.785&&n>-2.356){if(a)return"backward"}else if((n>-2.356||n<-2.356)&&a)return"left"}},{key:"playerHit",value:function(e){var t=this;this.game.player.damage(e),this.game.data.players[this.game.currentCharacter].health=this.game.player.health-e,this.game.player.isHit=!0,this.game.sfx.play("sfx_player_hit"),this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.calcHitDirection(this.game.player,null),this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player),this.game.time.events.add(160,function(){t.game.player.isHit=!1,t.game.player.body.velocity.setTo(0)})}},{key:"calcHitDirection",value:function(e,t){switch(null===t&&(t=this.faceDirection(this.game.player.x,this.game.player.y,!0)),console.log(t),t){case"right":e.body.velocity.set(this.game.player._STRIKE_VELOCITY,0);break;case"backward":e.body.velocity.set(0,-this.game.player._STRIKE_VELOCITY);break;case"forward":e.body.velocity.set(0,this.game.player._STRIKE_VELOCITY);break;case"left":e.body.velocity.set(-this.game.player._STRIKE_VELOCITY,0)}}},{key:"setAttackPauseState",value:function(){this.currentState="_PAUSED",this.isAttacking=!1,this.game.time.events.add(this.game.rnd.integerInRange(600,1e3),function(){this.currentState="_ALERT"},this)}},{key:"calcMovementDirection",value:function(){var e=this.body.velocity.x,t=this.body.velocity.y;return 0===t?0===e?"forward":e<0?"left":"right":t<0?"backward":"forward"}},{key:"setPauseState",value:function(){var e=this;if(null!=this){this.currentState="_PAUSED",this.isPaused=!0,this.animations.stop(),"rat"===this.data.key?this.frameName=this.data.key+"-af/_01.png":this.frameName=this.data.key+"-mf/_01.png",this.body.velocity.setTo(0);this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1500,2600),function(){e.isPaused=!1,e.setPatrolState()})}}},{key:"dropItem",value:function(e,t){console.log("CREATING ITEM:",e);var a=e||"health",n=null,o=null,i=null;if("health"===a){o="powerup";n=Phaser.Utils.chanceRoll(20)?Phaser.Utils.chanceRoll(30)?"super-health":"uber-health":"health"}else"Rat Key Left"!==a&&"Rat Key Right"!==a||(n="ratKey",o="inventoryItem",i=a);var r={class:a,key:o,subClass:n,type:"pickup",itemName:i},s=new l.PickupItem(this.game,t.x,t.y,"sprites",null,r,!0);"health"!==a&&(s.initInventoryItem(s.data),s.destroy())}},{key:"hit",value:function(e){var t=this;this.isDead||(this.currentState="_HIT",this.isAttacking=!1,this.calcHitDirection(this,e),this.health--,this.game.sfx.play("sfx_enemyHit"),"ogre"===this.data.key&&(this.setBallState("_RESTING"),this.game.sfx.stop("sfx_ball"),this.ball.isSwinging=!1,this.setState("_HIT")),this.data.isShooter&&"troll"===this.data.key&&this.stopShooting(),this.health<=0?(this.isDead=!0,this.ball&&(this.ball.chain.kill(),this.ball.kill(),this.game.time.events.remove(this.movementTimer),this.setState("_HIT")),this.data.isShooter&&this.shootingTimer.stop(),this.game.time.events.remove(this.movementTimer),this.body.setSize(0,0,0,0),this.game.sfx.play("sfx_enemy_death"),Phaser.Utils.chanceRoll(33)&&this.dropItem("health",this.position),this.data.dropItem&&this.dropItem(this.data.dropItem,this.position),this.animations.play("death").onComplete.add(function(){t.bodyVelocity&&t.game.time.events.remove(t.bodyVelocity),t.destroy()}),this.bodyVelocity=this.game.time.events.add(160,function(){t.body.velocity.setTo(0)}),(0,s.removeFromCache)(this.game,this.game.currentStage,this.data.index)):this.game.time.events.add(160,function(){t.currentState="_ALERT","ogre"===t.data.key&&t.setState("_ALERT"),t.body.velocity.setTo(0)}))}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=a(17),r=a(3),s=(a(7),a(15)),l=a(34),h=a(35),c=a(2),u=a(21),d=a(54),g=a(43),m=(function(e){e&&e.__esModule}(g),a(4)),p=a(13),y=(t.Map=function e(t,a,o,i){n(this,e),y.call(this),this.context=t,this.game=a,this.mapName=o;if(this.map=this.context.add.tilemap(o),this.map.addTilesetImage(i),this.prevTileIndexContact=0,this.game.waypointGroup=this.context.add.group(),this.game.projectileGroup=this.context.add.group(),this.game.objGroup=this.context.add.group(),this.waypointNodeGroup=[],this.foregroundTiles=[],this.createGroundLayer(),this.createSubDetailLayer(),this.createDetailLayer(),this.createCollisionLayer(),this.createObjectsLayer(),this.createSubForegroundLayer(),this.createForegroundLayer(),this.game.atlas[this.mapName].suppressWaypoints||this.createCharacterQuestWaypoints(),this.setWorldBGImage()){var r=this.game.add.sprite(0,0,this.setWorldBGImage());r.width=this.game.camera.width,r.height=this.game.camera.height,r.alpha=.65,r.fixedToCamera=!0,this.game.world.sendToBack(r)}"kq02-airship-00"===this.map?this.game.stage.backgroundColor="#4488AA":this.game.stage.backgroundColor="#000000"},function(){var e=this;this.setWorldBGImage=function(){switch(e.mapName){case"kq02-pantheon-00":return"bg-pantheon";case"kq02-airship-00":return"bg-clouds"}return!1},this.createGroundLayer=function(){e.groundLayer=e.map.createLayer("ground"),e.groundLayer.sendToBack(),e.groundLayer.resizeWorld(),e.groundLayer.wrap=!0},this.createSubDetailLayer=function(){e.subDetailLayer=e.map.createLayer("subdetail")},this.createDetailLayer=function(){e.detailLayer=e.map.createLayer("detail")},this.createCollisionLayer=function(){e.game.collisionLayer=e.map.createLayer("collision"),e.map.setCollisionBetween(0,3400,!0,e.game.collisionLayer),e.game.physics.arcade.enable(e.game.collisionLayer),e.groundLayer.sendToBack()},this.createObjectsLayer=function(){var t=e.findObjectsByType("mapChange",e.map,"objects");e.game.stagesGroup=e.context.add.group(),t.forEach(function(t){var a=new i.MapChangeSprite(e.context,e.game,t.x,t.y,"sprites",t.properties);void 0!==t.properties.questNodeId&&(e.addWaypoint(a,t.properties.questNodeId),e.waypointNodeGroup.push(a)),e.game.stagesGroup.add(a)}),e.context.physics.arcade.enable(e.game.stagesGroup);var a=e.findObjectsByType("trigger",e.map,"objects");e.game.triggerGroup=e.context.add.group(),a.forEach(function(t){var a=new u.Trigger(e.game,t.x,t.y,"sprites","trigger",t.properties);void 0!==t.properties.questNodeId&&(e.addWaypoint(a,t.properties.questNodeId),e.waypointNodeGroup.push(a)),e.game.triggerGroup.add(a)});var n=e.findObjectsByType("pickup",e.map,"objects");e.game.pickupGroup=e.context.add.group(),n.forEach(function(t){var a=new c.PickupItem(e.game,t.x,t.y,"sprites","",t.properties);void 0!==t.properties.questNodeId&&(e.addWaypoint(a,t.properties.questNodeId),e.waypointNodeGroup.push(a)),e.game.pickupGroup.add(a)}),e.game.world.bringToTop(e.game.player);var o=e.findObjectsByType("object",e.map,"objects");e.game.objGroup=e.game.add.group(),o.forEach(function(t){var a=new m.Obj(e.game,t.x,t.y,"sprites","",t.properties);void 0!==t.properties.questNodeId&&(e.addWaypoint(a,t.properties.questNodeId),e.waypointNodeGroup.push(a)),e.game.objGroup.add(a)});var d=e.findObjectsByType("npc",e.map,"objects");if(e.game.NPCGroup=e.context.add.group(),d.forEach(function(t){var a=new r.NPC(e.game,t.x,t.y,"sprites","",t.properties);void 0!==t.properties.questNodeId&&(e.addWaypoint(a,t.properties.questNodeId),e.waypointNodeGroup.push(a)),e.game.NPCGroup.add(a)}),e.game.player.data.hasCompanion){var g=new r.NPC(e.game,e.game.player.x-36,e.game.player.y,"sprites","",e.game.data.companion);e.game.NPCGroup.add(g)}console.log("NPCs",e.game.NPCGroup.children);var p=e.findObjectsByType("enemy",e.map,"objects");e.game.enemyGroup=e.context.add.group(),p.forEach(function(t,a){var n=void 0;"troll"===t.properties.key?n=new s.Troll(e.game,t.x,t.y,"sprites","",t.properties):"ogre"===t.properties.key?n=new l.Ogre(e.game,t.x,t.y,"sprites","",t.properties):"rat"===t.properties.key&&(n=new h.Rat(e.game,t.x,t.y,"sprites","",t.properties)),void 0!==t.properties.questNodeId&&(e.addWaypoint(n,t.properties.questNodeId),e.waypointNodeGroup.push(n)),e.game.enemyGroup.add(n)})},this.createSubForegroundLayer=function(){e.game.foregroundLayer=e.map.createLayer("subforeground")},this.createForegroundLayer=function(){e.game.foregroundLayer=e.map.createLayer("foreground");var t=e.setForegroundTiles();e.map.setTileIndexCallback(t,e.fadeForeground,e.game,"foreground")},this.fadeForeground=function(t,a){e.game.foregroundLayer.alpha=.2},this.setForegroundTiles=function(){var t=e.game.cache.getTilemapData(e.mapName).data.layers[6].data,a=e.uniqueArray(t),n=a.indexOf(0);return n>-1&&a.splice(n,1),a},this.uniqueArray=function(e){return e.filter(function(e,t,a){return a.indexOf(e)==t})},this.findObjectsByType=function(e,t,a){var n=[];return t.objects[a].forEach(function(o){0===Object.keys(o).length&&o.constructor===Object||void 0!==o.properties&&o.properties.type==e&&(o.y-=t.tileHeight,o.x+=t.tileWidth,o.properties.index=t.objects[a].indexOf(o),n.push(o))}),n},this.pickupItem=function(t,a){if(a.velocityTimer&&e.game.time.events.remove(a.velocityTimer),"powerup"===a.data.key)a.initPowerup(),a.destroy();else if("inventoryItem"===a.data.key&&e.game.player.data.inventory.length<5){if(a.initInventoryItem(a.data),a.data.questNodeId){if(!e.checkForActiveNode(a.data.questNodeId))return;e.updateWaypoint(a.data.questNodeId)}a.destroy()}},this.checkForActiveNode=function(t){console.log("RECEIVING questNodeID to checkForActiveNode",t);var a=t.substring(0,t.length-2),n=parseInt(t.slice(-1));if(0===n)return!0;if(!e.game.player.data.quests.some(function(e){return e.id===a})&&0!==n)return!1;var o=e.game.player.data.quests[e.getActiveQuestIndex(e.game.player.data.quests,a)];return e.getFirstActiveNode(o.nodes)===n-1},this.getFirstActiveNode=function(e){for(var t=0;t<e.length;t++)if(!1===e[t].complete)return t},this.getActiveQuestIndex=function(e,t){for(var a=0;a<e.length;a++)if(e[a].id===t)return a},this.updateWaypoint=function(t){console.log("questNodeId is: ",t);var a=t.substring(0,t.length-2),n=parseInt(t.slice(-1))-1;console.log("preveNodeId is",n);var o=e.game.waypointGroup.children.findIndex(function(e){return e.data.questId===a}),i=e.game.waypointGroup.children[o];if(void 0!==i){i.activate();var r=e.game.player.updateQuest(a,n,!0);console.log({newWaypointNode:r}),"quest complete"===r?void 0!==i&&(i.visible=!1):e.setNewWaypointTarget(i,r)}},this.setNewWaypointTarget=function(t,a){if(void 0===a)return void console.error("Returned target was undefined on waypoint:",t);var n=a.target,i={};i=e.findNewTargetOnMap(n),void 0===i&&(i=e.findNewTargetInWorld(a.map),console.log("RETURNED MAP STRING IS:",i)),console.log("NEW TARGET TYPE IS",void 0===i?"undefined":o(i)),console.log("NEW TARGET MAP IS",i),void 0!==i&&(t.data.target=i)},this.findNewTargetOnMap=function(t){var a=void 0;return e.waypointNodeGroup.forEach(function(e){e.data.questNodeId===t&&(a=e)}),a},this.returnMapIdAsObject=function(t){for(var a=null,n=0;e.game.stagesGroup.children.length>n;n++)if(console.log("VIEWING:",e.game.stagesGroup.children[n].data.stage),e.game.stagesGroup.children[n].data.stage===t){a=n;break}return console.log("RETURNED INDEX IS",a),e.game.stagesGroup.children[a]},this.findNewTargetInWorld=function(t){var a=e.mapName,n=[],o=null,i=null,r=0,s="",l=e.game.atlas[a].nodes.find(function(e){if(e===t)return e});return 1===e.game.stagesGroup.children.length&&(l=e.game.stagesGroup.children[0].data.stage),void 0!==l?i=e.returnMapIdAsObject(l):(e.game.atlas[a].nodes.map(function(t){n.push([t,e.game.atlas[t].nodes])}),console.log("initialSearchNodes is",n),o=function a(n){if(console.log("SEARCHING CHILD NODES:",n),1===n.length)return n[0][0];if(r>10)return void console.error("ERROR. Too many searches. Exiting");r++,console.log("SEARCH CYCLES: ",r);for(var o=null,i=[],l=0;n.length>l;l++){for(var h=n[l],c=0;h[1].length>c;c++)if(console.log("LOOKING AT:",h[1][c]),h[1][c]===t){o=h[0];break}if(console.log("foundMap is:",o),"string"==typeof o)break}return"string"==typeof o?(console.log("RETURNING FOUNDMAP",o),s=o,o):(n.forEach(function(t){console.log("LOOKING FOR NODES OF:",t);var a=[t[0]],n=[],o=[];t[1].forEach(function(a){if(a!==t[0]&&a!==e.game.currentMap){var i=e.game.atlas[a].nodes,r=n.concat(i);o=r}}),a[1]=o,i.push(a)}),a(i))}(n),console.log("!!! RETURNED MAP IS:",o),i=e.returnMapIdAsObject(o),console.log("RETURNEDMAPOBJECT IS",i),void 0===i&&(i=e.game.stagesGroup.children[0]),i)},this.removeWaypoint=function(t){console.log("removing waypoint");var a=t.substring(0,t.length-2),n=e.game.waypointGroup.children.map(function(e){return e.data.questId}).indexOf(a);e.game.waypointGroup.children[n].destroy()},this.triggerFunction=function(t,a){if(a.data.questNodeId){if("kq-q-ratking-2"===a.data.questNodeId){if(!e.game.player.hasItem("RatKeyRight")||!e.game.player.hasItem("RatKeyLeft"))return}else if("kq-q-ratking-3"===a.data.questNodeId)return e.game.npcFunctions[a.data.initFunction](),void e.searchAndRemoveTriggers(a.data.initFunction);if(!e.checkForActiveNode(a.data.questNodeId))return;e.updateWaypoint(a.data.questNodeId),void 0!==a.data.initFunction&&e.game.npcFunctions[a.data.initFunction]()}else void 0!==a.data.initFunction&&e.game.npcFunctions[a.data.initFunction]();a.data.once&&e.searchAndRemoveTriggers(a.data.initFunction)},this.searchAndRemoveTriggers=function(t){e.game.triggerGroup.children.filter(function(e,a){return e.data.initFunction===t}).forEach(function(t){t.data.leaveInCache||(0,p.removeFromCache)(e.game,e.game.currentStage,t.data.index),t.destroy()})},this.killWorldObjects=function(){["stagesGroup","pickupGroup","objGroup","NPCGroup","enemyGroup","projectileGroup","waypointGroup","UIGroup"].forEach(function(t){e.game[t].children.forEach(function(e){e.destroy()}),e.game[t].children=[]}),e.game.player.destroy(),e.game.dialogue.nextButton.events.onInputDown.removeAll(),e.game.inventoryButton.events.onInputDown.removeAll(),e.game.questsButton.events.onInputDown.removeAll(),e.game.fullscreenButton.events.onInputDown.removeAll(),e.game.foregroundLayer=null,e.game.questsButton=null,e.game.healthIconGroup=null,e.game.sfx=null,delete e.game.mapWorld},this.changeStage=function(t,a,n){e.game.player.isTalking||(e.game.player.isTalking=!0,e.game.player.body.velocity.setTo(0),a.questNodeId&&(e.game.canChange=!1,e.checkForActiveNode(a.questNodeId)&&(e.updateWaypoint(a.questNodeId),a.questNodeId=null)),a.hasOwnProperty("data")&&a.data.hasOwnProperty("initFunction")&&(n=a.data.initFunction),e.game.camera.fade("#000000"),e.game.camera.onFadeComplete.add(function(){e.game.camera.onFadeComplete.removeAll(),e.game.stageInitFunction[0]="string"==typeof n?e.game.npcFunctions[n]:n||"",e.game.globalAchievements.marchToWar||e.game.musicHandler.stop(),e.game.time.events.removeAll(),e.game.startingPosition=e.parseCoords(a.targetPosition),e.game.currentStage=a.targetMap,e.game.onBlur.removeAll(),e.game.onFocus.removeAll(),""!==e.game.stageDismissFunction[0]?e.game.stageDismissFunction[0]():e.game.state.start("Game")}))},this.parseCoords=function(e){var t=[],a=e.split(",");return t.push(parseInt(a[0])),t.push(parseInt(a[1])),t},this.addWaypoint=function(t,a,n){if(!e.game.atlas[e.mapName].suppressWaypoints){var o=a;console.log("addWaypoint nodeId:",o);var i=parseInt(o.slice(-1));console.log("addWaypoint nodeIdNum:",i);var r=o.substring(0,o.length-2);console.log("addWaypoint questId:",r);if(0!==i||e.game.player.data.quests.find(function(e){return e.id===r})){if(n)console.log("2"),e.createWaypoint(r,t,"active");else if(e.game.player.data.quests.find(function(e){return e.id===r})){console.log("3");var s=e.game.player.data.quests.map(function(e){return e.id}).indexOf(r);console.log({questIndex:s});var l=e.game.player.data.quests[s];console.log({playerQuest:l});for(var h=0;h<l.nodes.length;h++)!1===l.nodes[h].complete&&void 0!==l.nodes[h-1]&&!0===l.nodes[h-1].complete&&h===i-1&&e.createWaypoint(r,t,"active")}}else console.log("1"),e.createWaypoint(r,t,"new")}},this.createWaypoint=function(t,a,n){var o={questId:t,target:a,status:n},i=new d.Waypoint(e.game,a.x-18,a.y,"sprites","",o);e.game.waypointGroup.add(i)},this.createSingleCharacterQuestWaypoint=function(t){var a=t.map,n=t.target;if(console.log("target is:",n),a===e.mapName&&"kq02-calgary-01"===e.game.currentStage)return void e.createWaypoint("kq-q-quiz",e.game.actions.getCharacter("Naheed Nenshi"),"active");var o=e.findNewTargetInWorld(a);console.log(o),e.addWaypoint(o,n,!0)},this.createCharacterQuestWaypoints=function(){var t=e.game.waypointGroup.children;console.log("CURRENT WAYPOINTS (before createCharacterQuestWaypoints added):",t);var a=e.game.player.data.quests,n=e.compareQuests(a,t);console.log({unReppedQuestsArray:n}),n.forEach(function(t){console.log("!!!QUEST!!!",t);var a=t[0].nodes.find(function(e){if(!1===e.complete)return e});console.log("ACTIVEQUESTNODE",a),e.createSingleCharacterQuestWaypoint(a)})},this.compareQuests=function(e,t){for(var a=[],n=0;n<e.length;n++)!function(n){void 0===t.find(function(t){if(t.questId===e[n].id)return t})&&a.push(e)}(n);return a},this.checkIfActiveWaypointNode=function(e){var t=e;parseInt(t.slice(-1)),t.substring(0,t.length-2);return!0}})},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Dialogue=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(11),r=a(0),s=function(e){return e&&e.__esModule?e:{default:e}}(r);t.Dialogue=function(){function e(t){n(this,e),this.dialogueWindow=null,this.dialogueObject=null,this.dialogueArray=null,this.dialogueString=null,this.dialogueIndex=null,this.nameText=null,this.windowTween=null,this.currChar=null,this.currSpeaker=null,this.dialogueDualBool=null,this.dialogueOptionsPointer=null,this.dialogueOptions=null,this.activeSelection=null,this.keyDown=null,this.keyUp=null,this.charR=null,this.charL=null,this.closeCallback=null,this.signCallback=null,this.game=t,this.winW=this.game.width-2,this.winH=this.game.height/2.75,this.btnW=60,this.btnH=60,this.signUp=!1,s.default.mixin(this),this.windowTween=this.game.add.tween(null),this.screen=this.game.add.graphics(),this.screen.beginFill(0,.5),this.screen.drawRect(0,0,this.game.camera.width,this.game.camera.height),this.screen.endFill(),this.screen.alpha=0,this.screen.fixedToCamera=!0,this.talkWindow=this.game.add.graphics(this.game.width/2,this.game.height-(this.winH/2+1)),this.talkWindow.lineStyle(2,16777215,1),this.talkWindow.beginFill("#000",1),this.talkWindow.drawRoundedRect(-(this.game.width-2)/2,-this.winH/2,this.winW,this.winH,15),this.talkWindow.endFill(),this.talkWindow.fixedToCamera=!0,this.talkWindow.scale.setTo(0),this.nextButton=new i.NextButton(this.game,this.game.width-60,this.game.camera.height-60),this.nextButton.events.onInputDown.add(this.nextDialogue,this),this.nextButton.visible=!1,this.alertWindow=this.game.add.graphics(this.game.camera.width/2,this.game.camera.height/2+80),this.alertWindow.lineStyle(2,16777215,1),this.alertWindow.beginFill("0x871a12",.8),this.alertWindow.drawRoundedRect(-(this.game.width-2)/2,-this.winH/2,this.winW,this.winH-80,15),this.alertWindow.endFill,this.alertWindow.fixedToCamera=!0,this.alertWindow.scale.setTo(0),this.alertText=this.game.add.bitmapText(this.game.camera.width/2,this.alertWindow.y-42,"VT323","",36),this.alertText.anchor.setTo(.5),this.alertText.align="center",this.alertText.visible=!1,this.alertText.maxWidth=this.game.camera.width-200,this.alertText.fixedToCamera=!0,this.signWindow=this.game.add.graphics(this.game.width/2,this.game.height-(this.winH/2+1)),this.signWindow.lineStyle(2,16777215,1),this.signWindow.beginFill("0x871a12",1),this.signWindow.drawRoundedRect(-(this.game.width-2)/2,-this.winH/2,this.winW,this.winH,15),this.signWindow.graphicsData[0].fillColor="0x871a12",this.signWindow.fixedToCamera=!0,this.signWindow.scale.setTo(0),this.nameText=this.game.add.bitmapText(40,this.game.camera.height-(this.winH-24),"VT323"),this.nameText.visible=!1,this.nameText.maxWidth=this.game.camera.width-80,this.nameText.fixedToCamera=!0,this.game.dialogueGroup=this.game.add.group(),this.game.dialogueGroup.add(this.screen),this.game.dialogueGroup.add(this.talkWindow),this.game.dialogueGroup.add(this.signWindow),this.game.dialogueGroup.add(this.nextButton),this.game.dialogueGroup.add(this.nameText),this.game.dialogueGroup.visible=!1,this.game.dialogueGroup.sendToBack(this.screen),this.pointerPositions=[this.game.camera.height-(this.winH-24),this.game.camera.height-(this.winH-24)+42,this.game.camera.height-(this.winH-24)+84],this.dialogueOptions=[],this.pointersCollection=[],this.dialogueTextOptions=[],this.dialogueTimer=this.game.time.create(!1)}return o(e,[{key:"heroSpeaks",value:function(){this.initDialogue(!1,this.game.player,!1)}},{key:"initDialogue",value:function(e,t,a,n,o){var i=this;console.log("CHAR",t),console.log("ENEMY GROUP",this.game.enemyGroup.children),t!==this.game.player&&"function"==typeof t.stopMovement&&t.stopMovement(),this.emit("dialogueEngaged"),this.game.dialogueGroup.visible=!0,this.currChar=t,this.game.player.isTalking=!0,e&&t.animations.play(this.setDirection(e,t)).stop(),console.log("1"),this.windowTween=this.game.add.tween(this.talkWindow.scale).to({x:1,y:1},120,"Quad.easeOut").start(),this.game.sfx.play("sfx_dialogue_up"),this.windowTween.onComplete.add(function(){i.windowTween.onComplete.removeAll(),i.dialogueIndex=0,i.dialogueObject=i.game.npcDialogue.data[t.data.name][t.data.dI],console.log("HEY!",t,i.dialogueObject),i.currSpeaker=i.dialogueObject[2]?i.game.player:i.currChar,t.data.portrait&&t!==i.game.player&&(i.game.add.tween(i.screen).to({alpha:1},110,"Quad.easeOut",!0),console.log("screen",i.screen),i.callPortraits(t.data.portrait,i.game.player.data.portrait,i.currSpeaker,o)),i.dialogueArray=i.game.npcDialogue.data[t.data.name][t.data.dI][0],i.dialogueDualBool=!!i.dialogueObject[1],i.dialogueString=i.dialogueArray[i.dialogueIndex],i.nameText.text=i.currSpeaker.data.name.toUpperCase()+": "+i.dialogueString,i.nameText.visible=!0,i.game.dialogueGroup.bringToTop(i.nameText),i.nextButton.visible=!n,n&&(i.dialogueTimer.start(),i.game.time.events.add(4e3,i.nextDialogue,i))})}},{key:"setSpeaker",value:function(){if(1===this.dialogueObject[1]&&(this.currSpeaker=this.currSpeaker===this.game.player?this.currChar:this.game.player),this.currChar.data.hasOwnProperty("portrait")&&this.currChar!==this.game.player){var e=this.currSpeaker===this.game.player?this.charR:this.charL;this.highlightPortrait(e)}return this.currSpeaker.data.name.toUpperCase()}},{key:"setDirection",value:function(e,t){switch(e){case"forward":return"walk-backward";case"backward":return"walk-forward";case"left":return"walk-left";case"right":return"walk-right"}}},{key:"nextDialogue",value:function(){var e=this;if(!this.windowTween.isRunning&&!1!==this.nextButton.visible||this.game.globalAchievements.marchToWar){if(this.signUp)this.dismissSign();else if(this.dialogueIndex>=this.dialogueArray.length-1){if(0===this.dialogueOptions.length)return void this.endDialogue();console.log("Appending a new thread"),this.switchDialogueThread()}else this.game.sfx.play("sfx_dialogue_next"),this.dialogueIndex=this.dialogueIndex+1,console.log("INCREMENTING dialogueIndex",this.dialogueIndex),"string"==typeof this.dialogueArray[this.dialogueIndex]?(this.dialogueString=this.dialogueArray[this.dialogueIndex],this.nameText.text=this.setSpeaker()+": "+this.dialogueString):(this.nameText.text="",this.dialogueArray[this.dialogueIndex].map(function(t,a){e.interactiveEntry(t,a)}),this.activeSelection=0,this.keyDown=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),this.keyDown.onDown.add(this.movePointerDown,this),this.keyUp=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),this.keyUp.onDown.add(this.movePointerUp,this),this.pointersCollection[0].visible=!0);this.dialogueTimer.running&&this.dialogueTimer.add(4e3,this.nextDialogue,this)}}},{key:"switchDialogueThread",value:function(){this.dialogueIndex=0,this.currChar.data.dI=this.dialogueOptions[this.activeSelection],this.dialogueObject=this.game.npcDialogue.data[this.currChar.data.name][this.currChar.data.dI],this.dialogueArray=this.game.npcDialogue.data[this.currChar.data.name][this.currChar.data.dI][0],this.clearDialogueOptions(),this.nextButton.inputEnabled=!0,this.nextButton.visible=!0,this.dialogueString=this.dialogueArray[this.dialogueIndex],this.dialogueDualBool=!!this.dialogueObject[1],this.nameText.text=this.setSpeaker()+": "+this.dialogueString}},{key:"interactiveEntry",value:function(e,t){var a=42*t,n=this.game.camera.height-(this.winH-24)+a;this.dialogueOptions.push(e[1]);var o=this.game.add.bitmapText(122,n,"VT323",e[0]);o.maxWidth=this.game.camera.width-80,this.createPointer(n),o.inputEnabled=!0,o.input.useHandCursor=!0,o.fixedToCamera=!0,o.optionIndex=t,o.events.onInputDown.add(this.dialogueOptionTouchSelect,this),this.dialogueTextOptions.push(o)}},{key:"dialogueOptionTouchSelect",value:function(e){this.game.sfx.play("sfx_dialogue_next"),this.clearPointers(),this.activeSelection=e.optionIndex,this.pointersCollection[this.activeSelection].visible=!0}},{key:"createPointer",value:function(e){var t=this.game.add.sprite(40,e,"pointer");t.fixedToCamera=!0,t.visible=!1,t.scale.x=.32,t.scale.y=.32,t.anchor.y=.06,this.pointersCollection.push(t)}},{key:"movePointerUp",value:function(){this.pointersCollection[0].visible||(this.game.sfx.play("sfx_dialogue_next"),this.clearPointers(),this.activeSelection--,this.pointersCollection[this.activeSelection].visible=!0)}},{key:"movePointerDown",value:function(){this.pointersCollection[this.dialogueOptions.length-1].visible||(this.game.sfx.play("sfx_dialogue_next"),this.clearPointers(),this.activeSelection++,this.pointersCollection[this.activeSelection].visible=!0)}},{key:"clearPointers",value:function(){this.pointersCollection.map(function(e){e.visible=!1})}},{key:"clearDialogueOptions",value:function(){this.dialogueOptions=[],this.activeSelection=0,this.keyDown.onDown.remove(this.movePointerDown,this),this.keyUp.onDown.remove(this.movePointerUp,this),this.pointersCollection.map(function(e){e.destroy()}),this.pointersCollection=[],this.dialogueTextOptions.map(function(e){e.destroy()}),this.dialogueTextOptions=[]}},{key:"endDialogue",value:function(){var e=this;console.log("END DIALOGUE HAS BEEN CALLED!!!"),this.nextButton.visible=!1,this.nameText.visible=!1,this.screen.alpha=0,this.dialogueTimer.stop(),this.dialogueTimer.removeAll(),this.currChar.data.dI=this.dialogueObject[3],this.currChar.data.hasOwnProperty("portrait")&&this.currChar!==this.game.player&&(this.charR.visible=!1,this.charL.visible=!1),this.windowTween=this.game.add.tween(this.talkWindow.scale).to({x:0,y:0},200,"Quad.easeOut").start(),this.windowTween.onComplete.add(function(){e.windowTween.onComplete.removeAll(),e.game.dialogueGroup.visible=!1,e.game.player.isTalking=!1,e.currChar.data.static&&e.currChar!==e.game.player?e.currChar.data.staticDir||e.currChar.animations.play("walk-forward").stop():e.currChar!==e.game.player&&"function"==typeof e.currChar.assignMovementCoords&&e.currChar.assignMovementCoords(),e.emit("dialogueClosed"),e.game.actions.setDICache(e.currChar,e.game.currentStage),void 0!==e.dialogueObject[4]&&e.dialogueObject[4]()},this)}},{key:"callPortraits",value:function(e,t,a,n){console.log(e),console.log(t);var o={alpha:1,scale:.83},i={alpha:.6,scale:.78},r=void 0,s=void 0;a===this.game.player?(s=o,r=i):(s=i,r=o),this.charL=this.game.add.sprite(-500,this.game.camera.height-(this.winH-24),"portraits",e+".png"),this.charL.fixedToCamera=!0,this.charL.anchor.setTo(0,1),this.charL.scale.setTo(r.scale),this.charL.alpha=r.alpha,this.game.dialogueGroup.add(this.charL).sendToBack(this.charL),this.charR=this.game.add.sprite(this.game.camera.width+500,this.game.camera.height-(this.winH-24),"portraits",t+".png"),this.charR.fixedToCamera=!0,this.charR.anchor.setTo(1,1),this.charR.scale.setTo(s.scale),this.charR.alpha=n?0:s.alpha,this.game.dialogueGroup.add(this.charR).sendToBack(this.charR),this.game.add.tween(this.charR.cameraOffset).to({x:this.game.camera.width},150,"Quad.easeOut").start(),this.game.add.tween(this.charL.cameraOffset).to({x:0},150,"Quad.easeOut").start(),this.game.dialogueGroup.sendToBack(this.screen)}},{key:"highlightPortrait",value:function(e){var t=e,a=t===this.charR?this.charL:this.charR;this.game.add.tween(t.scale).to({x:.83,y:.83},60,"Quad.easeOut",!0),t.alpha=1,this.game.add.tween(a.scale).to({x:.78,y:.78},60,"Quad.easeOut",!0),a.alpha=0===a.alpha?0:.6}},{key:"sign",value:function(e,t,a,n){var o=this;console.log(e),this.signUp=!0,a&&(this.closeCallback=!0),n&&(this.signCallback=n),this.emit("dialogueEngaged"),this.game.player.isTalking=!0,this.game.player.body.velocity.set(0),this.game.player.animations.stop(),this.game.player.velocity=0,this.game.dialogueGroup.visible=!0,this.game._MOBILE&&this.game.toggleMobileControls(!1),this.signTween=this.game.add.tween(this.signWindow.scale).to({x:1,y:1},140,"Quad.easeOut").start(),this.signTween.onComplete.add(function(){o.nameText.text=""+e,o.nameText.visible=!0,o.game.dialogueGroup.bringToTop(o.nameText),o.nextButton.visible=!0})}},{key:"dismissSign",value:function(){var e=this;this.emit("dialogueClosed"),this.nextButton.visible=!1,this.nameText.visible=!1,this.signTween=this.game.add.tween(this.signWindow.scale).to({x:0,y:0},140,"Quad.easeOut").start(),this.signTween.onComplete.add(function(){e.signUp=!1,e.game.dialogueGroup.visible=!1,e.game.player.isTalking=!1,e.game._MOBILE&&(e.closeCallback||(e.game.controls.stick.visible=!0),e.game.controls.buttonA.visible=!0),e.closeCallback&&(e.closeCallback=!1,e.emit("beginButtonMashChallenge")),e.signCallback&&e.signCallback()})}},{key:"alert",value:function(e,t){var a=this;this.alertWindow.visible=!0;var n=this.game.add.tween(this.alertWindow.scale).to({x:1,y:1},180,"Quad.easeOut",!0);n.onComplete.add(function(){a.alertText.setText(e),a.alertText.visible=!0,a.alertTimer=a.game.time.events.add(1200,function(){a.alertText.visible=!1,n.to({x:0,y:0},100,"Quad.easeOut",!0),n.onComplete.removeAll(),n.onComplete.add(function(){a.alertWindow.visible=!1})})})}},{key:"initRead",value:function(e){console.log(e)}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Dragon=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),h=a(49),c=a(12);t.Dragon=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],h=arguments[5];n(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,h));return c.headMoveTween=null,c.combatActive=!1,c.attackTimer=null,c.pauseTimer=null,e.add.existing(c),c.game=e,e.physics.arcade.enable(c),c.body.immovable=!0,c.body.onCollide=new Phaser.Signal,c.data=h,l.default.mixin(c),c.targetPos={x:c.game.player.x,y:c.game.player.y},c.cW=c.game.camera.width,c.cH=c.game.camera.height,c.anchor.setTo(.5,.5),c.frameName="trigger.png",c.position.set(a,i),c.body.setSize(2e3,360,-1e3,-220),c.currentState="_PAUSED",c.maxHealth=20,c.health=20,c.isType="BOSS",c.engageDistance=180,c.game.dragonGroup=c.game.add.group(),c.parts={},c.cam=c.game.camera,c.fixedToCamera=!0,c.parts.R_foot=c.game.add.sprite(-86,-60,"sprites","dragon/right_foot.png"),c.parts.R_foot.anchor.setTo(.5,0),c.game.dragonGroup.add(c.parts.R_foot),c.addChild(c.parts.R_foot),c.parts.R_shoulder=c.game.add.sprite(-70,-130,"sprites","dragon/right_shoulder.png"),c.parts.R_shoulder.anchor.setTo(.5,0),c.game.dragonGroup.add(c.parts.R_shoulder),c.addChild(c.parts.R_shoulder),c.parts.R_wing=c.game.add.sprite(-50,-155,"sprites","dragon/right_wing.png"),c.parts.R_wing.anchor.setTo(1,.5),c.game.dragonGroup.add(c.parts.R_wing),c.addChild(c.parts.R_wing),c.parts.L_foot=c.game.add.sprite(86,-60,"sprites","dragon/left_foot.png"),c.parts.L_foot.anchor.setTo(.5,0),c.game.dragonGroup.add(c.parts.L_foot),c.addChild(c.parts.L_foot),c.parts.L_shoulder=c.game.add.sprite(70,-130,"sprites","dragon/left_shoulder.png"),c.parts.L_shoulder.anchor.setTo(.5,0),c.game.dragonGroup.add(c.parts.L_shoulder),c.addChild(c.parts.L_shoulder),c.parts.L_wing=c.game.add.sprite(50,-155,"sprites","dragon/left_wing.png"),c.parts.L_wing.anchor.setTo(0,.5),c.game.dragonGroup.add(c.parts.L_wing),c.addChild(c.parts.L_wing),c.parts.body=c.game.add.sprite(0,-200,"sprites","dragon/body.png"),c.parts.body.anchor.setTo(.5,0),c.game.dragonGroup.add(c.parts.body),c.addChild(c.parts.body),c.parts.neck4=c.game.add.sprite(0,-120,"sprites","dragon/neck_4.png"),c.parts.neck4.anchor.setTo(.5,.5),c.game.dragonGroup.add(c.parts.neck4),c.addChild(c.parts.neck4),c.parts.neck3=c.game.add.sprite(0,-90,"sprites","dragon/neck_3.png"),c.parts.neck3.anchor.setTo(.5,.5),c.game.dragonGroup.add(c.parts.neck3),c.addChild(c.parts.neck3),c.parts.neck2=c.game.add.sprite(0,-70,"sprites","dragon/neck_2.png"),c.parts.neck2.anchor.setTo(.5,.5),c.game.dragonGroup.add(c.parts.neck2),c.addChild(c.parts.neck2),c.parts.neck1=c.game.add.sprite(0,-30,"sprites","dragon/neck_1.png"),c.parts.neck1.anchor.setTo(.5,.5),c.game.dragonGroup.add(c.parts.neck1),c.addChild(c.parts.neck1),c.parts.jaw=c.game.add.sprite(0,60,"sprites","dragon/jaw.png"),c.parts.jaw.anchor.setTo(.5),c.game.dragonGroup.add(c.parts.jaw),c.addChild(c.parts.jaw),c.parts.head=c.game.add.sprite(0,0,"sprites","dragon/head.png"),c.parts.head.anchor.setTo(.5),c.game.dragonGroup.add(c.parts.head),c.addChild(c.parts.head),c.jawDistance=60,c}return i(t,e),r(t,[{key:"setSignal",value:function(){this.signal=new c.ProjectileSignal(this.game,this.x,this.y,this.parts.head,this),this.addChildAt(this.signal,11)}},{key:"setState",value:function(e){this.currentState=e,console.log("DRAGON STATE:",e)}},{key:"update",value:function(){this.parts.neck1.position.x=this.parts.head.position.x/1.4,this.parts.neck2.position.x=this.parts.neck1.position.x/1.4,this.parts.neck3.position.x=this.parts.neck2.position.x/1.4,this.parts.jaw.position.x=this.parts.head.position.x,this.parts.jaw.position.y=this.parts.head.position.y+this.jawDistance,"_PAUSED"!==this.currentState&&("_MOVING"===this.currentState?this.combatActive&&(this.parts.head.position.x=this.followPlayerPos()):this.currentState)}},{key:"followPlayerPos",value:function(){var e=this.game.player.position.x;return-(this.game.camera.width/2-e)/4}},{key:"dramaticEntrance",value:function(e,t){var a=this;this.setState("_MOVING"),this.parts.head.position.x+=40;var n=this.game.add.tween(this.cameraOffset).to({y:this.cam.height/2-100},e,"Quad.easeOut",!0);this.game.add.tween(this.parts.R_foot).to({y:this.parts.R_foot.y-30},e/8,"Quad.easeInOut",!0,0,2).yoyo(!0),this.game.add.tween(this.parts.L_foot).to({y:this.parts.L_foot.y-30},e/8,"Quad.easeInOut",!0,e/8,2).yoyo(!0);var o=this.game.add.tween(this.parts.head.position).to({x:this.parts.head.position.x-80},e/6,"Quad.easeInOut",!0,0,1);o.yoyo(!0);var i=function(){a.game.camera.shake(.0025,e/12),a.game.sfx.play("sfx_dragon_stomp",.7)},r=this.game.time.create(!1);r.loop(Phaser.Timer.SECOND/1.2,i,250),r.start(),n.onComplete.add(function(){a.setState("_PAUSED"),a.setSignal(),r.stop(),t&&t()}),o.onComplete.add(function(){o.yoyo(!1),a.game.add.tween(a.parts.head.position).to({x:0},e/6,"Quad.easeInOut",!0)})}},{key:"quickExit",value:function(e){this.setState("_MOVING"),this.game.sfx.play("sfx_dragon_takeoff"),this.game.add.tween(this.cameraOffset).to({y:-this.cam.height/2},1200,"Quad.easeIn",!0).onComplete.add(function(){e&&e()})}},{key:"scream",value:function(e,t){var a=this;this.jawDistance=76;var n=this.game.add.tween(this.parts.head.position).to({y:40},200,"Quad.easeOut",!0,60);this.game.sfx.play("sfx_dragon_roar",.7),n.yoyo(!0,e),this.game.camera.shake(.0025,1450),n.onComplete.add(function(){a.jawDistance=60,t&&t()})}},{key:"hit",value:function(){this.emit("bossHit")}},{key:"pullbackHead",value:function(){}},{key:"setAttackTimer",value:function(e,t){var a=this;console.log("ATTACK TIMER FIRED!!!"),e||(e=this.setDelay()),t||(t=this.selectRandomAttack()),this.attackTimer=this.game.time.events.add(e,function(){a.setAttackSignal(t)},this),console.log(this.attackTimer,e)}},{key:"setAttackSignal",value:function(e){this.signal.sig(e)}},{key:"setDelay",value:function(){return this.game.rnd.integerInRange(500,1800)}},{key:"selectRandomAttack",value:function(){var e=this.game.rnd.integerInRange(0,3);if(this.game.physics.arcade.distanceBetween(this.game.player,this)<=160)switch(e){case 0:case 1:return this.bite;case 2:case 3:return this.stomp}else switch(e){case 0:return this.fireball;case 1:return this.fireballSequence;case 2:return this.fireballRing;case 3:return this.flamethrower}}},{key:"fireball",value:function(e,t){var a=e||this;a.jawDistance=76,a.game.time.events.add(100,function(){a.createFireball(),a.game.sfx.play("sfx_fireball"),t||a.game.time.events.add(400,function(){a.jawDistance=60,a.setAttackTimer()})})}},{key:"fireballSequence",value:function(e){for(var t=e||this,a=t.game.rnd.integerInRange(3,6),n=0;n<a;n++)t.game.time.events.add(500*n,function(){t.fireball(null,!0),t.game.sfx.play("sfx_fireball")}),n===a-1&&(t.jawDistance=60,t.setAttackTimer(500*n+2e3))}},{key:"checkHitPlayerDistance",value:function(){this.game.physics.arcade.distanceBetween(this.game.player,this)<=200&&this.playerHit()}},{key:"playerHit",value:function(){var e=this;if(!this.game.player.isHit){this.game.player.damage(2),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.game.player.body.velocity.setTo(0,600),this.game.player.isTalking=!0,this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player);this.game.time.events.add(300,function(){e.game.player.body.velocity.setTo(0),e.game.player.isTalking=!1;e.game.time.events.add(1e3,function(){e.game.player.isHit=!1})})}}},{key:"bite",value:function(e){var t=e||this;console.log("BITE ATTACK ENGAGED!!!!"),t.setState("_PAUSED");var a=t.game.add.tween(t.parts.head.position).to({y:t.parts.head.position.y-40},400,"Quad.easeOut",!0);a.onComplete.add(function(){t.jawDistance=76;var e=80*Phaser.Math.sign();a=t.game.add.tween(t.parts.head.position).to({x:e,y:t.parts.head.position.y+90},160,"Quad.easeOut",!0),a.onComplete.add(function(){t.checkHitPlayerDistance(),t.jawDistance=60,a=t.game.add.tween(t.parts.head.position).to({y:t.parts.head.position.y-50},70,null,!0),a.onComplete.add(function(){a.onComplete.removeAll(),t.setAttackTimer(1200)})})})}},{key:"fireballRing",value:function(e){var t=e||this;t.setState("_PAUSED"),t.game.add.tween(t.parts.head.position).to({x:0,y:t.parts.head.position.y+30},200,"Quad.easeOut",!0).onComplete.add(function(){t.game.time.events.add(t.game.rnd.integerInRange(80,180),function(){t.jawDistance=76,t.game.sfx.play("sfx_fireball");for(var e=0;e<6;e++)t.createFlameThrowerFireball(160*e,600);t.game.time.events.add(1200,function(){t.jawDistance=60,t.game.add.tween(t.parts.head.position).to({y:t.parts.head.position.y-30},200,"Quad.easeOut",!0).onComplete.add(function(){t.setState("_MOVING"),t.setAttackTimer(t.game.rnd.integerInRange(700,1300))})})})})}},{key:"createFireballRing",value:function(e,t){this.game.projectileGroup.getFirstExists(!1)}},{key:"flamethrower",value:function(e){var t=e||this;t.jawDistance=76,t.game.sfx.play("sfx_fireballBig");var a=t.game.time.events.loop(50,t.createFlameThrowerFireball,t);t.setState("_PAUSED"),t.targetPos={x:t.game.player.x,y:t.game.player.y};t.game.time.events.add(t.game.rnd.integerInRange(700,2200),function(){t.jawDistance=60,t.game.time.events.remove(a),t.setState("_MOVING"),t.setAttackTimer(t.game.rnd.integerInRange(800,1100))})}},{key:"createFlameThrowerFireball",value:function(e,t){var a=this.game.projectileGroup.getFirstExists(!1),n=e||this.targetPos.x,o=t||this.targetPos.y,i=e?1e3:this.game.rnd.integerInRange(300,600);a?(a.reset(this.x+this.parts.head.position.x,this.y+65),a.speed=420,a.exploding=!1,a.canDropItems=!1,a.body.setSize(24,16,0,0),a.timerReset(i),a.animations.play("fire")):(a=new h.Fireball(this.game,this.x+this.parts.head.position.x,this.y+65,"sprites",null,420,i),this.game.projectileGroup.add(a)),a.origin=this,this.game.physics.arcade.moveToXY(a,n,o,a.speed)}},{key:"createFireball",value:function(){var e=this.game.projectileGroup.getFirstExists(!1);e?(e.reset(this.x+this.parts.head.position.x,this.y+46),e.canDropItems=!0,e.speed=300,e.exploding=!1,e.timerReset(),e.body.setSize(24,16,0,0),e.animations.play("fire")):(e=new h.Fireball(this.game,this.x+this.parts.head.position.x,this.y+46,"sprites",null,300,null,!0),this.game.projectileGroup.add(e)),e.origin=this,this.game.physics.arcade.moveToXY(e,this.game.player.x,this.game.player.y,e.speed)}},{key:"stomp",value:function(e){var t=e||this;t.setState("_PAUSED"),t.parts.head.position.x+=10;t.game.add.tween(t.parts.R_foot).to({y:t.parts.R_foot.y-30},100,"Quad.easeInOut",!0,0,2).yoyo(!0),t.game.add.tween(t.parts.L_foot).to({y:t.parts.L_foot.y-30},100,"Quad.easeInOut",!0,100,2).yoyo(!0);var a=t.game.add.tween(t.parts.head.position).to({x:t.parts.head.position.x-20},800/6,"Quad.easeInOut",!0,0,1);a.yoyo(!0);var n=function(){t.game.camera.shake(.0025,800/12),t.game.sfx.play("sfx_dragon_stomp",.7)},o=t.game.time.create(!1);o.loop(Phaser.Timer.SECOND/1.2,n,250),o.start(),a.onComplete.add(function(){a.yoyo(!1),o.stop(),t.parts.head.position.x=0,t.setState("_PAUSED"),t.setAttackTimer(200)}),t.checkHitPlayerDistance()}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.NextButton=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return e.add.existing(s),s.anchor.setTo(.5),s.animations.add("flash",Phaser.Animation.generateFrameNames("nextBtn_0",1,2,".png"),3,!0),s.inputEnabled=!0,s.input.useHandCursor=!0,s.fixedToCamera=!0,s.animations.play("flash"),s}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.ProjectileSignal=function(e){function t(e,a,i,r,s){n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i));return l.game=e,l.anchor=r,l.parent=s,l.size=l.game.camera.width/4,l.beginFill(16777215,.6),l.drawCircle(0,55,l.size),l.endFill(),l.visible=!1,l}return i(t,e),r(t,[{key:"update",value:function(){this.offset.x=this.anchor.x}},{key:"sig",value:function(e){var t=this;this.reset(),this.graphicsData[0].fillColor=16777215,this.width=this.size,this.height=this.size,this.visible=!0,this.game.sfx.play("sfx_signal"),this.game.add.tween(this).to({width:0,height:0,fillAlpha:0},600,Phaser.Easing.Quartic.In,!0).onComplete.add(function(){t.kill(),t.parent.health>0&&e(t.parent)})}}]),t}(Phaser.Graphics)},function(e,t,a){"use strict";function n(e,t,a){var n=e.cache.getTilemapData(t).data.layers[4].objects;n[a]={},e.cache.getTilemapData(t).data.layers[4].objects=n}Object.defineProperty(t,"__esModule",{value:!0}),t.removeFromCache=n},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default={WIDTH:900,HEIGHT:600,GRAVITY:200};t.Dimensions=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:940,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600;n(this,e);var o=window.screen.availWidth*window.devicePixelRatio,i=window.screen.availHeight*window.devicePixelRatio,r=Math.max(o,i),s=Math.min(o,i);if(r>t){var l=t/r;r*=l,s*=l}if(s>a){var h=t/r;r*=h,s*=h}return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?{w:r,h:s}:(console.log("Returning desktop dimensions!!!"),{w:t,h:a})}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Troll=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(7),l=a(48);t.Troll=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return h._MAXSPEED=70,h._ADDSPEED=h.game.rnd.between(5,15),h._STRIKE_VELOCITY=380,h.health=h.game.rnd.integerInRange(3,4),h.targetX=0,h.targetY=0,h.animations.add("walk-forward",Phaser.Animation.generateFrameNames(h.data.key+"-mf/_0",1,3,".png"),5,!0),h.animations.add("walk-backward",Phaser.Animation.generateFrameNames(h.data.key+"-mb/_0",1,3,".png"),5,!0),h.animations.add("walk-left",Phaser.Animation.generateFrameNames(h.data.key+"-ml/_0",1,3,".png"),5,!0),h.animations.add("walk-right",Phaser.Animation.generateFrameNames(h.data.key+"-mr/_0",1,3,".png"),5,!0),h.animations.add("attack-forward",Phaser.Animation.generateFrameNames(h.data.key+"-af/_0",1,3,".png"),5,!1),h.animations.add("attack-backward",Phaser.Animation.generateFrameNames(h.data.key+"-ab/_0",1,3,".png"),5,!1),h.animations.add("attack-left",Phaser.Animation.generateFrameNames(h.data.key+"-al/_0",1,4,".png"),5,!1),h.animations.add("attack-right",Phaser.Animation.generateFrameNames(h.data.key+"-ar/_0",1,4,".png"),5,!1),h.data.isShooter&&(h.animations.add("shoot-forward",Phaser.Animation.generateFrameNames(h.data.key+"-sf/_0",1,4,".png"),5,!0),h.animations.add("shoot-backward",Phaser.Animation.generateFrameNames(h.data.key+"-sb/_0",1,4,".png"),5,!0),h.animations.add("shoot-left",Phaser.Animation.generateFrameNames(h.data.key+"-sl/_0",1,4,".png"),5,!0),h.animations.add("shoot-right",Phaser.Animation.generateFrameNames(h.data.key+"-sr/_0",1,4,".png"),5,!0)),h.animations.add("death",Phaser.Animation.generateFrameNames(h.data.key+"-death/_0",1,3,".png"),6,!1),h.data.isShooter&&(h.shootingTimer=h.game.time.create(!1)),h.currentState="_PATROL",h.data.isShooter||h.data.static?h.data.static||h.animations.play("shoot-forward"):h.setPatrolState(),h}return i(t,e),r(t,[{key:"update",value:function(){if(!this.data.static){if(this.game.player.isTalking||this.game.player.questsActive||this.game.player.inventoryActive)return void this.body.velocity.setTo(0);if("_PATROL"===this.currentState){if(!(this.game.physics.arcade.distanceBetween(this.game.player,this)<=240))return;this.currentState="_ALERT",this.data.isShooter&&!this.isAttacking?(this.targetX=this.game.player.x,this.targetY=this.game.player.y,this.engageShooting()):(clearTimeout(this.isMovingTimeout),clearTimeout(this.isPausedTimeout),this.isPaused=!1)}else if("_ALERT"===this.currentState)this.data.isShooter?(this.targetX=this.game.player.x,this.targetY=this.game.player.y,this.animations.play("shoot-"+this.faceDirection(this.targetX,this.targetY,!0))):(this.game.time.events.remove(this.movementTimer),this.body.velocity.setTo(this._MAXSPEED+this._ADDSPEED),this.game.physics.arcade.moveToXY(this,this.game.player.x,this.game.player.y,this._MAXSPEED+this._ADDSPEED),this.animations.play("walk-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)),this.isAlerted||(this.isAlerted=!0),this.body.touching.none||(this.currentState="_ATTACKING",this.body.velocity.setTo(0),this.attack()));else if("_ATTACKING"!==this.currentState||this.isAttacking){if("_PAUSED"===this.currentState)this.body.velocity.setTo(0),this.animations.play("walk-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)).stop();else if("_HIT"===this.currentState)return}else this.isAttacking||(this.isAttacking=!0)}}},{key:"attack",value:function(){var e=this;this.animations.play("attack-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)).onComplete.add(function(){this.setAttackPauseState()},this),this.game.time.events.add(300,function(){e.game.physics.arcade.distanceBetween(e.game.player,e)<=60&&!e.game.player.isHit&&!e.isDead&&e.playerHit(1)})}},{key:"setPatrolState",value:function(){var e=this;this.currentState="_PATROL",this.isMoving=!0,this.body.velocity.set(this.game.rnd.integerInRange(-1,1)*this._MAXSPEED,this.game.rnd.integerInRange(-1,1)*this._MAXSPEED),this.animations.play("walk-"+this.calcMovementDirection()),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1200,2200),function(){e.isMoving=!1,e.setPauseState()})}},{key:"engageShooting",value:function(){this.isAttacking=!0,this.animations.play("shoot-"+this.faceDirection(this.targetX,this.targetY,!0)),this.shootingTimer.start(),this.scheduleShooting()}},{key:"scheduleShooting",value:function(){this.createEnemyProjectile(),this.game.sfx.play("sfx_projectile"),this.shootingTimer.add(Phaser.Timer.SECOND/.33,this.scheduleShooting,this)}},{key:"stopShooting",value:function(){var e=this;this.data.isShooter=!1,this.shootingTimer.stop(),this.animations.play("walk-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)).stop(),this.game.time.events.add(300,function(){e.currentState="_ALERT",e.isAttacking=!1,e.game.physics.arcade.moveToXY(e,e.game.player.x,e.game.player.y,e._MAXSPEED+e._ADDSPEED)})}},{key:"createEnemyProjectile",value:function(){var e=this.game.projectileGroup.getFirstExists(!1);e?e.reset(this.centerX,this.centerY):(e=new l.Bullet(this.game,this.x,this.y,"sprites"),this.game.projectileGroup.add(e)),e.origin=this,this.game.physics.arcade.moveToXY(e,this.targetX,this.targetY,e.speed)}}]),t}(s.Enemy)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.FullscreenButton=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return s.game=e,s.game.add.existing(s),s.anchor.setTo(.5),s.frameName="fullscreen-btn.png",s.inputEnabled=!0,s.fixedToCamera=!0,s.scale.setTo(.5),s.game.scale.fullScreenScaleMode=Phaser.ScaleManager.EXACT_FIT,s.events.onInputDown.add(s.initFullscreen,s),s}return i(t,e),r(t,[{key:"initFullscreen",value:function(){this.game.scale.isFullScreen?this.game.scale.stopFullScreen():this.game.scale.startFullScreen(!1)}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.MapChangeSprite=function(e){function t(e,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sprites",l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a,i,r,s,l));return h.context=e,h.game=a,a.add.existing(h),a.physics.arcade.enable(h),h.body.onCollide=new Phaser.Signal,h.anchor.setTo(.5),h.data=l,h.body.setSize(48,48,0,0),h.targetMap=h.data.stage,h.targetPosition=h.data.coords,l.questNodeId&&(h.questNodeId=l.questNodeId),void 0!=h.data.function&&(h.function=h.data.function),h.frameName="mapChange.png",h}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={health:2,"super-health":4,"uber-health":8,pickup:{id:"pickup",desc:"This is a test description.",name:"Test item"},"Axe Handle":{id:"Axe Handle",desc:"...and woe to those who would erect regulations that threaten job growth! For the wielder of this great axe shall smite them!  The Scriptures of Rutherford",name:"Axe handle"},"Axe Head":{id:"Axe Head",desc:"The key piece required to fell the great Carbon Tax Tree.",name:"Axe head"},"Great Axe":{id:"axe",desc:"Forged in the searing flames of ideological fervour, this weapon was intended by the Tory ancients to fell the mightiest and most pragmatic of environmental initiatives",name:"The Mighty Carbon Tax Axe"},"Rat Key Left":{id:"RatKeyLeft",desc:"One of two keys required to enter the chamber of the Rat King",name:"Rat Key Left"},"Rat Key Right":{id:"RatKeyRight",desc:"One of two keys required to enter the chamber of the Rat King",name:"Rat Key Right"},"Valve Wheel":{id:"wheel",desc:"The wheel to open the valve on the unfinished pipeline located in the mountains",name:"Valve wheel"},"Oilers Jersey":{id:"jersey-edmonton",desc:"It is said this well-worn artifact is so beloved by Edmontonians it will guide you to the source of the city's power.",name:"Oilers jersey"},"Avocado Toast":{id:"toast-avocado",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread.",name:"Avocado toast"},"Avocado Toast (egg--)":{id:"toast-avocado-egg--",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with fried egg.",name:"Avocado toast"},"Avocado Toast (-bacon-)":{id:"toast-avocado--bacon-",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with bacon.",name:"Avocado toast"},"Avocado Toast (--sriracha)":{id:"toast-avocado---sriracha",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with Sriracha.",name:"Avocado toast"},"Avocado Toast (egg-bacon-)":{id:"toast-avocado-egg-bacon-",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with fried egg and bacon.",name:"Avocado toast"},"Avocado Toast (egg--sriracha)":{id:"toast-avocado-egg--sriracha",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with fried egg and Sriracha.",name:"Avocado toast"},"Avocado Toast (-bacon-sriracha)":{id:"toast-avocado--bacon-sriracha",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with bacon and Sriracha.",name:"Avocado toast"},"Avocado Toast (egg-bacon-sriracha)":{id:"toast-avocado-egg-bacon-sriracha",desc:"Fresh avocado spread over artisanally prepared and woodfire-baked rye bread with fried egg, bacon and Sriracha. It's everything requested of you.",name:"Avocado toast"},"Max Life":{id:"max-life",desc:"",name:"Max Life"}}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Toxicball=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2);t.Toxicball=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5],h=arguments[6],c=arguments[7],u=arguments[8];n(this,t);var d=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s));return d.rndLife=null,d.lifeTimer=null,d.aboutToExplode=null,d.game=e,d.game.physics.arcade.enable(d),d.body.immovable=!0,d.body.onCollide=new Phaser.Signal,d.canDropItem=c||!1,d.speed=l||240,d.body.setSize(16,16,0,0),d.exploding=!1,d.isBomb=u,d.inBombMode=!1,d.aboutToExplode=!1,d.anchor.setTo(.5),d.outOfBoundsKill=!0,d.checkWorldBounds=!0,d.animations.add("fire",Phaser.Animation.generateFrameNames("toxicball_",0,3,".png"),5,!0),d.animations.add("explode",Phaser.Animation.generateFrameNames("toxicball_explosion_",0,3,".png"),7,!1),d.animations.add("bomb",Phaser.Animation.generateFrameNames("toxicball_bomb_",0,3,".png"),3,!0),d.animations.add("bombExplode",Phaser.Animation.generateFrameNames("explosion-01/_",1,16,".png"),16,!1),d.animations.play("fire"),h?d.lifeTimer=h:d.timerReset(),d}return i(t,e),r(t,[{key:"timerReset",value:function(e){this.rndLife=e||this.setRndLife(),0!==this.rndLife&&(this.lifeTimer=this.game.time.events.add(this.rndLife,this.explode,this))}},{key:"setRndLife",value:function(){return Phaser.Utils.chanceRoll(50)?this.game.rnd.integerInRange(400,1e3):0}},{key:"explode",value:function(){var e=this;this.game.physics.arcade.moveToXY(this,this.x,this.y,0),this.isBomb?this.setBomb():(this.body.setSize(0,0,0,0),this.exploding=!0,this.canDropItem&&this.dropItem(),this.animations.play("explode").onComplete.add(function(){e.kill()}))}},{key:"setBomb",value:function(){this.inBombMode=!0,this.body.setSize(32,32,0,0),this.animations.play("bomb"),this.setBombTimer()}},{key:"setBombTimer",value:function(){var e=this.game.rnd.integerInRange(1200,2e3);this.lifeTimer=this.game.time.events.add(e,this.bombExplode,this)}},{key:"bombExplode",value:function(){var e=this;this.game.sfx.play("sfx_fireballExplode"),this.exploding=!0,this.game.physics.arcade.distanceBetween(this.game.player,this)<=90&&this.playerHit(),this.animations.play("bombExplode").onComplete.add(function(){e.kill()})}},{key:"hitPlayer",value:function(){this.exploding&&this.inBombMode||(this.explode(),this.isBomb||this.playerHit())}},{key:"dropItem",value:function(){Phaser.Utils.chanceRoll(20)&&this.generateItem("health",this.position)}},{key:"generateItem",value:function(e,t){var a=e||"health",n=null;if("health"===a){n=Phaser.Utils.chanceRoll(20)?Phaser.Utils.chanceRoll(30)?"super-health":"uber-health":"health"}var o={class:a,key:"powerup",subClass:n,type:"pickup"};new s.PickupItem(this.game,t.x,t.y,"sprites",n,o,!0)}},{key:"playerHit",value:function(){var e=this;if(!this.game.player.isHit){this.game.player.damage(1),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.game.player.body.velocity.setTo(0,600),this.game.player.isTalking=!0,this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player);this.game.time.events.add(100,function(){e.game.player.isTalking=!1,e.game.player.body.velocity.setTo(0);e.game.time.events.add(700,function(){e.game.player.isHit=!1})})}}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={"kq-q-kananaskis":{id:"kq-q-kananaskis",name:"The Answers you Seek are in Kananaskis",desc:"Elders Harper and Manning suggest journeying to Kananaskis Country where you'll find the guidance you seek.",nodes:[{complete:!1,map:"kq02-calgary-02",target:"kq-q-kananaskis-1",desc:"Head to Kananaskis Country"}]},"kq-q-quiz":{id:"kq-q-quiz",name:"The Key is Through the Quiz",desc:"Complete Naheed Nenshi's quiz to exit Calgary.",nodes:[{complete:!0,map:"kq02-calgary-01",target:"kq-q-quiz-1",desc:"Complete Naheed Nenshi's quiz to gain passage west of Calgary."},{complete:!1,map:"kq02-calgary-01",target:"kq-q-quiz-1",desc:"Complete Naheed Nenshi's quiz to gain passage west of Calgary."}]},"kq-q-coffee":{id:"kq-q-coffee",name:"Coffee Run",desc:"Get back into Jason Kenney's good graces and fetch everyone coffee.",nodes:[{complete:!1,map:"kq02-truckstop-00",target:"kq-q-coffee-1",desc:"Buy the coffee."},{complete:!1,map:"kq02-truckstop-00",target:"kq-q-coffee-2",desc:"Return to the airship."}]},"kq-q-avocadotoast":{id:"kq-q-avocadotoast",name:"The Toast of Champions",desc:"Bring Ravi, Leader of all Millennials, his favourite avocado toast.",nodes:[{complete:!1,map:"kq02-edmonton-00",target:"kq-q-avocadotoast-1",desc:""},{complete:!1,map:"kq02-edmonton-00",target:"kq-q-avocadotoast-2",desc:"Procure the fabled avocado toast then seek out its delicious fixings."},{complete:!1,map:"kq02-edmonton-00",target:"kq-q-avocadotoast-3",desc:"Return to The Leader of all Millennials once you have all the requested fixings."},{complete:!1,map:"kq02-edmonton-01",target:"kq-q-avocadotoast-4",desc:"Follow the jersey's power to the provincial legislature."}]},"kq-q-environment":{id:"kq-q-environment",name:"Follow the leads",desc:"Follow the advice from Edmontonians to find your way to one of the crystals.",nodes:[{complete:!1,map:"kq02-edmonton-00",target:"kq-q-environment-1",desc:""},{complete:!1,map:"kq02-edmonton-00",target:"kq-q-environment-2",desc:"Talk to the Edmonton Journal's Paula Simonsm for insider knowledge of the city."},{complete:!1,map:"kq02-edmonton-00",target:"kq-q-environment-3",desc:"Head here on path to crystal."},{complete:!1,map:"kq02-palace-00",target:"kq-q-environment-4",desc:"Take the crystal."}]},"kq-q-jersey":{id:"kq-q-jersey",name:"Follow the Jersey",desc:"The Oilers jersey should guide you to the hidden location of a crystal.",nodes:[{complete:!1,map:"kq02-edmonton-00",target:"kq-q-jersey-1",desc:""},{complete:!1,map:"kq02-edmonton-01",target:"kq-q-jersey-2",desc:"Follow the jersey's power to the provincial legislature."}]},"kq-q-edmontonjourney":{id:"kq-q-edmontonjourney",name:"Journey to Edmonton",desc:"Find a way to infiltrate Edmonton, the NDP's stronghold.",nodes:[{complete:!1,map:"kq02-calgary-03",target:"kq-q-edmontonjourney-1",desc:"Find a way to infiltrate Edmonton."},{complete:!1,map:"kq02-calgary-01",target:"kq-q-edmontonjourney-2",desc:"Enter the cave to Edmonton."},{complete:!1,map:"kq02-caves-01",target:"kq-q-edmontonjourney-3",desc:"Make your way to Edmonton."}]},"kq-q-carbontree":{id:"kq-q-carbontree",name:"Fell the Great Carbon Tax Tree!",desc:"The Enchanted Forest of Regulations threatens Alberta's job growth! The Great Carbon Tax Tree at its centre must be felled if the Alberta Advantage is to be restored.",nodes:[{complete:!1,map:"kq02-calgary-03",target:"kq-q-carbontree-1",desc:""},{complete:!1,map:"kq02-mountains-00",target:"kq-q-carbontree-2",desc:"Head to the Rockies where the Enchanted Forest of Regulations grows."},{complete:!1,map:"kq02-forest-00",target:"kq-q-carbontree-3",desc:"Make your way to the Great Carbon Tax Tree, which grows at the centre of the forest."},{complete:!1,map:"kq02-calgary-01",target:"kq-q-carbontree-4",desc:"The means by which the sygils' code is to be solved is found in Calgary town proper."},{complete:!1,map:"kq02-forest-00",target:"kq-q-carbontree-5",desc:"Finally, it's time to fell the Carbon Tax Tree!"}]},"kq-q-pipeline":{id:"kq-q-pipeline",name:"Stop the Warlord Horgan",desc:"Stop B.C.'s Chief Warlord's pillaging and destruction of pipeline projects in the Rockies.",nodes:[{complete:!1,map:"kq02-calgary-01",target:"kq-q-pipeline-1",desc:""},{complete:!1,map:"kq02-mountains-01",target:"kq-q-pipeline-2",desc:"Head to the mountain pass where you'll find Warlord Horgan."},{complete:!1,map:"kq02-calgary-03",target:"kq-q-pipeline-3",desc:"Retrieve the valve wheel to the pipeline."},{complete:!1,map:"kq02-mountains-01",target:"kq-q-pipeline-4",desc:"Use the valve wheel on the pipeline."},{complete:!1,map:"kq02-mountains-01",target:"kq-q-pipeline-5",desc:"Confront the Warlord Horgan"}]},"kq-q-ratking":{id:"kq-q-ratking",name:"Defeat the Vermin King",desc:"Vanquish the Vermin King and restore Alberta's rat-free status.",nodes:[{complete:!1,map:"kq02-badlands-00",target:"kq-q-ratking-1",desc:""},{complete:!1,map:"kq02-badlands-00",target:"kq-q-ratking-2",desc:"Head to the badlands and locate the keys to open the Vermin King's lair."},{complete:!1,map:"kq02-badlands-01",target:"kq-q-ratking-3",desc:"Defeat the Vermin King in glorious armed combat."},{complete:!1,map:"kq02-badlands-01",target:"kq-q-ratking-4",desc:"Defeat the Vermin King in glorious armed combat."}]},"kq-q-test":{id:"kq-q-test",name:"Test quest",desc:"Test quest for Kenney's Quest 2",nodes:[{complete:!1,map:"kq02-calgary-02",target:"kq-q-test-1",desc:"Description for kq-q-test node 1"},{complete:!1,map:"kq02-pantheon-00",target:"kq-q-test-2",desc:"Description for kq-q-test node 2"},{complete:!1,map:"kq02-calgary-00",target:"kq-q-test-3",desc:"Description for kq-q-test node 3"}]},"kq-q-test-02":{id:"kq-q-test-02",name:"Test quest",desc:"Test quest for Kenney's Quest 2",nodes:[{complete:!1,map:"kq02-test-02",target:"kq-q-test-02-1",desc:"Description for kq-q-test-02 node 1"},{complete:!1,map:"kq02-test-04",target:"kq-q-test-02-2",desc:"Description for kq-q-test-02 node 2"}]}}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.Trigger=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return h.game=e,h.game.physics.arcade.enable(h),h.body.onOverlap=new Phaser.Signal,h.body.setSize(64,64,0,0),h.data=l,h.anchor.setTo(.5),h.frameName=s+".png",h}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(0),h=n(l),c=a(20),u=(n(c),a(46)),d=a(45),g=a(33),m=a(44),p=a(26),y=n(p),f=a(27),v=n(f);t.Game=function(e){function t(){var e;o(this,t);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];var l=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return l.player=null,l.isDungeon=!0,l.controls={dpad:null,apad:null,stick:null,pad:null},l.startingPosition=[480,348],l.quests=a(20),l.quests=l.quests.default,l.data={players:{jasonKenney:{name:"Jason Kenney",dI:0,inventory:[],portrait:"kenney",quests:[],crystals:[],health:8,maxHealth:8,startingCoords:{x:450,y:380},completedQuests:[],quizScore:0,quizQuestionsAnswered:0,hasCompanion:!1,inDisguise:!1},rachelNotley:{name:"Rachel Notley",dI:0,inventory:[],portrait:"notley-active",quests:[],crystals:["Crystal of Social License"],health:8,maxHealth:8,startingCoords:{x:0,y:0},completedQuests:[]},derekFildebrandt:{name:"Derek Fildebrandt",dI:0,inventory:[],portrait:"fildebrandt",quests:[],crystals:["Crystal of Rugged Individualism"],health:8,maxHealth:8,startingCoords:{x:0,y:0},completedQuests:[]}},textStyle:{font:"VT323",fontSize:32,lineSpacing:-7,fill:"#fff",wordWrap:!0,wordWrapWidth:l.width-80,fixedToCamera:!0},companion:{}},l.globalAchievements={crystalsLive:!1,quizComplete:!1,starkeConvo:!1,fildebrandtGetsYouCoffee:!1,edmonton_ndp_cutscene:!1,avocadoToast:{sriracha:!1,egg:!1,bacon:!1,previous:""},marchToWar:!1,finalStage:!1},l.quiz=v.default,l.sendMessage=function(e){parent.postMessage(e,"http://bricey-pwa-test.herokuapp.com/")},l.flashInterval=null,l.flash=function(e,t,a){var n=0,o=setInterval(function(){if(1===e.alpha?e.alpha=0:e.alpha=1,6===++n&&(clearInterval(o),e.visible=!0,t)){l.add.tween(e.alpha).to(0,1600,null,!0).onComplete.addOnce(a)}},100)},l.musicHandler=new m.MusicHandler(l),l.npcFunctions=new u.NpcFunctions(l),l.npcDialogue=new d.NpcDialogue(l),l.actions=new g.Cutscene(l),l.atlas=y.default,l.stageInitFunction=[],l.stageDismissFunction=[],l.currentCharacter="jasonKenney",l.currentStage="",h.default.mixin(l),l}return r(t,e),s(t,[{key:"setDebug",value:function(e){this.game.debug.text("Debugging data: "+e,12,70,"Segoe UI")}}]),t}(Phaser.Game)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.StateManager=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),r=function(e){return e&&e.__esModule?e:{default:e}}(i),s=a(57),l=a(61),h=a(58),c=a(59),u=a(60),d=a(62),g=a(56);t.StateManager=function(){function e(t){n(this,e),this.game=null,this.game=t,this.setupStates(),this.setupNativeListeners(),this.setupListeners()}return o(e,[{key:"setupStates",value:function(){this.game.state.add("Bootstrap",s.BootstrapState),this.game.state.add("Loading",l.LoadingState),this.game.state.add("Intro",u.IntroState),this.game.state.add("StartMenu",d.StartMenuState),this.game.state.add("Game",h.ExampleState),this.game.state.add("Gameover",c.GameoverState),this.game.state.add("Battle",g.BattleState)}},{key:"setupNativeListeners",value:function(){this.game.state.onStateChange.add(function(e,t){console.debug("Enter to new state: %s",e)})}},{key:"setupListeners",value:function(){var e=this;this.game.on(r.default.BOOTSTRAP_COMPLETED,function(){e.game.state.start("Loading")}),this.game.on(r.default.LOADING_COMPLETED,function(){e.game.state.start("Intro")})}},{key:"start",value:function(){this.game.state.start("Bootstrap")}}]),e}()},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={"kq02-intro":{isDungeon:!0,nodes:[]},"kq02-calgary-00":{isDungeon:!1,nodes:["kq02-calgary-01"],music:"camp"},"kq02-calgary-01":{isDungeon:!1,nodes:["kq02-calgary-00","kq02-calgary-02","kq02-calgary-03","kq02-badlands-00"],music:"camp"},"kq02-calgary-02":{isDungeon:!0,nodes:["kq02-pantheon-00","kq02-calgary-01","kq02-mountains-00"],music:"theme-dungeon"},"kq02-calgary-03":{isDungeon:!1,nodes:["kq02-calgary-01"],music:"camp"},"kq02-pantheon-00":{isDungeon:!1,suppressWaypoints:!0,nodes:[],music:"theme-pantheon"},"kq02-palace-00":{isDungeon:!1,suppressWaypoints:!0,nodes:[],music:"theme-ndp"},"kq02-mountains-00":{isDungeon:!0,nodes:["kq02-calgary-02","kq02-mountains-01","kq02-forest-00"],music:"theme-dungeon"},"kq02-mountains-01":{isDungeon:!0,nodes:["kq02-mountains-00"],music:"theme-dungeon"},"kq02-forest-00":{isDungeon:!0,nodes:["kq02-mountains-00"],music:"theme-dungeon"},"kq02-badlands-00":{isDungeon:!0,nodes:["kq02-calgary-01","kq02-badlands-01"],music:"theme-dungeon"},"kq02-badlands-01":{isDungeon:!0,nodes:["kq02-badlands-00"],music:"theme-dungeon"},"kq02-caves-00":{isDungeon:!0,nodes:["kq02-caves-01"],music:"theme-dungeon"},"kq02-caves-01":{isDungeon:!1,nodes:["kq02-edmonton-03","kq02-caves-00"]},"kq02-edmonton-02":{isDungeon:!1,nodes:["kq02-edmonton-00"],music:"camp"},"kq02-edmonton-01":{isDungeon:!0,nodes:["kq02-edmonton-00"],music:"camp"},"kq02-edmonton-00":{isDungeon:!1,nodes:["kq02-edmonton-01","kq02-edmonton-02","kq02-edmonton-03","kq02-palace-00"],music:"camp"},"kq02-edmonton-03":{isDungeon:!1,nodes:["kq02-caves-01"],music:"camp"},"kq02-battle-01":{isDungeon:!0,nodes:["kq02-edmonton-01"]},"kq02-battle-00":{isDungeon:!0,nodes:[]},"kq02-airship-00":{isDungeon:!0,nodes:[]},"kq02-truckstop-00":{isDungeon:!1,nodes:["kq02-airship-00"]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{q:"In what year did Alberta become a province?",a:["1905","1897","1902","1910"],c:0,cA:"Correct! Alberta and Saskatchewan were originally districts of the Northwest Territories and established as provinces together.",incA:"Incorrect! Alberta and Saskatchewan were originally districts of the Northwest Territories and established as provinces together in 1905."},{q:"How many electoral ridings does Alberta have currently?",a:["91","76","87","84"],c:2,cA:"Correct! It was changed from 83 to 87 for the 2012 general election.",incA:"Incorrect! It's, in fact, 87. Better get it right if you're going to run candidates, Jason."},{q:"In 2018, how much did royalties from non-renewable energy resources make up Alberta's government revenue?",a:["22%","45%","30%","37%"],c:2,cA:"Correct!",incA:"Incorrect! It's actually 30%."},{q:"What is Alberta's official stone?",a:["Shale","Cabochon","Coprolite","Petrified wood"],c:3,cA:"Correct!",incA:"Incorrect! It's petrified wood."},{q:"What is Alberta's second most-farmed beef-producing cattle breed?",a:["Chianna","Charolais","Angus","Hereford"],c:1,cA:"Correct! The first is, of course, Angus.",incA:"Incorrect! The correct answer is Charolais."},{q:"What is the motto of Alberta?",a:["All hail the Hand, guardian of the free market","Strong and free","Loyal to the Crown","From many peoples, strength"],c:1,cA:"You're correct!",incA:"Incorrect! It's 'Strong and Free.'"},{q:"How many parties have governed Alberta since the province's creation?",a:["Four","Three","Five","Six"],c:2,cA:"Correct! The Alberta Liberals, the United Farmers of Alberta, Social Credit, Progressive Conservatives, and now the NDP.",incA:"Incorrect! The answer is five."},{q:"What is the total percentage of Canada's proven oil reserves globally?",a:["19%","8%","10%","16%"],c:2,cA:"That's correct! Canada comes in second after Venezuela (18%), and Saudi Arabia (16%). It ties with Iran.",incA:"Incorrect! It is 10%."},{q:"Which one of these unconventional oil sources is NOT found in Alberta?",a:["Tight","Shale","Coal conversion","Thermal"],c:3,cA:"Correct! Alberta does not use thermal depolymerization to recover energy.",incA:"Incorrect! The answer is thermal, as in thermal depolymerization."},{q:"What is located at the summit of the Alberta legislature's entrance hall?",a:["Stone from a meteor","Dinosaur skeleton","Palm trees","Pioneer wagon"],c:2,cA:"Correct! And the full story of their origins is long forgotten",incA:"Incorrect! The answer is palm trees."},{q:"For much did the federal government purchase the Trans Mountain pipeline project?",a:["$3.8 billion","$5.7 billion","$4.5 billion","$5.2 billion"],c:2,cA:"Correct! And they plan to twin the pipeline at projected cost of another $7.4 billion.",incA:"Incorrect! It was $4.5 billion they purchase the project for. And they plan to twin it at an additional $7.4 billion."}]},function(e,t,a){"use strict";var n=a(22),o=a(23),i=a(14);document.oncontextmenu=function(){return!1};var r=new i.Dimensions(940,600),s=Phaser.Device.desktop?Phaser.AUTO:Phaser.CANVAS,l=new n.Game(r.w,r.h,s,"app");new o.StateManager(l).start()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Wheel=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bc-ndp",s=arguments[4];n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s));return l.anchor.setTo(.5),l.animations.add("drive",Phaser.Animation.generateFrameNames("wheel_",0,2,".png"),8,!0),l.animations.play("drive"),l}return i(t,e),r(t,[{key:"stop",value:function(){this.animations.stop()}}]),t}(Phaser.Sprite),t.Drummer=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bc-ndp",s=arguments[4];n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.anchor.setTo(.5),l.animations.add("drum",Phaser.Animation.generateFrameNames("drummers_"+s+"_",0,1,".png"),3,!0),l.animations.play("drum"),l}return i(t,e),r(t,[{key:"stop",value:function(){this.animations.stop(),this.frameName="drummers_"+colour+"_2.png"}}]),t}(Phaser.Sprite),t.Suzuki=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bc-ndp";return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r))}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BCNdp=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(29);t.BCNdp=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.game=e,l.game.physics.arcade.enable(l),l.anchor.setTo(.5,0),l.frameName="trigger.png",l.parts={},e.add.existing(l),l.parts.wheel_RF=new s.Wheel(l.game,-170,610,"bc-ndp"),l.parts.wheel_RB=new s.Wheel(l.game,-180,300,"bc-ndp"),l.parts.wheel_LF=new s.Wheel(l.game,170,610,"bc-ndp"),l.parts.wheel_LB=new s.Wheel(l.game,180,300,"bc-ndp"),l.addChild(l.parts.wheel_RF),l.addChild(l.parts.wheel_RB),l.addChild(l.parts.wheel_LF),l.addChild(l.parts.wheel_LB),l.parts.propeller_R=l.game.add.sprite(-141,320,"bc-ndp","propeller.png"),l.parts.propeller_L=l.game.add.sprite(141,320,"bc-ndp","propeller.png"),l.parts.propeller_R.anchor.setTo(.5,.579),l.parts.propeller_L.anchor.setTo(.5,.579),l.parts.body=l.game.add.sprite(0,0,"bc-ndp"),l.parts.body.anchor.setTo(.5,0),l.addChild(l.parts.body),l.parts.drummer_01=new s.Drummer(l.game,-66,595,"bc-ndp","b"),l.parts.drummer_02=new s.Drummer(l.game,-66,635,"bc-ndp","w"),l.parts.drummer_03=new s.Drummer(l.game,-66,675,"bc-ndp","b"),l.parts.drummer_04=new s.Drummer(l.game,66,595,"bc-ndp","w"),l.parts.drummer_05=new s.Drummer(l.game,66,635,"bc-ndp","b"),l.parts.drummer_06=new s.Drummer(l.game,66,675,"bc-ndp","w"),l.addChild(l.parts.drummer_01),l.addChild(l.parts.drummer_02),l.addChild(l.parts.drummer_03),l.addChild(l.parts.drummer_04),l.addChild(l.parts.drummer_05),l.addChild(l.parts.drummer_06),l.guard_01=l.game.add.sprite(-130,220,"bc-ndp","guard_0.png"),l.guard_02=l.game.add.sprite(130,220,"bc-ndp","guard_1.png"),l.guard_01.anchor.setTo(.5),l.guard_02.anchor.setTo(.5),l.guard_02.scaleX=-1,l.addChild(l.guard_01),l.addChild(l.guard_02),l.horgan=l.game.add.sprite(0,290,"bc-ndp"),l.horgan.anchor.setTo(.5),l.horgan.animations.add("gesticulate",Phaser.Animation.generateFrameNames("horgan_",0,1,".png"),6,!0),l.horgan.animations.play("gesticulate"),l.addChild(l.horgan),l.suzuki=l.game.add.sprite(0,170,"bc-ndp"),l.suzuki.anchor.setTo(.5),l.suzuki.animations.add("shred",Phaser.Animation.generateFrameNames("suzuki_",0,1,".png"),5,!0),l.suzuki.animations.play("shred"),l.addChild(l.suzuki),l.addChild(l.parts.propeller_R),l.addChild(l.parts.propeller_L),l}return i(t,e),r(t,[{key:"update",value:function(){this.parts.propeller_R.angle+=15,this.parts.propeller_L.angle+=15}},{key:"stop",value:function(){this.parts.wheel_RF.stop(),this.parts.wheel_RB.stop(),this.parts.wheel_LF.stop(),this.parts.wheel_LB.stop(),this.suzuki.animations.stop(),this.horgan.animations.stop()}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.BossFight=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.BossFight=function(){function e(t,a,o){var i=this;n(this,e),this.boundary=null,this.playMainBossTheme=function(){i.game.musicHandler.play("boss-main")},this.create_camera_bottom_boundary=function(){i.boundary=i.game.add.sprite(0,i.game.camera.height,"sprites","trigger.png"),i.game.physics.arcade.enable(i.boundary),i.boundary.body.immovable=!0,i.boundary.body.onCollide=new Phaser.Signal,i.boundary.body.setSize(i.game.camera.width,32),i.game.objGroup.add(i.boundary)},this.game=t,this.boss=a,this.bossType=o,r.default.mixin(this),this.lifeMeterFrame=this.game.add.graphics(0,0),this.lifeMeterFrame.beginFill(0,1),this.lifeMeterFrame.drawRect(0,0,this.game.camera.width,6),this.lifeMeterFrame.endFill(),this.lifeMeterFrame.anchor.setTo(0,0),this.lifeMeterFrame.fixedToCamera=!0,this.lifeMeterFrame.scale.x=1,this.lifeMeter=this.game.add.graphics(0,0),this.lifeMeter.beginFill(2741801,1),this.lifeMeter.drawRect(0,0,this.game.camera.width,6),this.lifeMeter.endFill(),this.lifeMeter.anchor.setTo(0,0),this.lifeMeter.fixedToCamera=!0,this.lifeMeter.scale.x=1,this.game.UIGroup.add(this.lifeMeterFrame,this.lifeMeter),this.boss.on("bossHit",this.bossHit,this),this.resetBossFight(o),this.game.inventoryButton.on("inventoryEngaged",this.pauseTimers,this),this.game.questsButton.on("questsEngaged",this.pauseTimers,this),this.game.inventoryButton.on("inventoryClosed",this.activateTimers,this),this.game.questsButton.on("questsClosed",this.activateTimers,this),"dragon"!==this.bossType&&(this.game.musicHandler.stop(),this.game.musicHandler.play("boss-intro"),this.game.time.events.add(15140,this.playMainBossTheme,this)),this.create_camera_bottom_boundary()}return o(e,[{key:"pauseTimers",value:function(){this.boss.attackTimer&&this.boss.attackTimer.timer.pause(),this.boss.pauseTimer&&this.boss.pauseTimer.timer.pause(),this.boss.movePauseTimer&&this.boss.movePauseTimer.timer.pause(),this.boss.moveTimer&&this.boss.moveTimer.timer.pause()}},{key:"activateTimers",value:function(){this.boss.attackTimer&&this.boss.attackTimer.timer.resume(),this.boss.pauseTimer&&this.boss.pauseTimer.timer.resume(),this.boss.movePauseTimer&&this.boss.movePauseTimer.timer.resume(),this.boss.moveTimer&&this.boss.moveTimer.timer.resume()}},{key:"bossHit",value:function(){var e=this;if(console.log("BOSS HIT"),this.boss.health>0)if(this.boss.health--,this.game.sfx.play("sfx_enemyHit"),this.lifeMeter.scale.x=this.boss.health/this.boss.maxHealth,this.boss.health<=0)this.endBossFight();else if(this.boss.children.length>0&&"rat-king"!==this.bossType)this.childTints();else{this.boss.tint=16711680;this.game.time.events.add(100,function(){e.boss.tint=16777215})}}},{key:"childTints",value:function(){var e=this;this.boss.tint=16711680,"invisible-hand"!==this.boss&&this.boss.children.forEach(function(e){e.tint=16711680});this.game.time.events.add(100,function(){e.boss.tint=16777215,"invisible-hand"!==e.boss&&e.boss.children.forEach(function(e){e.tint=16777215})})}},{key:"endBossFight",value:function(){switch(this.game.stageInitFunction[0]="",this.game.musicHandler.stop(),void 0!==this.boss.moveTimer&&this.boss.moveTimer.timer.remove(),void 0!==this.boss.attackTimer&&this.boss.attackTimer.timer.remove(),this.game.time.events.removeAll(),this.lifeMeterFrame.destroy(),this.lifeMeter.destroy(),this.boundary.destroy(),this.bossType){case"dragon":this.game.npcFunctions.end_dragon_bossFight(this.boss);break;case"rat-king":this.game.npcFunctions.end_ratKing_bossFight(this.boss);break;case"invisible-hand":this.game.npcFunctions.end_invisibleHand_bossFight(this.boss)}}},{key:"resetBossFight",value:function(e){switch(e){case"dragon":this.game.stageInitFunction[0]=this.game.npcFunctions.launch_dragon_bossFight;break;case"rat-king":this.game.stageInitFunction[0]=this.game.npcFunctions.launch_ratKing_bossFight;break;case"invisible-hand":this.game.stageInitFunction[0]=this.game.npcFunctions.finalBoss_restart}}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.ButtonMash=function e(t,a){var o=this;n(this,e),this.update=function(){switch(o.progBar.scale.x+=o.challengeDegree[o.currentChallengeDegree],o.elapsed++,o.progBar.scale.x>=1&&o.challengeOver(!1),console.log(o.elapsed),o.elapsed){case 200:o.increaseDifficulty(1);break;case 420:o.increaseDifficulty(2)}},this.increaseDifficulty=function(e){o.currentChallengeDegree=e,o.game.camera.flash(16711680,400)},this.action=function(){o.game.sfx.play("sfx_buttonMash"),o.progBar.scale.x-=o.actionDegree,o.progBar.scale.x<=0&&(o.progBar.scale.x=0)},this.initButtonMash=function(){o.game.player.isTalking=!0,o.progBarFrame.scale.x=1,o.textWindow=o.game.add.graphics(o.game.width/2,o.game.height/2-42),o.textWindow.lineStyle(2,16777215,1),o.textWindow.beginFill(0,1),o.textWindow.drawRoundedRect(-210,-60,420,120),o.textWindow.endFill(),o.textWindow.anchor.setTo(.5),o.textWindow.fixedToCamera=!0,o.heroText=o.game.add.bitmapText(o.game.camera.width/2,o.game.camera.height/2-42,"VT323","Hit the Action Button!",38),o.heroText.anchor.setTo(.5),o.heroText.align="center",o.heroText.fixedToCamera=!0,o.actionKey=o.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),o.actionKey.onDown.add(o.action,o),o.progBarLoop=o.game.time.events.loop(Phaser.Timer.SECOND/60,o.update,o),o.challengeTimer=o.game.time.events.add(o.timerLength,function(){o.challengeOver(!0)},o)},this.challengeOver=function(e){o.endChallenge(),o.game.time.events.add(300,function(){e?o.challengeSuccessful():o.challengeFailed()})},this.challengeSuccessful=function(){o.endChallenge(),o.game.dialogue.sign(o.successMsg,"alert",null,function(){o.endFunctions[0]()})},this.challengeFailed=function(){o.endChallenge(),o.game.dialogue.sign(o.failMsg,"alert",null,function(){o.endFunctions[1]()})},this.endChallenge=function(){o.game.time.events.remove(o.progBarLoop),o.game.time.events.remove(o.challengeTimer),o.progBarFrame.destroy(),o.progBar.destroy(),o.heroText.destroy(),o.textWindow.destroy(),o.actionKey.onDown.remove(o.action,o)},this.game=t,this.challengeActive=!1,this.challengeDegree=[.0075,.0084,.0088],this.currentChallengeDegree=0,this.actionDegree=.0567,this.timerLength=1e4,this.elapsed=0;var i=this.game._MOBILE?200:80;this.progBarFrame=this.game.add.graphics(40,this.game.camera.height-100),this.progBarFrame.beginFill("0xffffff",.22),this.progBarFrame.drawRect(0,0,this.game.camera.width-i,40),this.progBarFrame.endFill(),this.progBarFrame.anchor.setTo(0,0),this.progBarFrame.fixedToCamera=!0,this.progBarFrame.scale.x=0,this.progBar=this.game.add.graphics(40,this.game.camera.height-100),this.progBar.beginFill("0xffffff",1),this.progBar.drawRect(0,0,this.game.camera.width-i,40),this.progBar.endFill(),this.progBar.anchor.setTo(0,0),this.progBar.fixedToCamera=!0,this.progBar.scale.x=0;var r=void 0;switch(this.successMsg="",this.failMsg="",this.endFunctions=[],a){case"fildebrandt":r="Derek must not create a scene that would embarrass Jason Kenney! Mash the action button (spacebar) to control Derek's incendiary temper towards urban liberal effeteness!",this.successMsg="Phew! Urge for outburst ... fading ...",this.failMsg="Uh-oh. Nobody controls Derek Fildebrandt but Derek himself!",this.endFunctions[0]=this.game.npcFunctions.fildebrandt_winsChallenge,this.endFunctions[1]=this.game.npcFunctions.fildebrandt_losesChallenge;break;case"avocadoToast":r="You're in deep! Mash the action button (spacebar) to resist the tempation of the toast.",this.successMsg="*Phew*! Temptation evaded.",this.failMsg="Oh no! You must now admit to yourself avocado spread on toast is pretty darn good.",this.endFunctions[0]=this.game.npcFunctions.avocadoToast_win,this.endFunctions[1]=this.game.npcFunctions.avocadoToast_lose}this.game.dialogue.sign(r,"instruction",!0),this.game.dialogue.on("beginButtonMashChallenge",this.initButtonMash,this)}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Cutscene=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(4),s=a(3),l=a(15);t.Cutscene=function(){function e(t){n(this,e),this.game=t}return i(e,[{key:"getCharacter",value:function(e){return this.game.NPCGroup.children.filter(function(t){return t.data.character===e})[0]}},{key:"getBoatCharacter",value:function(e){var t=this.game.objGroup.children[0].children[1];return t.frameName="npc-"+t.data.id+"-mf/_01.png",t}},{key:"getCompanion",value:function(e){var t=this.game.NPCGroup.children[this.game.NPCGroup.children.length-1];return e&&(t.data.dI=e),t}},{key:"getEnemy",value:function(e){return this.game.enemyGroup.getIndex(e)}},{key:"setCharacterDICache",value:function(e,t,a){this.game.cache.getTilemapData(a).data.layers[4].objects.filter(function(t){if(t.hasOwnProperty("properties"))return t.properties.character===e})[0].properties.dI=t}},{key:"removeFromCachedObject",value:function(e,t,a){var n=this.game.cache.getTilemapData(a).data.layers[4].objects,o=n.filter(function(t){if(t.hasOwnProperty("properties"))return t.properties.character===e})[0];void 0!==o&&delete o.properties[t]}},{key:"addToCachedObject",value:function(e,t,a){var n=this.game.cache.getTilemapData(a).data.layers[4].objects,o=n.filter(function(t){if(t.hasOwnProperty("properties"))return t.properties.character===e})[0];void 0===o&&(console.log("YEAH, UNDEFINED"),console.log(n),o=n.filter(function(t){if(t.hasOwnProperty("properties"))return t.properties.initFunction===e})[0]),void 0!==o&&(o.properties[Object.keys(t)[0]]=t[Object.keys(t)[0]])}},{key:"setMapChangeProps",value:function(e,t,a){this.game.cache.getTilemapData(a).data.layers[4].objects.filter(function(t){if(t.hasOwnProperty("properties"))return t.properties.stage===e}).forEach(function(e){e.properties=t})}},{key:"getWaypointIndex",value:function(e){var t=this.game.waypointGroup.children.findIndex(function(t){return t.data.questId===e});return console.log("FOUND WAYPOINT IS:",t),t}},{key:"setDICache",value:function(e,t){if(e.data.index){var a=this.game.cache.getTilemapData(t).data.layers[4].objects,n=e.data.index,o=e.data.dI;a[n]&&a[n].properties&&(a[n].properties.dI=o)}}},{key:"checkForQuestNodeId",value:function(e,t){var a=this.getCharacter(e);return!(!a.data.hasOwnProperty("questNodeId")||a.data.questNodeId!==t)}},{key:"animateNPCs",value:function(e,t,a,n,o){var i=this,r=[];o?a.forEach(function(e){r.push(i.getCharacter(e))}):r=this.game[t].children,r.forEach(function(t){t.animations.play(e)}),n&&r.forEach(function(e){e.animations.stop()})}},{key:"animatedEnemies",value:function(e,t,a){}},{key:"jump",value:function(e,t,a,n){var o=this,i=a||0,r=this.game.add.tween(e.position).to({y:e.position.y-40},t,"Linear",!0);this.game.sfx.play("sfx_jump_upDown",.45),r.yoyo(!0,50),r.onComplete.add(function(){o.game.time.events.add(i,function(){n&&n()})})}},{key:"walk",value:function(e,t,a,n,o,i){var r=t.x,s=t.y,l=e.position;this.setAnimation(e,r,s),this.game.add.tween(e.position).to({x:l.x+r,y:l.y+s},a,null,!0,n).onComplete.add(function(){e.animations.stop(),i&&e.animations.play("walk-forward").stop(),o&&o()})}},{key:"walkTo",value:function(e,t,a,n,o,i){var r=t.x,s=t.y;e.position;this.setAnimation(e,r,s,!0),this.game.add.tween(e.position).to({x:r,y:s},a,null,!0,n).onComplete.add(function(){e.animations.stop(),i&&e.animations.play("walk-forward").stop(),o&&o()})}},{key:"randomQuizQ",value:function(e){return this.game.rnd.integerInRange(0,this.game.quiz.length-1)}},{key:"addFlame",value:function(e,t,a){var n={objectType:a+"-fire",type:"object"},o=new r.Obj(this.game,e,t,"sprites","",n);return this.game.objGroup.add(o),o.alpha=0,this.game.add.tween(o).to({alpha:1},600,null,!0),this.game.sfx.play("sfx_flame"),o}},{key:"enterDeity",value:function(e,t,a,n,o){var i=this,r=this.addFlame(t,a,n);this.game.add.tween(r.position).to({y:r.position.y+40},1800,"Quad.easeOut",!0).onComplete.add(function(){var t={character:e.character,id:e.id,key:"npc",name:e.character,type:"npc",static:!0};t.dI=e.dI?e.dI:0,e.portrait&&(t.portrait=e.portrait),console.log({charData:t});var a=new s.NPC(i.game,r.x,r.y,"sprites","",t);i.game.NPCGroup.add(a),r.destroy(),a.animations.play("celebrate"),i.game.time.events.add(1e3,function(){a.frameName="npc-"+e.id+"-mf/_01.png",o&&i.game.time.events.add(1e3,function(){i.game.dialogue.initDialogue(null,a,!0)})})})}},{key:"setNewCachePosition",value:function(e,t,a,n){var o=this.game.cache.getTilemapData(e).data.layers[4].objects,i=t.data.index;o[i].x=a,o[i].y=n,console.log(t.data.name+" now in cache as:",o[i])}},{key:"setNewCacheObject",value:function(e,t){this.game.cache.getTilemapData(e).data.layers[4].objects.push(t)}},{key:"removeCacheObject",value:function(e){for(var t=this,a=null,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var s=i.length,l=this.game.cache.getTilemapData(e).data.layers[4].objects,h=0;l.length>h;h++){var c=function(n){var o=0;if(i.forEach(function(e){l[n].hasOwnProperty("properties")&&l[n].properties[e[0]]===e[1]&&o++}),s===o)return a=n,t.removeCacheObjectByIndex(e,a),{v:void 0}}(h);if("object"===(void 0===c?"undefined":o(c)))return c.v}}},{key:"removeCacheObjectByIndex",value:function(e,t){this.game.cache.getTilemapData(e).data.layers[4].objects.splice(t,1)}},{key:"changeMapTiles",value:function(e,t,a){console.log("map is:",e);var n=this.game.cache.getTilemapData(e).data.layers;if(void 0===n)return void console.error("Could not find provided map!");var o=n.findIndex(function(e){return e.name===t});console.log("mapIndex is:",o);var i=n[o].data;for(var r in a){var s=parseInt(r);i[s]=a[r],console.log(s,a[r])}}},{key:"setAnimation",value:function(e,t,a,n){var o=t+(n?0:e.position.x),i=a+(n?0:e.position.y),r=this.game.world.isDungeon?"armed":"walk",s="",l=this.game.physics.arcade.angleToXY(e,o,i);console.log("targetAngle:",l),l>-.785&&l<.785?s="left":l>.785&&l<2.356?s="forward":l<-.785&&l>-2.356?s="backward":(l>-2.356||l<-2.356)&&(s="right"),e===this.game.player?e.animations.play(r+"-"+s):e.animations.play("walk-"+s)}},{key:"createMapObjectForCache",value:function(e,t,a,n,o,i){return{gid:e,height:o,id:0,name:"",properties:i,rotation:0,type:"",visible:!0,width:n,x:t,y:a}}},{key:"playHorn",value:function(e){var t=this;e.isHonking||function(){var a=function(){"green"===e.data.colour?e.frameName=e.data.colour+"_03.png":e.frameName=e.data.colour+"_01.png"};e.isHonking=!0,t.game.dialogue.alert(function(){for(var t="",a=0;a<e.data.sigil;a++)t=t.concat("Honk! ");return t}(),"acquired");for(var n=0;n<e.data.sigil;n++)!function(n){t.game.time.events.add(600*n,function(){console.log(e.isHonking),a(),t.game.time.events.add(200,function(){e.frameName=e.data.colour+"_lit.png",t.game.sfx.play("sfx_carHorn"),console.log(n,e.data.sigil),n===e.data.sigil-1&&t.game.time.events.add(300,function(){e.isHonking=!1,a()})})})}(n)}()}},{key:"activateSigil",value:function(e){var t=this;if(console.log(this.game.objGroup.children),!e.activated){var a=["red","yellow","blue","grey","green"],n=e.data.colour;e.frameName==="sygil-"+n+"-off.png"&&(e.frameName="sygil-"+n+"-on.png",this.game.sfx.play("sfx_flame"),this.game.sigilOrder=this.game.sigilOrder||[],this.game.sigilOrder.push(n),5===this.game.sigilOrder.length&&(JSON.stringify(a)===JSON.stringify(this.game.sigilOrder)?function(){t.game.camera.shake(.006,1e3),t.game.sfx.play("sfx_shake"),t.game.camera.onShakeComplete.addOnce(function(){t.game.mapWorld.updateWaypoint("kq-q-carbontree-4"),t.changeMapTiles("kq02-forest-00","collision",{907:0,908:0,909:0,910:0,911:0,912:0,913:0,914:0,915:0,916:0,917:0,918:0,919:0,920:0,921:0}),t.removeCacheObject("kq02-forest-00",["objectType","sigil"],["colour","red"]),t.removeCacheObject("kq02-forest-00",["objectType","sigil"],["colour","yellow"]),t.removeCacheObject("kq02-forest-00",["objectType","sigil"],["colour","blue"]),t.removeCacheObject("kq02-forest-00",["objectType","sigil"],["colour","grey"]),t.removeCacheObject("kq02-forest-00",["objectType","sigil"],["colour","green"]);for(var e=0;e<5;)t.game.objGroup.children[0].destroy(),e++;t.game.mapWorld.changeStage(null,{targetPosition:t.game.player.x+","+t.game.player.y,targetMap:t.game.currentStage})})}():function(){t.game.time.events.add(1e3,function(){console.error("WRONG!"),t.game.sigilOrder=[],t.game.objGroup.children.forEach(function(e){console.log("SORTING!",e),"sigil"===e.data.objectType&&(e.frameName="sygil-"+e.data.colour+"-off.png",e.activate=!1)});var e=new l.Troll(t.game,120,820,"sprites",null,{alertRange:15,character:"Troll",id:"01",key:"troll",type:"enemy"}),a=new l.Troll(t.game,850,820,"sprites",null,{alertRange:15,character:"Troll",id:"01",key:"troll",type:"enemy"});t.game.enemyGroup.add(e),t.game.enemyGroup.add(a)})}()))}}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ogre=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(7),l=a(47);t.Ogre=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],h=arguments[5];n(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,h));return c.game=e,c._MAXSPEED=55,c._ADDSPEED=c.game.rnd.between(5,10),c._STRIKE_VELOCITY=450,c.body.setSize(36,40,0,8),c.health=c.game.rnd.integerInRange(3,5),c.animations.add("walk",Phaser.Animation.generateFrameNames("ogre-mf/_0",1,4,".png"),5,!0),c.animations.add("attack",Phaser.Animation.generateFrameNames("ogre-af/_0",1,4,".png"),5,!0),c.animations.add("death",Phaser.Animation.generateFrameNames("ogre-death/_0",1,4,".png"),6,!1),c.ball=new l.Ball(c.game,21,-10,"sprites","ball.png",c),c.ball.currentState="_RESTING",c.ballTween=c.game.add.tween(c.ball.swingRadius).to(0,200,"Quad.easeOut"),c.addChild(c.ball),c.movementTimer=null,c.swingTimer=null,c.currentState="_PATROL",c.setState("_PATROL"),c}return i(t,e),r(t,[{key:"update",value:function(){if(null===this)return this.ball.chain.clear(),this.ball.destroy(),void this.game.sfx.stop("sfx_ball");if(!(this.game.player.isTalking||this.game.player.questsActive||this.game.player.inventoryActive)&&(this.game.physics.arcade.collide(this.game.player,this.ball,this.ball.playerHit,null,this.ball),"_RESTING"===this.ball.currentState?(this.ball.x=12,this.ball.y=0,this.ball.updateChain(),this.game.sfx.stop("sfx_ball")):"_SWINGING"===this.ball.currentState&&(this.ball.isSwinging?this.ball.isSwinging&&(this.ball.x=Math.cos(this.game.time.now*this.ball.swingPeriod)*this.ball.swingRadius,this.ball.y=Math.sin(this.game.time.now*this.ball.swingPeriod)*this.ball.swingRadius,this.ball.updateChain()):(this.ball.isSwinging=!0,this.game.sfx.play("sfx_ball"),this.ball.swing())),"_HIT"!==this.currentState))return this.game.physics.arcade.distanceBetween(this.game.player,this)<=300&&"_ATTACK"!==this.currentState?("_ALERT"!==this.currentState?this.setState("_ALERT"):this.game.physics.arcade.moveToXY(this,this.game.player.x,this.game.player.y,this._MAXSPEED+this._ADDSPEED),void(this.game.physics.arcade.distanceBetween(this.game.player,this)<=120&&"_ATTACK"!==this.currentState&&Phaser.Utils.chanceRoll(5)&&"_ATTACK"!==this.currentState&&this.setState("_ATTACK"))):void this.game.physics.arcade.moveToXY(this,this.game.player.x,this.game.player.y,this._MAXSPEED+this._ADDSPEED)}},{key:"setState",value:function(e){var t=this;this.currentState=e,"_PATROL"===e?(this.body.velocity.set(this.game.rnd.integerInRange(-1,1)*this._MAXSPEED,this.game.rnd.integerInRange(-1,1)*this._MAXSPEED),this.animations.play("walk"),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(800,1200),function(){Phaser.Utils.chanceRoll(60)&&t.setBallState("_SWINGING"),t.setState("_PAUSED")})):"_ALERT"===e?(this.body.velocity.setTo(this._MAXSPEED+this._ADDSPEED),this.animations.play("walk"),this.game.time.events.remove(this.movementTimer)):"_ATTACK"===e?(this.setBallState("_SWINGING"),Phaser.Utils.chanceRoll(60)&&(this.body.velocity.setTo(0),this.animations.play("attack")),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1200,2200),function(){t.setBallState("_RESTING"),t.game.sfx.stop("sfx_ball"),t.ball.isSwinging=!1,t.setState("_PAUSED")})):"_PAUSED"===e&&(this.body.velocity.setTo(0),"_RESTING"===this.ball.currentState?(this.animations.stop(),this.frameName="ogre-mf/_01.png"):this.animations.play("attack"),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1200,2200),function(){t.setBallState("_RESTING"),t.game.sfx.stop("sfx_ball"),t.ball.isSwinging=!1,t.movementTimer=t.game.time.events.add(t.game.rnd.integerInRange(600,1e3),function(){t.setState("_PATROL")})}))}},{key:"setBallState",value:function(e){this.ball.currentState=e}}]),t}(s.Enemy)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rat=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(7);t.Rat=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return h._MAXSPEED=100,h._ADDSPEED=h.game.rnd.between(5,20),h._STRIKE_VELOCITY=200,h.body.setSize(20,20,0,0),h.health=h.game.rnd.integerInRange(1,3),h.animations.add("walk-forward",Phaser.Animation.generateFrameNames("rat-af/_0",1,4,".png"),5,!0),h.animations.add("walk-backward",Phaser.Animation.generateFrameNames("rat-ab/_0",1,4,".png"),5,!0),h.animations.add("walk-left",Phaser.Animation.generateFrameNames("rat-al/_0",1,4,".png"),5,!0),h.animations.add("walk-right",Phaser.Animation.generateFrameNames("rat-ar/_0",1,4,".png"),5,!0),h.animations.add("death",Phaser.Animation.generateFrameNames("rat-death/_0",1,3,".png"),6,!1),h.currentState="_PATROL",h.setPatrolState(),h}return i(t,e),r(t,[{key:"update",value:function(){if(!(this.health<=0)){if(this.game.player.isTalking||this.game.player.questsActive||this.game.player.inventoryActive)return void this.body.velocity.setTo(0);if(this.game.physics.arcade.distanceBetween(this.game.player,this)>320&&"_ALERT"===this.currentState)return void this.setPatrolState();if("_PATROL"===this.currentState){if(!(this.game.physics.arcade.distanceBetween(this.game.player,this)<=240))return;this.currentState="_ALERT",this.isPaused=!1}else if("_ALERT"===this.currentState)this.game.time.events.remove(this.movementTimer),this.body.velocity.setTo(this._MAXSPEED+this._ADDSPEED),this.game.physics.arcade.moveToXY(this,this.game.player.x,this.game.player.y,this._MAXSPEED+this._ADDSPEED),this.animations.play("walk-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)),this.isAlerted||(this.isAlerted=!0),this.body.touching.none||(this.currentState="_ATTACKING",this.body.velocity.setTo(0),this.attack());else if("_ATTACKING"!==this.currentState||this.isAttacking){if("_PAUSED"===this.currentState)this.body.velocity.setTo(0),this.animations.play("walk-"+this.faceDirection(this.game.player.x,this.game.player.y,!0)).stop();else if("_HIT"===this.currentState)return}else this.isAttacking||(this.isAttacking=!0)}}},{key:"setPatrolState",value:function(){var e=this;null!=this&&(this.currentState="_PATROL",this.isMoving=!0,this.body.velocity.set(this.game.rnd.integerInRange(-1,1)*this._MAXSPEED,this.game.rnd.integerInRange(-1,1)*this._MAXSPEED),this.animations.play("walk-"+this.calcMovementDirection()),this.movementTimer=this.game.time.events.add(this.game.rnd.integerInRange(1600,3e3),function(){e.isMoving=!1,e.setPauseState()}))}},{key:"attack",value:function(){var e=this;this.game.time.events.add(200,function(){e.game.physics.arcade.distanceBetween(e.game.player,e)<=60&&!e.game.player.isHit&&!e.isDead&&(e.playerHit(1),e.setAttackPauseState())})}}]),t}(s.Enemy)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Explosion=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return s.game=e,s.animations.add("explode",Phaser.Animation.generateFrameNames("explosion-01/_",1,16,".png"),16,!1),s.play(),s}return i(t,e),r(t,[{key:"play",value:function(){var e=this;this.game.sfx.play("sfx_fireballExplode",.75),this.animations.play("explode").onComplete.add(function(){e.kill()})}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InvisibleHand=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),h=a(12),c=a(19),u=a(36),d=(t.InvisibleHand=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bosses-atlas",s=arguments[4],h=arguments[5];n(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,h));return d.call(c),e.add.existing(c),c.game=e,e.physics.arcade.enable(c),c.body.immovable=!0,c.body.onCollide=new Phaser.Signal,c.data={name:"The Invisible Hand",dI:h},l.default.mixin(c),c.targetPos={x:c.game.player.x,y:c.game.player.y},c.cW=c.game.camera.width,c.cH=c.game.camera.height,c.anchor.setTo(.5,.7),c.body.setSize(200,220,20,0),c.currentState="_PAUSED",c.engageDistance=140,c.maxHealth=30,c.health=30,c.speed=240,c.isType="BOSS",c.combatActive=!1,c.direction=1,c.tweens={},c.explosionsGroup=c.game.add.group(),c.crushFlash=c.game.add.graphics(0,0),c.crushFlash.beginFill(16777215,.65),c.crushFlash.drawCircle(0,0,300),c.crushFlash.endFill(),c.crushFlash.alpha=0,c.game.world.addChildAt(c.crushFlash,4),c.animations.add("move",Phaser.Animation.generateFrameNames("hand/hand_0",2,4,".png"),5,!0),c.animations.add("flick",Phaser.Animation.generateFrameNames("hand/hand_0",5,6,".png"),5,!1),c.animations.add("prone",Phaser.Animation.generateFrameNames("hand/hand_0",0,1,".png"),1,!0),c.animations.add("crush",Phaser.Animation.generateFrameNames("hand/hand_0",7,7,".png"),1,!1),c.animations.add("shoot",Phaser.Animation.generateFrameNames("hand/hand_0",8,9,".png"),5,!0),c.animations.add("swat",Phaser.Animation.generateFrameNames("hand/hand_",10,12,".png"),8,!1),c.animations.add("full-shoot",Phaser.Animation.generateFrameNames("hand/hand_13.png"),1,!1),c.frameName="hand/_0.png",c}return i(t,e),r(t,[{key:"setSignal",value:function(){this.signal=new h.ProjectileSignal(this.game,this.x-10,this.y,this,this),this.addChild(this.signal)}},{key:"setTime",value:function(){return this.game.rnd.integerInRange(1400,2500)}},{key:"setPauseTime",value:function(){return this.game.rnd.integerInRange(500,1e3)}},{key:"setDelay",value:function(){return this.game.rnd.integerInRange(500,1e3)}},{key:"createFullShootPlasmaBall",value:function(e,t){var a=this.game.projectileGroup.getFirstExists(!1),n=e||this.game.player.x,o=t||this.game.player.y;e||this.game.rnd.integerInRange(300,600);a?(a.reset(this.x,this.y-80),a.animations.play("fire")):(a=new c.Toxicball(this.game,this.x,this.y-80,"sprites",null,420),this.game.projectileGroup.add(a)),a.origin=this,this.game.sfx.play("sfx_fireball"),this.game.physics.arcade.moveToXY(a,n,o,a.speed)}},{key:"playerHit",value:function(){var e=this;if(!this.game.player.isHit){this.game.player.damage(2),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.game.player.body.velocity.setTo(0,600),this.game.player.isTalking=!0,this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player);this.game.time.events.add(300,function(){e.game.player.body.velocity.setTo(0),e.game.player.isTalking=!1;e.game.time.events.add(1e3,function(){e.game.player.isHit=!1})})}}},{key:"hit",value:function(){this.emit("bossHit")}}]),t}(Phaser.Sprite),function(){var e=this;this.setState=function(t){e.currentState=t},this.update=function(){!0===e.game.player.isTalking||e.game.player.questsActive||e.game.player.inventoryActive||("_PAUSED"===e.currentState?e.body.velocity.set(0):"_MOVING"===e.currentState&&e.health>0&&(e.x<=140&&(e.direction=1),e.x>=820&&(e.direction=-1),e.body.velocity.set(e.speed*e.direction,0)))},this.startBattle=function(){e.game.world.moveUp(e.game.enemyGroup),e.game.world.moveUp(e.game.enemyGroup),e.tweens.handTween.stop(),e.game.enableEnemyObstacleCollide=!1,e.game.add.tween(e.position).to({y:250},700,null,!0).onComplete.add(function(){e.game.camera.follow(null),e.setState("_MOVING"),e.combatActive=!0,e.setSignal(),e.setMoveTimer(600),e.setAttackTimer(e.setDelay(),e.plasmaBall)})},this.setMoveTimer=function(t){console.log("MOVING"),t||(t=e.setTime()),e.direction=Phaser.Utils.randomChoice(1,-1),e.setState("_MOVING"),e.animations.play("move"),e.moveTimer=e.game.time.events.add(t,e.stop,e)},this.setAttackTimer=function(t,a){e.animations.play("move"),t||(t=e.setDelay()),a||(a=e.selectRandomAttack()),e.attackTimer=e.game.time.events.add(t,function(){e.setAttackSignal(a)},e)},this.setAttackSignal=function(t){e.signal.sig(t)},this.stop=function(){console.log("PAUSING"),e.body.velocity.set(0),e.animations.stop(),e.setState("_PAUSED"),e.movePauseTimer=e.game.time.events.add(e.setPauseTime(),e.setMoveTimer,e)},this.plasmaBall=function(t){var a=t||e;e.animations.play("shoot"),a.game.time.events.add(200,function(){e.health>0&&(a.createPlasmaBall(),e.resetAttackTimer(200))})},this.createPlasmaBall=function(){var t=e.game.projectileGroup.getFirstExists(!1);t?(t.speed=420,t.timerReset(),t.reset(e.x+24,e.y),t.body.setSize(16,16,0,0),t.animations.play("fire")):(t=new c.Toxicball(e.game,e.x+24,e.y,"sprites",null,420,null,!0,!1),e.game.projectileGroup.add(t)),t.origin=e,e.game.sfx.play("sfx_fireball"),e.game.physics.arcade.moveToXY(t,e.game.player.x,e.game.player.y,t.speed)},this.resetAttackTimer=function(t){e.game.time.events.add(t,function(){e.setAttackTimer()})},this.meleeStrike=function(t){e.game.physics.arcade.distanceBetween(e,e.game.player)<=t&&e.health>0&&e.playerHit()},this.swat=function(){e.setState("_PAUSED"),e.game.time.events.remove(e.moveTimer),e.tweens.outTween=e.game.add.tween(e.position).to({x:e.game.player.x-60,y:e.game.player.y-120},300,Phaser.Easing.Quadratic.In,!0),e.tweens.outTween.onComplete.add(function(){e.animations.play("swat");e.game.sfx.play("sfx_handSwat"),e.game.time.events.add(100,function(){e.meleeStrike(120)}),e.tweens.inTween=e.game.add.tween(e.position).to({y:250},600,Phaser.Linear,!0,600),e.tweens.inTween.onComplete.addOnce(function(){e.health>0&&(e.position.y=250,e.setMoveTimer(),e.resetAttackTimer(200))})})},this.playCrushFlash=function(){e.crushFlash.x=e.x,e.crushFlash.y=e.y,e.game.flash(e.crushFlash)},this.crush=function(){e.game.time.events.remove(e.moveTimer),e.tweens.outTween=e.game.add.tween(e.position).to({y:-220},500,Phaser.Linear,!0),e.tweens.outTween.onComplete.add(function(){e.game.time.events.add(e.game.rnd.integerInRange(600,1200),function(){e.animations.play("crush"),e.tweens.downTween=e.game.add.tween(e.position).to({x:e.game.rnd.integerInRange(-50,50)+e.game.player.x,y:e.game.rnd.integerInRange(-50,50)+e.game.player.y},320,Phaser.Linear,!0),e.game.sfx.play("sfx_handFall"),e.tweens.downTween.onComplete.addOnce(function(){e.playCrushFlash(),e.game.sfx.play("sfx_handCrush"),e.game.camera.shake(.0025,400),e.meleeStrike(70),e.tweens.outTween=e.game.add.tween(e.position).to({y:250},600,Phaser.Linear,!0,600),e.tweens.outTween.onComplete.add(function(){e.health>0&&(e.position.y=250,e.setMoveTimer(),e.resetAttackTimer(200))})})})})},this.flick=function(){e.setState("_PAUSED"),e.game.time.events.remove(e.moveTimer),e.tweens.outTween=e.game.add.tween(e.position).to({x:e.game.player.x-20,y:e.game.player.y-25},200,Phaser.Easing.Quadratic.In,!0),e.animations.play("flick"),e.tweens.outTween.onComplete.add(function(){e.meleeStrike(100),e.tweens.inTween=e.game.add.tween(e.position).to({y:250},600,Phaser.Linear,!0,700),e.game.sfx.play("sfx_handSwat"),e.tweens.inTween.onComplete.addOnce(function(){e.health>0&&(e.position.y=250,e.setMoveTimer(),e.resetAttackTimer(200))})})},this.full_shoot=function(t){var a=t||e;e.setState("_PAUSED"),e.game.time.events.remove(e.moveTimer),e.animations.play("full-shoot");for(var n=0;n<5;n++)a.createFullShootPlasmaBall(160*n,600);e.game.time.events.add(1200,function(){e.health>0&&(e.setMoveTimer(),e.resetAttackTimer(200))})},this.selectRandomAttack=function(){var t=e.game.rnd.integerInRange(0,3);if(e.game.physics.arcade.distanceBetween(e.game.player,e)<=120)switch(t){case 0:return e.flick;case 1:return e.swat;case 2:return e.flick;case 3:return e.swat}else switch(t){case 0:case 1:case 2:case 3:return e.crush}},this.explosion=function(){var t=e.explosionsGroup.getFirstExists(!1),a=e.game.rnd.integerInRange(e.x-e.width/2,e.x+e.width/2-45),n=e.game.rnd.integerInRange(e.y-e.height/1.25,e.y);t?(t.reset(),t.x=a,t.y=n,t.play()):(t=new u.Explosion(e.game,a,n,"sprites"),e.explosionsGroup.add(t))},this.death=function(){e.animations.play("prone"),e.game.sfx.play("sfx_handDeath"),void 0!==e.tweens.inTween&&e.tweens.inTween.stop(),void 0!==e.tweens.outTween&&e.tweens.outTween.stop(),void 0!==e.tweens.downTween&&e.tweens.downTween.stop(),e.game.time.events.stop(e.moveTimer),e.game.time.events.stop(e.attackTimer),e.game.player.isTalking=!0,e.game.player.body.velocity.set(0),e.game.actions.walkTo(e.game.player,{x:e.game.world.width/2,y:e.game.camera.height/2+160},500,0,function(){e.game.player.frameName="hero-mab/_01.png",e.game.time.events.remove(e.moveTimer),e.game.time.events.remove(e.attackTimer),e.game.time.events.start(),e.explosionTimer=e.game.time.events.loop(Phaser.Timer.SECOND/10,e.explosion,e)})}})},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.HealthIcon=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4];n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.game=e,l.game.add.existing(l),l.anchor.setTo(.5),l.fixedToCamera=!0,l.frameName="ui-hearts-"+s+".png",l}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.HealthPanel=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(38);t.HealthPanel=function(){function e(t,a){n(this,e),this.iconGroup=null,this.context=a,this.game=t,this.xStartPos=75,this.yPos=28,this.iconArray=[],this.iconGroup=this.context.add.group(),this.initHealthIconDraw(this.game.player.maxHealth)}return o(e,[{key:"initHealthIconDraw",value:function(e){console.log("PLAYER HEALTH IS",this.game.player.maxHealth);for(var t=e/2,a=0;a<t;a++){var n=new i.HealthIcon(this.game,42*a+this.xStartPos,this.yPos,"sprites","full");this.iconGroup.add(n),this.iconArray.push(n)}this.drawHealthIcons(this.game.player.health)}},{key:"redrawIcons",value:function(){this.iconGroup.forEach(function(e){return e.destroy()}),this.iconArray=[],this.initHealthIconDraw(this.game.player.maxHealth)}},{key:"drawHealthIcons",value:function(e){var t=this,a=[],n=!1,o=this.game.player.maxHealth-e,i=e;this.game.hasOwnProperty("sfx")&&(e<=2?this.game.sfx.play("sfx_healthLow"):e>=2&&this.game.sfx.stop("sfx_healthLow")),this.divisibleByTwo(i)||(i++,o--,n=!0,console.log("active health now "+i),console.log("inactive health now "+o)),i/=2,o/=2;for(var r=1;r<=i;r++)console.log("Now active is "+i),n&&r===i?a.push("half"):a.push("full");for(var s=0;s<o;s++)a.push("empty");a.forEach(function(e,a){console.log(e),t.iconArray[a].frameName="ui-hearts-"+e+".png"})}},{key:"divisibleByTwo",value:function(e){return e%2==0}},{key:"playerHit",value:function(e){this.drawHealthIcons(e)}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InventoryButton=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(41),l=a(0),h=function(e){return e&&e.__esModule?e:{default:e}}(l);t.InventoryButton=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.inventoryTween=null,l.selectedItem=null,l.game=e,e.add.existing(l),l.anchor.setTo(.5),l.inputEnabled=!0,l.input.useHandCursor=!0,l.fixedToCamera=!0,l.data.open=!1,l.frameName="ui-inventory-open.png",l.inventoryDialogue=new s.InventoryDialogue(l.game),h.default.mixin(l),l.inventoryTween=l.game.add.tween(l.inventoryDialogue.inventoryWindow.scale),l.events.onInputDown.add(l.initInventory,l),l}return i(t,e),r(t,[{key:"initInventory",value:function(e){this.inventoryTween.isRunning||this.game.player.isTalking||(this.data.open?(this.data.open=!1,this.frameName="ui-inventory-open.png",this.dismissInventoryDialogue(e)):(this.data.open=!0,this.frameName="ui-inventory-close.png",this.callInventoryDialogue()))}},{key:"callInventoryDialogue",value:function(){var e=this;this.game.player.questsActive&&this.game.questsButton.initQuests(!0),this.inventoryTween=this.game.add.tween(this.inventoryDialogue.inventoryWindow.scale).to({x:1,y:1},200,"Quad.easeOut").start(),this.game.sfx.play("sfx_menuUp"),this.emit("inventoryEngaged"),this.game.player.inventoryActive=!0,this.keyLeft=this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.keyLeft.onDown.add(this.inventoryDialogue.moveSelectionLeft,this),this.keyRight=this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.keyRight.onDown.add(this.inventoryDialogue.moveSelectionRight,this),this.inventoryTween.onComplete.add(function(){e.inventoryDialogue.displayInventoryItems(),e.inventoryDialogue.toggleInventoryText()})}},{key:"dismissInventoryDialogue",value:function(e){var t=this;this.game.inventoryGroup.forEach(function(e){return e.kill()}),this.inventoryDialogue.dismissSelectionIcon(),this.inventoryDialogue.toggleInventoryText(),this.keyLeft.onDown.remove(this.inventoryDialogue.moveSelectionLeft,this),this.keyRight.onDown.remove(this.inventoryDialogue.moveSelectionRight,this),this.emit("inventoryClosed"),e?(this.inventoryDialogue.inventoryWindow.scale.setTo(0),this.game.player.inventoryActive=!1):(this.inventoryTween=this.game.add.tween(this.inventoryDialogue.inventoryWindow.scale).to({x:0,y:0},200,"Quad.easeOut").start(),this.inventoryTween.onComplete.add(function(){t.game.player.inventoryActive=!1,t.game.player.isTalking=!1,t.emit("inventoryClosed")}))}},{key:"select",value:function(){console.log("SELECT BUTTON PRESSED")}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.InventoryDialogue=void 0;var o=a(42);t.InventoryDialogue=function e(t){var a=this;n(this,e),this.xPos=50,this.yPos=140,this.xSpacing=175,this.currentSelection=null,this.displayInventoryItems=function(){a.game.player.data.inventory.forEach(function(e,t){var n=a.game.inventoryGroup.getFirstExists(!1);if(n){n.reset(),n.data=e,n.frameName="inv-"+e.id+".png",n.alpha=0;var i=0===n.i?1:.65;a.game.add.tween(n).to({alpha:i},140,"Quad.easeOut").start()}else n=new o.InventoryItem(a.game,t*a.xSpacing+a.xPos,a.yPos,"sprites",e.id,e,t),a.game.inventoryGroup.add(n),n.events.onInputDown.add(a.setSelectIcon,a)}),a.game.inventoryGroup.children.length>0&&(a.selectIcon.visible=!0,a.selectIcon.bringToTop())},this.toggleInventoryText=function(){a.inventoryText.visible=!a.inventoryText.visible,0===a.game.player.data.inventory.length?(a.setText("","You are not carrying any items"),a.inventoryText.cameraOffset.setTo(a.game.camera.width/2-185,a.game.camera.height/2-120)):(a.setText(a.game.inventoryGroup.children[0].data.name,a.game.inventoryGroup.children[0].data.desc),a.inventoryText.cameraOffset.setTo(a.xPos,a.game.camera.height-a.game.camera.height/2.5))},this.setSelectIcon=function(e){a.game.inventoryGroup.forEach(function(e){return e.alpha=.65}),a.selectIcon.cameraOffset.setTo(e.x-10,a.yPos-10),a.selectIcon.currentPosition=e.i,a.game.inventoryGroup.children[a.selectIcon.currentPosition].alpha=1,a.currentSelection=e.data,a.setText(e.data.name,e.data.desc)},this.setText=function(e,t){a.inventoryText.text=e.toUpperCase()+"\n"+t},this.moveSelectionLeft=function(e){a.selectIcon.currentPosition>0&&(a.selectIcon.currentPosition--,a.selectIcon.cameraOffset.setTo(a.xPos-10+a.selectIcon.currentPosition*a.xSpacing,a.yPos-10),a.highlightSelected(),a.moveSound())},this.moveSelectionRight=function(e){a.selectIcon.currentPosition<a.game.inventoryGroup.children.length-1&&(a.selectIcon.currentPosition++,a.selectIcon.cameraOffset.setTo(a.xPos-10+a.selectIcon.currentPosition*a.xSpacing,a.yPos-10),a.highlightSelected(),a.moveSound())},this.moveSound=function(){a.game.sfx.play("sfx_menuMove")},this.highlightSelected=function(){a.game.inventoryGroup.forEach(function(e){return e.alpha=.65}),a.game.inventoryGroup.children[a.selectIcon.currentPosition].alpha=1,a.currentSelection=a.game.inventoryGroup.children[a.selectIcon.currentPosition].data,a.setText(a.currentSelection.name,a.currentSelection.desc)},this.dismissSelectionIcon=function(){a.selectIcon.visible=!1,a.selectIcon.cameraOffset.setTo(a.xPos-10,a.yPos-10),a.selectIcon.currentPosition=0},this.game=t,this.winW=this.game.camera.width-42,this.winH=this.game.camera.height-160,this.inventoryWindow=this.game.add.graphics(this.game.camera.width/2+21,this.game.camera.height/2+30),this.inventoryWindow.lineStyle(2,16777215,1),this.inventoryWindow.beginFill("#000",.75),this.inventoryWindow.drawRoundedRect(-this.game.camera.width/2,-this.winH/2,this.winW,this.winH,15),this.inventoryWindow.fixedToCamera=!0,this.inventoryWindow.anchor.setTo(.5),this.inventoryWindow.scale.setTo(0),this.game.inventoryGroup=this.game.add.group(),this.selectIcon=new Phaser.Sprite(this.game,this.xPos-10,this.yPos-10,"sprites","ui-inventory-select.png"),this.selectIcon.visible=!1,this.selectIcon.currentPosition=0,this.selectIcon.fixedToCamera=!0,this.game.add.existing(this.selectIcon),this.inventoryText=this.game.add.bitmapText(this.xPos,this.game.camera.height-this.game.camera.height/2.5,"VT323","",32),this.inventoryText.maxWidth=this.game.camera.width-80,this.inventoryText.fixedToCamera=!0,this.inventoryText.visible=!1}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.InventoryItem=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5],h=arguments[6];n(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));c.game=e,e.add.existing(c),c.data=l,c.i=h,c.inputEnabled=!0,c.fixedToCamera=!0,c.input.useHandCursor=!0,c.frameName="inv-"+s+".png",c.alpha=0;var u=0===h?1:.65;return c.itemTween=c.game.add.tween(c).to({alpha:u},120,"Quad.easeOut").start(),c}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={"kq02-test-01":["kq02-test-02","kq02-test-03"],"kq02-test-02":["kq02-test-01","kq02-test-06"],"kq02-test-03":["kq02-test-07","kq02-test-05"],"kq02-test-06":["kq02-test-05"],"kq02-test-05":["kq02-test-06"],"kq02-test-07":["kq02-test-01","kq02-test-04"]};t.default=n},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.MusicHandler=function(){function e(t){n(this,e),this.musicSprite=null,this.game=t,this.vol=0,this.prevMusic="",this.currMusic="",this.setMusic(this.game.currentStage)}return o(e,[{key:"setMusic",value:function(e){console.log("setMusic stage is",e),null!==this.musicSprite&&this.stop(),this.prevMusic=this.currMusic,this.currMusic="kq02-calgary-00"===e||"kq02-calgary-01"===e?"camp":"kq02-calgary-02"===e||"kq02-badlands-00"===e||"kq02-badlands-01"===e||"kq02-mountains-00"===e||"kq02-mountains-01"===e||"kq02-forest-00"===e||"kq02-caves-00"===e||"kq02-battle-01"===e?"theme-dungeon":"kq02-pantheon-00"==e?"theme-pantheon":"kq02-palace-00"===e?"theme-ndp":"kq02-airship-00"===e||"kq02-caves-01"===e?"theme-fildebrandt":"kq02-edmonton-00"===e||"kq02-edmonton-01"===e?this.game.globalAchievements.finalStage?"theme-dungeon":"theme-edmonton":"camp",null!==this.musicSprite&&this.musicSprite.play(this.currMusic)}},{key:"setVolume",value:function(e){this.musicSprite.sounds[this.currMusic].volume=e}},{key:"play",value:function(e){void 0!==e?(this.musicSprite.play(e),this.currMusic=e):this.setMusic(this.game.currentStage)}},{key:"stop",value:function(){this.musicSprite.stop()}},{key:"pause",value:function(){this.musicSprite.sounds[this.currMusic].pause()}},{key:"resume",value:function(){this.musicSprite.sounds[this.currMusic].resume()}}]),e}()},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.NpcDialogue=function e(t){var a=this;n(this,e),this.game=t,this.f=this.game.npcFunctions,this.data={"Jason Kenney":[[["Queen Notley, austerity, deficits and arrogance were the symptoms of a divided conservatism, left sick and weak from years of mismanagement.","You ably profited from the rot of that era, but I will say it now from atop this mountain for the whole of Alberta to hear:"],0,1,1,function(){return a.f.intro_kenneyHoldsUpSword()}],[["The Right is once again...","...UNITED!"],0,1,1,function(){return a.f.intro_endScene()}],[["Gentlemen, the Notley government's militating to find the crystals before us puts the pressure on. We can't afford to be dilatory.","We MUST find those crystals. Now more than ever."],0,1,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Chief of Staff"),!0)}],[["But as our party convention in May showed, we have a particular challenge with members of our coalition staying on message.","I want to hold THIS plan - my principal plan - close to my chest and oversee all parts of it."],0,1,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Chief of Staff"),!0)}],[["That's right. Unity first and above all. Period. Paragraph.","*Chortle* The 'media' know nothing of the political arts.","If our plan leaked to the press their *spin* would only get in the way."],0,1,5,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["That's right. Unity first and above all. Period. Paragraph.","*Chortle* The 'media' know nothing of the higher political arts.","If our plan leaked to the press their *spin* would only get in the way."],0,1,6,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["That's right. Unity first and above all. Period. Paragraph.","*Chortle* The 'media' know nothing of the higher political arts.","If our plan leaked to the press their *spin* would only get in the way."],0,1,5,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["Fear not, friends. It is I. Jason Kenney! Newly returned from having communed amongst the Tory gods."],0,0,8,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Chief of Staff"),!0)}],[["*whimper* No..."],0,0,8,function(){return a.f.greatTree_removeTree(11)}],[["Today the premiers of the provinces who opposed Emperor Trudeau's carbon enchantment stand proudly before you to say the awful Carbon Tree has fallen by our hands.","Canada remains open for business, with Alberta as the proud champion of Canadians' right to conduct business free of government intervention."],0,0,10,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("CBC Reporter"),!1)}],[["Fellow conservatives! The day we have long awaited is upon us.","The gods show us their favour and we are called to kneel before Lady Destiny!","Soon we will ride upon Queen Elizabeth II highway to engage the NDP foe. At stake is the freedom of the market and all conservatism.","Now, who is with me? Fiscal, social, constitutional conservatives?"],0,0,11,function(){var e={data:{name:"All",character:"All",dI:3}};a.game.dialogue.initDialogue(null,e,!1,!0)}],[["Behold, the enemy!. Once more unto the breach, united soldiers of conservatism!"],0,0,12,function(){a.f.battleSequence_scene2()}]],"Rachel Notley":[[["Mr. Kenney.","Queen Notley. When I received your request for a secret meeting, I knew at once to find you on the peak of Mount Columbia.","Both of us have our eye set on the highest, greatest destiny Alberta can offer.","Know this, Notley: nothing you say will dissuade me from my holy quest! The future of Alberta depends on my success, not on your kowtowing to know-nothing Emperor Trudeau.","*Tsk tsk*, Kenney. By now, I've led successful negotiations with all our great province's stakeholders:"],1,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.notley,!0)}],[["the energy industry, environmental groups, Indigenous groups, unions EVEN the federal government. You should be fearful of the NDP's success. Indeed, talk is mightier than the sword.","It is of no consequence! Albertans don't want you as their leader. Only through the SWORD can we restore the Alberta Advantage!","Fool! Alberta has changed and only through negotiation will we and all CANADA prosper.","Enough of your kumbaya-talk. Why did you wish to see me?","The Crystals of ConfedeIuration...","I...I don't know what you're talking about.","Come now. Tales of their power are not limited to Conservative lore. In fact, it's Conservative arrogance that blinds them to the Crystals' true history as the original, animating spirit of the West.","Even if what you say is true, the shards of the one Crystal were long ago scattered across the province, lost to time. No premier has ever hoped to draw on their full power.","Perhaps, but the time of the Prophecy draws nigh, and just as you were drawn in your quest back to Alberta, so was I. Lasting change will come to this land through the actions of one leader, so sayeth the Scriptures of Rutherford."],1,0,2,function(){return a.f.intro_notleyMountsDragon()}],[["We are fated to duel for this honour, you and I, Kenney. And uniting the Crystals is central to our shared destiny.","I don't believe you.","No? Then gaze upon this!"],1,0,3,function(){return a.f.intro_notleyRevealsCrystal()}],[["It can't be!"],0,1,4,function(){return a.game.dialogue.initDialogue(null,a.game.notley,!0)}],[["It is! One of the shardsand it is mine! In it holds the power of Compassion and Social License. And the NDP and its growing army of adherents are close to unearthing more.","The game is on, Kenney! Will the future of Alberta be one of climate change accountability, of prosperity through negotiation, of social justice?","Or will it return to one of austerity, high deficits and arrogance? Abandon your quest now and Alberta will truly prosper.","Onward, Prolepterya!"],0,0,4,function(){return a.f.intro_notleyFliesAway()}],[["Comrades of the Alberta New Democratic Party. I have good news!","Today we have taken the first step in taming the chaos that has long plagued Alberta...","...by sowing the seeds for greater oil and gas investment that will bring with it jobs and, just as importantly...","...environmental and social justice! Increased access to healthcare for all Albertans!","Updated education initiatives! A deficit revised downward (much to our critics' dissatisfaction)!","Under our government - the most diverse and talented Alberta has ever seen - we have led an recovery that will last generations.","And a TRANSFORMATION that will last ... millennia! Ha ha ha ha!","I have asked comrade Ceci to provide an update on the work of the secret Find-the-Lost-Crystals-of-Confederation taskforce."],0,0,6,function(){a.f.ndp_palace_ceciSpeaks()}],[["Hey there, guys."],0,0,7],[["Albertans! Your queen is of one of you!","SOME leaders would insist the only pipelines that matter are on the ground!","But Albertans! The pipeline MY govern4ment is building is both on the ground...","...and in your hearts! From yours to mine!","Now let's party like it's 2015!"],0,0,10,function(){a.f.edmonton_ndp_cutscene_end()}],[["Sir Kenney! You've arrived.","The NDP has shown that it is no match for a united conservative party, Queen Notley. Concede defeat!","The battle's not yet won. Alberta NDP forces still carry on the fight in ridings beyond Edmonton and our support remains strong here."],1,0,17,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Rachel Notley"),!1)}],[["Comrades! The war rages 'round us, and we have now been dealt a serious blow.","The Supreme Council of Justice's decision against construction of our great pipeline means Alberta's most valuable commodity will continue to be subject to the whims of the U.S. Celestial Imperator.","This is a threat to Canadian sovereignty and Canadian economic security. Today, Alberta needs action. Investors globally are terrified of the precedent this decision sets.","I call on Emperor Trudeau to appeal the Supreme Council of Justice's decision.","In the meantime, I am withdrawing my government's support of any further climate change enchantments introduced by his government until he takes action.","And now, Finance Minister Joe Ceci has an update on our government's secret search-for-the-lost-crystals taskforce."],0,0,9,function(){a.f.ndp_palace_ceciSpeaks(8)}],[["Heeeeey, macarena!"],0,0,11,function(){a.f.edmonton_trudeauNotleyCutscene_trudeauAppears()}],[["Emperor Trudeau?!","No! Get off of the stage. You've rained on Alberta's parade enough already, not to mention me."],0,0,12,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1,null,!0)}],[["No 'buts'!","Go on. Git!"],0,0,12,function(){a.f.edmonton_trudeauNotleyCutscene_trudeauExits()}],[["The UCP has claimed one of our rightful crystals, but it is no matter. We have others.","Our power lies in the compassion and our adherents' resolve. Edmonton will not soon be taken."],0,1,14,function(){var e=a.game.actions.getCharacter("Sandra Jansen");e.data.dI=2,a.game.actions.walkTo(e,{x:420,y:410},800,500,function(){a.game.dialogue.initDialogue(null,e,!1,!0)})}],[["Onward! To the Queen Elizabeth II highway, where the din of battle awaits."],0,0,15,function(){a.game.actions.walkTo(a.game.player,{x:230,y:440},700,null,function(){a.game.actions.walkTo(a.game.player,{x:-16,y:600},900,null,function(){a.f.marchToWar_scene4_end()})})}],[["Ride, Prolepterya! Kenney is visible on the horizon. We shall meet the foe face-to-face, steel at the ready!"],0,0,16,function(){a.f.battleSequence_scene1()}],[[""],0,0,17],[["Though you've infiltrated the city, I still hold captive the Invisible Hand with the crystals my party has recovered. Now witness the end of your false god!","Not so fast! My new sword has been forged from the crystals the UCP has recovered. I can hold off the power of your crystals. We are nearly equally matched!","As the Prophecy claims, now is the time we see which of us truly wields Alberta's power!","NO!"],1,0,18,function(){a.f.finalBoss_lungeForCrystal()}],[["The power of our crystals! They're nearly equally matched.","You won't be imposing your socialist agenda on hardworking Albertans today, Queen Notley!","And YOU will be explaining to Albertans why conservative faith in the free market has once again brought them economic suffering. For your god is free and It is angry!"],1,0,19,function(){return a.f.finalBoss_notleyRuns()}]],"Joe Ceci":[[["Hi-ho, comrades! As Finance Minister, I've been overseeing our government's secret efforts to reclaim the lost Crystals of Confederation.","Queen Notley has made strengthening Alberta's economy central to her platform, and recovering the crystals will ensure that our government delivers on its promise to bring jobs and investment to our province.","Currently, we hold the Crystal of Social License and Empathy. Naturally, as the NDP, we knew exactly where to find it.","With its power, we've already captured the UCP's deity, the Invisible Hand of the Market. Our plan is to amass more crystals, thereby neutralizing this false god, and bring greater diversity to our economy.","Finally, because our government believes in fun, we'll be opening bars across Alberta a half hour earlier for every crystal returned to our possession.","Our policy will ensure Albertans continue to enjoy themselves, while we support our small brewers and remake Alberta.","Solidarity forever!"],0,0,1,function(){a.f.ndp_palace01_moveTrolls(),a.game.actions.walkTo(a.game.actions.getCharacter("Joe Ceci"),{x:327,y:464},1200,0,null,!0)}],[["Solidarity, my queen!"],0,0,1],[["What, ho!"],0,0,0,function(){a.f.edmonton_clearPalaceGate()}],[["Hidy-hi, stranger! Apologies, but the public is asked to remain outside. Thank you!"],0,0,3],[["Oh, I'm right behind you, Deron."],0,0,4,function(){a.f.edmonton_clearPalaceGate()}],[["Greetings, comrades.","Greetings, citizen.","I've just heard there is a large foodtruck fire by the legislature grounds. It's a green onion cake free-for-all!","What? Oh my..."],1,1,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Joe Ceci"),!1,null,!0)}],[["Deron..."],0,0,6,function(){var e=a.game.actions.getCharacter("Deron Bilous");e.data.dI=7,a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["My queen! We're intercepting an increasing number of messenger birds sent between UCP officials. They are marshalling their armies!","And so it begins: the final battle.","Goodness! I'd better get someone to take care of my cats..."],1,0,8,function(){a.game.player.isTalking=!0,a.game.player.data.dI=13,a.game.dialogue.initDialogue(null,a.game.player,!1,!0);var e=a.game.actions.getCharacter("Joe Ceci");a.game.actions.walkTo(e,{x:220,y:430},600,200,function(){a.game.actions.walkTo(e,{x:-36,y:600},900,0,function(){e.kill()})})}],[["Howdy, fellow comrades! Everyone's looking in fine form this afternoon.","Our government continues to track down the lost Crystals of Confederation in advance as the Prophecy further reveals itself.","Our work has resulted in further gains for the NDP's influence across the province, in spite of difficult headwinds.","As a sidenote, this afternoon our government will celebrate the contributions of all people across Alberta in a pageant of singing and dancing unlike anything this province has seen before.","Additional security around this facility is required as many in our government will be engaged in the celebrations. With the UCP foe lurking, we must protect our gains! Thank you."],0,0,9,function(){a.game.player.isTalking=!0,a.game.actions.walkTo(a.game.actions.getCharacter("Joe Ceci"),{x:327,y:464},1200,0,null,!0);var e=a.game.actions.getCharacter("Sandra Jansen");e.data.dI=4,a.game.actions.walkTo(e,{x:a.game.player.x-42,y:a.game.player.y},800,200,function(){a.game.dialogue.initDialogue("left",e,!1)})}],[["Everyones having fun and all with cannabis now legal, but I dont it being a profit centre for the government of Alberta for another couple of years."],0,0,9],[["Alberta beer is really, really good. I mean, REALLY!"],0,0,11],[["It's like we fixed the sand castle after the previous conservative government made a mess of it.","And now the new conservative party wants to kick it all back down again.","Do they ever build anything for anyone but their energy industry insiders?"],0,0,9]],"Chief of Staff":[[["Sir! might I suggest forming a secret committee of volunteers and deploying them throughout the province in search of the crystals?","That was originally my thought, general."],1,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.player,!0)}],[["You are a master strategist, sir!","What is it I've stressed repeatedly at our closed-door meetings?","Grassroots on the outside, top-down on the inside, sir!"],1,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.player,!0)}],[["Of taxation!"],0,0,3,function(){var e={data:{character:"All",name:"All",dI:1}};a.game.dialogue.initDialogue(null,e,!0)}],[["Go Leafs! Uh ... Flames!"],0,0,3],[["Sir Kenney?"],0,0,5,function(){a.game.player.data.dI=7,a.game.dialogue.initDialogue(null,a.game.player,!0)}],[["All Conservatism smiles on you, my liege. Hail this day!"],1,0,6,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["We will await further orders from Calgary, sir!"],0,0,6]],"Stephen Harper":[[["If I may offer guidance, Jason?","Of course, master Harper."],1,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["Master Manning and I, in our consultations with the oracles, have devined a summons from the Beyond.","It appears the Tory ancients are pointing to a sacred place to the west deep in Kananaskis Country where you ought to begin your search."],0,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Preston Manning"),!0)}],[["Through your Wisdom, you guide the fortunes of business and industry!"],0,0,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Preston Manning"),!0)}],[["It has been many months since I've been away, sojourning amongst the party faithful.","I am pleased that I can once again offer you my help, Jason.","Forever, will I be lurking."],0,0,3],[["So that's when Viktor Orban says, 'Yes, that IS my foot!"],0,0,5,function(){var e={data:{character:"All",name:"All",dI:2}};a.game.dialogue.initDialogue(null,e,!1)}],[["Then our reading of the ancients' signals was correct. How will they aid you in your search for the crystals, Jason?","Through me they will channel their wisdom, Master Harper. They will guide me in my quest.","Excellent! Go now, then. There is no time to waste. Glory to the Invisible Hand!"],0,0,6],[["Glory to the Invisible Hand!"],0,0,6],[["Jason! You have done well. Your deeds have earned you a vaunted position amongst the Tory gods.","I seek only to build a firmament on which to grow the Conservative order, Master Harper.","You shall continue to have that chance in Edmonton. Bring in the volunteers."],1,0,8,function(){a.f.enter_companions()}],[["Top UCP officials Leela Aheer and Jason Nixon have offered to accompany you into Edmonton.","They have been briefed on the risks. You will both need to find safe and secret passage into the NDP's stronghold then disguise yourselves as one of the city's elite, urban and liberal citizens.","Choose your companion, Jason:",[["Leela Aheer",9],["Jason Nixon",10]]],0,0,8],[["I choose Leela Aheer. She is one of my most valuable caucus members."],0,1,8,function(){a.f.choose_companion("Leela Aheer");var e=a.game.actions.getCharacter("Leela Aheer");e.data.dI=3,a.game.dialogue.initDialogue(null,e,!1)}],[["I choose Jason Nixon. His standing amongst the pragmatic, hard-working people of Alberta will ensure good fortune on my quest."],0,1,9,function(){a.f.choose_companion("Jason Nixon");var e=a.game.actions.getCharacter("Jason Nixon");e.data.dI=5,a.game.dialogue.initDialogue(null,e,!1)}],[["Very good. Now go and find a way into Edmonton. Glory to the Hand."],0,0,13,function(){var e=a.game.actions.getCharacter("Leela Aheer"),t=a.game.actions.getCharacter("Jason Nixon");e.data.dI=6,t.data.dI=6,a.game.player.addQuest("kq-q-edmontonjourney")}],[["We return with a new crystal! More of Alberta's ethereal essence is under our control. Now is the time to strike Edmonton!","Well done! The Tory gods are truly great! With their blessings, let us marshall the armies of conservatism!"],1,1,13,function(){a.f.marchToWar_start()}],[["Glory to the Hand."],0,0,13]],"Preston Manning":[[["Like government waste, it is a place only a conservative's eyes can see and mind can grasp.","If that is the desire of the ancients, so must I go. But first, a prayer to the Invisible Hand."],1,0,1,function(){var e={data:{character:"All",name:"All",dI:0}};a.game.dialogue.initDialogue(null,e,!1),a.game.player.animations.play("celebrate"),a.game.actions.animateNPCs("celebrate","NPCGroup")}],[["Through conservatives, you defend against the tyranny of government intrusion!","Of regulation!"],1,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Chief of Staff"),!0)}],[["Jason, Alberta needs a hero. I am honoured that you requested my council.","Master Manning, Albertans respect your leadership. Your involvement has rallied many to our cause."],1,0,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Preston Manning"),!0)}],[["Aye. But our coalition - blessed as it is by the might and grace of the Invisible Hand - has weaknesses.","It is knit together from fiscal, social, constitutional and democratic conservatives, to name but a few. Unity cannot be taken for granted.","We must be careful not to lay bare its weaknesses for our foes to exploit. Proceed sagely, Jason."],0,0,4],[["Proceed sagely, Jason."],0,0,4],[["Conservatives of Alberta. Assemblllllllllle!"],0,0,6,function(){a.f.marchToWar_scene0_end()}]],All:[[["All Hail the Invisible Hand!","You are the One True Market Force that binds Free-Enterprise Albertans!"],0,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!0)}],[["THE HAND!"],0,0,2,function(){a.game.player.stop(),a.game.actions.animateNPCs("walk-forward","NPCGroup",null,!0),a.game.player.addQuest("kq-q-kananaskis",!0)}],[["Ba ha ha ha ha!","?!"],0,0,2,function(){a.f.pantheon_return_enter_kenney()}],[["Aye!","Home schoolers? Coal rollers?","Aye! Aye!","Then for the glory and freedom of the Hand let us ride into glorious combat!"],1,0,4,function(){a.f.marchToWar_scene5_mountCar()}]],"UPC Soldier":[[["We give our lives to you, fearless leader Kenney!"],0,0,1],[["My liege!"],0,0,2],[["Conservatism is our Sun, Moon and Stars."],0,0,3],[["Semper fi, Kenney!"],0,0,4],[["For the Industry!"],0,0,5],[["So sayeth the Hand!"],0,0,0]],"Jason Nixon":[[["Jason! You are a giant among MLAs. A true force of conservatism and an asset to the Hand.","Thank you, my liege. I pledge you my steel in our battle with the NDP."],1,1,4,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jason Nixon"),!1)}],[["Ooh! Ooh! Pick me!"],1,0,1],[["I will serve you when the battle comes, my liege!"],0,0,2],[["Have some vitamin steak to cure what ails you, sir."],0,0,3,function(){}],[["In the meantime, I offer you my barbecuing skills as an aid in your quest. Come to my bbq to cure what ails you, sir.","It's a lot better a method of healthcare than relying on that slip of paper we call our health cards."],0,0,3],[["I may be the size of an ox, but in me I possess the cunning of a jackal, Sir, Kenney, Sir!"],0,0,5,function(){var e=a.game.actions.getCharacter("Stephen Harper");e.data.dI=11,a.game.dialogue.initDialogue(null,e,!1)}],[["May our side be victorious, Sir Kenney!"],0,0,6],[["Let us don our disguises. For Edmonton is a dangerous place and it's imperative we conservatives blend in."],0,1,7,function(){a.f.edmonton_initDisguises()}],[["The workers must seize the means of reproduction!","Did I say that right?"],0,0,8],[["Jason! I sense a pull from the jersey.","It's probably trying to self-destruct, just as the Oilers always do.","Nay! Come, let's dig up the ground here."],1,1,10,function(){a.f.edmonton_crystal_uncovery()}],[["Well, we've got the crystal. Let's go!"],0,1,10,function(){a.f.edmonton_crystal_escape()}],[["Hey"],0,0,11],[["I admit I have no clue what to do with this thing.","Is social license even a thing?","Never mind. It obviously has some form of power alien to conservatives. Let us make haste back to Calgary, and commence with our siege!"],1,1,12,function(){return a.f.edmonton_crystal_escape()}],[["Sir, we ought to go.","But I hear whisperings of a wise woman named Paula Simons over at ye Journale of Edmonton who possesses great knowledge of the city.","Let us seek her out."],0,0,14,function(){a.f.edmonton_setPaulaQuestNode()}],[["Let us seek out the wise woman Paula Simons."],0,0,14],[["If you had a moustache, now would be the perfect time to twirl it, sir."],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Look at Queen Notley up there. Promising fun to her base. Fun doesn't build pipelines!","Not to tidewater. No, sir.","I'll show Albertans fun. I'll hold the biggest pancake breakfast ever! Pancakes are fun, right?","Deliriously fun, sir."],1,1,17],[["We must find a way to steal one of the NDP's crystals or uncover a new one.","Now where to start...?"],0,0,17],[["Hark! I feel the jersey's power, Jason. It compels us to seek out the Legislature building to the west.","Onwards, sir!"],1,1,19],[["To the Legislature!"],0,0,19],[["By the Hand! The Crystal of Edmonton is ours, and with it, the hearts of the people of this great city.","Which you don't say to argue against the inherent superiority of Calgary, do you, sir?","Uh, no. No, of course not. Now, let us return there at once!"],1,1,20,function(){a.f.edmonton_crystal_escape()}],[["Is that...Queen Notley's dragon?!"],0,0,0,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}]],Voice:[[["JASON KENNEY! HERO TO ALBERTA!","YOU ARE...","..EXPECTED."],0,0,0]],"Margaret Thatcher":[[["Welcome and Blessings, Jason. You are in the Pantheon of Conservative Heroes.","It is the rarest of honours that a Conservative, still mortal, be granted permission to enter here.","But the Ethereal Council of Tories, in its wisdom, has bestowed you access for the situation is dire."],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ralph Klein"),!0)}],[["Master deities Margaret Thatcher and Ralph Klein! I am humbled and unworthy.","Most men are, dear Kenney. Most men are.","Is Notley's possession of one of the crystals truly that perilous?","Indeed. For with that one crystal she and the NDP have already taken the most egregious step an Albertan government could ever dare take.","What could that be?!"],1,1,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ralph Klein"),!0)}],[["Using the crystals, Notley plans to extinguish the Invisible Hand entirely, ensuring government control over all aspects of the economy for all time to come.","No... No! It can't be!","Unfortunately, yes. Finding the remaining crystals now is of the greatest urgency. All Conservatism depends on it.","I am your instrument, thy divine Graces. Where do I begin?"],1,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ralph Klein"),!0)}],[["Through you, Kenney, will we speak to Albertans with the collected wisdom of conservatives throughout time:","Burke, Tocqueville, Locke, Smith, Bentham, Mill... from your sword their words will be transformed into action...","You are Alberta's only hope."],0,0,4,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["Yes. Of course I am! It is my destiny!","Go now, Kenney. Time is of the essence. All Conservatism is counting on you.","I will not fail you, Your Most Divine Ones. Glory to the Hand!","Yes, Glory to the Hand."],0,1,5,function(){a.f.pantheon_endScene()}],[["Go now, Kenney. Time is of the essence. All Conservatism is counting on you.","I will not fail you, Your Most Divine Ones. Glory to the Hand!","Yes, Glory to the Hand."],1,0,5,function(){a.f.pantheon_endScene()}],[["Jason! You have recovered two crystals and as our battle against the NDP draws nearer, the odds increase in our favour.","But there is more to be done."],0,0,7,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ralph Klein"),!1)}],[["The High Council of Tories requires that you seek out a crystal from within the NDP's stronghold.","By either unearthing a new crystal from under Queen Notley's nose or stealing one she already possesses, you will greatly weaken our opponent."],1,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ralph Klein"),!1)}],[["Take your leave now, Jason. The Gods of conservatism go with you.","In the name of the Hand!"],1,0,8,function(){a.f.return_kenney_to_base_before_edmonton()}]],"Ralph Klein":[[["I can't believe it! I gave up looking for the crystals while I was still leader.","But then, I didn't need 'em..."],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["She's captured the noblest of cosmic entities: the One True Market Force, the Invisible Hand itself!","Outrageous! The NDP's ideological lunacy knows no depths!","I hear ya. I'm so angry I could blow up another hospital."],1,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["The Gods of Conservatism will be with you in spirit as you seek the crystals. We will offer you what guidance we can."],0,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["Okay, okay... Get a room if you're gonna wax on about it.","Apologies, my Grace."],1,0,4,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["Your Graces! What must I do next?","We're sending you to Edmonton. It's a rotten place, I know, but the mission is critical."],1,1,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}],[["A brilliant strategy by the High Council, your Grace!","And once a third crystal is in your possession, you should be ready to finally besiege Edmonton once and for all, freeing the Invisible Hand and reclaiming conservatism's rightful place at the seat of power in Alberta.","The UCP's steel is prepared!"],1,1,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Margaret Thatcher"),!0)}]],Bartender:[[["Craft beers? Yeah, we've got 'em. And they're better than anything on offer in Edmonton.","In fact, everything here in Calgary is better than what you'll find in Edmonton. You can take that to the bank."],0,0,0],[["Argh! Another batch of artisanally made craft-brews ruined on account of them rats!","You seem frustrated, my good man. Are NDP policies laying low your independent business?","Uh, no. It's the rats. The rats! They've come back to Alberta and keep eating all my supplies of hops."],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Bartender"),!0)}],[["How am I to brew offensively bitter craft IPAs without my hops? I need hops!","Ungodly amounts of hops!","But the rats are taking it all for themselves and their king.",[["Tell me about your hops.",3],["Tell me about the rat king.",4]]],0,0,3],[["Oh my goodness! My customers can't get enough of it.","All they want are IPAs, IPAs. The more bitter the better.","...","If this is the desire of Albertans then it is the will of the Invisible Hand! Supplying your customers with the product they seek is the reasonable course of action! ","Uh, thanks, dad."],0,0,4],[["As any Albertan is proud to tell you, this province has been rat-free since the 1950s.","The government  and I know you UCPers hate government but, by golly, this was a humdinger of a public works initiative  ...","... developed an early-warning system along the eastern edge of the province staffed by agents tasked with clearing out rat nests wherever they found them.","Needless to say, the program's been a success until now."],0,0,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Bartender"),!0)}],[["I will defeat them..."],0,1,6,function(){a.f.ratKing_addMapTile(),a.game.player.addQuest("kq-q-ratking")}],[["Hey, thanks for being willing to save my hops.","The whole of the craft beer business thanks you."],0,0,6]],Roy:[[["The Stampede's a-comin' I'm gonna get shitfaced in the most family-friendly way."],0,0,0]],Ava:[[["Albertans owe their prosperity to the Industry and the Invisible Hand, who blesses it with good fortune.","Except when it doesn't. I could really go for it doing that less."],0,0,0]],Sophia:[[["I've been hearing rumours about rats having returned to Alberta.","And no, that's not some coded joke about Kenney and the gang of professional politicians from Ontario he's brought with them.","But if it were, it'd be accurate."],0,0,0]],Ravi:[[["I worry about what the NDP warlord John Horgan from the province of British Columbia will do to our Industry.","Of late, he's been leading raiding parties into Alberta, tearing up pipelines. ","Someone's GOT to stop him!"],0,0,0]],William:[[["You'd think the socialist governments running Alberta and British Columbia could work out their feud and get the pipelines back on track.","It's really STALIN' the flow of oil! Ha! Get it?","I'm using that one at the next Manning Conference stand-up night."],0,0,0]],Owen:[[["Ugh! Trudeau! I hear that name and I break into a cold rage. And now he owns our pipeline!","Well, no, technically it's the federal government that owns the pipeline. But use that irrational anger to support the UCP!","Oh, I will, Mr. Kenney. You can count on me!"],1,0,0]],Liam:[[["So I work with this guy Ethan whose new truck was running suspiciously silently, y'know?","So I ask him, Ethan, what's the deal with your truck?'","Turns out it was a hybrid. Half-electric. Can you believe the nerve of that guy?"],0,0,0]],"Naheed Nenshi":[[["Oh, hi there, Jason. How are you this fine Calgary morning?","I'm well, mayor Nenshi.",[["I am on a secret quest.",7],["Are you doing your YouTube show?",8]]],1,0,0],[["Quiz question slot"],1,0,1],[["Quiz CORRECT answer slot"],1,0,1,function(){a.f.quiz_question(1)}],[["Quiz INCORRECT answer slot"],1,0,1,function(){a.f.quiz_question(1)}],[["Congratulations! You got enough answers correct! Here's your pass west and I've informed the park rangers to let you through.","And despite the fact that I'm opposed to just about everything you stand for, Jason, good luck on your quest!"],0,0,13,function(){a.f.calgary_02_clearWay(),a.f.nenshi_questComplete()}],[["Oh, that's too bad. You didn't answer enough questions correctly to merit a pass into the Rockies.","But, tell you what: I'm a generous guy. I see no reason why I can't cut you a break. Divine Destiny is on your side, or whatever you've been telling people.","Here's your pass into the Rockies. Good luck!"],0,0,13,function(){a.f.calgary_02_clearWay(),a.f.nenshi_questComplete()}],[["Oh, hi there, Jason. How are you this fine Calgary morning?","Mayor Nenshi! I seek passage west into the Rocky Mountains.","Oh! Ok!","Really? It's that simple?","Well, I have everybody who comes visit me appear on my YouTube show.","Ugh. I don't have time for this.","Hey. I'm the mayor. Do you want passage west into the Rockies or not?","Very well.","The first of five questions:"],1,0,1,function(){a.f.quiz_question(a.game.actions.randomQuizQ())}],[["Is that so? Would you mind telling my audience what that is? We're currently live on my YouTube show.","Huh? What?!","Kidding! Kidding! Mayor humour. Ha ha!"],1,0,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Naheed Nenshi"),!1)}],[["Why, yes! Would you like to appear on my quiz segment? The prize is passage west into the Rocky Mountains.",[["Yes! I may require that.",9],["I don't have time for games.",10]]],1,0,8],[["Alright then! We're live now with Sir Jason Kenney, leader of the UCP, who's here with me to answer five questions in the hopes of securing passage into the Rockies.","First question:"],1,1,9,function(){a.f.quiz_question(a.game.actions.randomQuizQ())}],[["That's too bad. The mountains are hugely popular here in Calgary. It would be a shame to miss them.","Some other time."],1,0,12,function(){a.game.actions.setCharacterDICache("Naheed Nenshi",12,"kq02-calgary-01")}],[["But seriously. I'm curious whether you'll do a quiz live on my show. Five questions. The prize is passage west into the Rocky Mountains.",[["Yes! I may require that.",9],["I don't have time for games.",10]]],1,0,11],[["Welcome back, Jason. Ready to take my quiz?",[["I will take your quiz.",9],["I still don't have time for games.",10]]],1,0,12],[["Good luck on your quest, Jason."],1,0,13]],"Empress Bovina":[[["Moo."],1,0,0]],Gord:[[["I tell visitors Alberta isn't the redneck province they think it is. We're as globalised as anywhere else.","I know some cattleranchers who dig listening to K-pop on the job."],0,0,0]],Amelia:[[["Does the Trans Mountain purchase prove the NDP can get things done?","I will resolutely deny whatever evidence suggests they can. UCP 2019!"],0,0,0]],Ted:[[["The nanny state wants me to force me to put on a helmet while hunting on my ATV. Can you believe it?","As a self-sufficient adult, I'll do whatever the hell I like."],0,0,0]],Lucas:[[["I hate to say it, but Trudeau's pipeline purchase leaves Alberta and all of Canada better off.","I'm seriously considering conscription into Queen Notley's army."],0,0,0]],Avery:[[["They say Alberta's chinooks bring warm air to the rest of Canada.","I like to think it brings with it common sense, as well."],0,0,0]],Sheila:[[["MY privilege looks a lot like hard work and good choices!"],0,0,0]],Gerald:[[["I hear the rogue air-pirate Fildebrandt has been causing a ruckus all up and down Alberta.","Good on him! That there's a lad who's got the common touch that will shake things up."],0,0,0]],Charlotte:[[["I'm so, SO sorry about my truck! It broke down right in the middle of street. This is super embarrassing..."],0,0,0]],Belinda:[[["k.d. lang's a legend."],0,0,1],[["Ever fed a Timbit to a bear?"],0,0,0]],Anju:[[["Yee-haw!",[["Yee-haw!",1],["You mean 'yahoo,' right?",2]]],0,0,0],[["Mmm...nope. That was a test and you, sir, have failed."],0,0,3],[["Mm-hmm. You have chosen ... wisely."],0,0,3],[["I'm on Team Alberta!","Are YOU?"],0,0,4]],"Richard Starke":[[["Richard Starke! You're a long way out from Vermillion-Westminster.","Good day, Kenney. I'm in Calgary campaigning on the Progressive Conservative name.","You mean - *chuckle* - the one belonging to the United Conservative Party?","I think we can both agree that under you there's little vestige of anything 'progressive' about the UPC. I will dutifully carry the banner of the PC legacy.",[["Well, we've all got to live for something.",1],["It's time you stopped using that name.",2]]],1,1,0],[["We are men who both value principles. I respect that in a warrior.","You mean the principles that enable you to look past your party faithful hurling nasty epithets at fellow conservatives who dare speak out against you?","I have created a big-tent party, Sir Richard. I deign not control what can and cannot be said by members of a grassroots movement.","Horse manure. You mean to say you refuse to hold them to account, more like. Face it, you've opened a nasty can of worms in pursuit of victory."],1,1,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["The Progressive Conservatives are no more, Sir Starke. You insist on playing courtier to a corpse, one Albertans deposed and buried in the ash heap of history.","By insisting there is value still in the PC name proves you're a fool.","But I can revoke your right to the name anytime I wish as I am the now the leader of what the PCs once represented in this province."],0,1,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["Sir Kenney, I told you my mind wouldn't change. It still hasn't.","I haven't come to ask you to join us, Sir Starke. By the Hand, no! I seek your help.","My help?! I wouldn't help the UCP for all the oil in the world!",[["The NDP seek to destroy the Invisible Hand!",7],["I'll force you to stop using the PC name.",8],["We have nothing more to discuss.",9]]],1,0,3],[["Sir Starke, I come seeking your help.","What might that be, Sir Kenney? I swore I'd never help the UCP, which is why I continue to campaign under the PC name.","Admit that the PC legacy is tarnished, Sir Starke! It will never again be a viable party in Alberta. Join the UCP and your voice will be heard.","It's about principles, Sir Kenney. I have them. You don't. That's what stands between me and joining you.","But what of mutual interests? Can I not persuade you on those grounds?",[["The NDP seek to destroy the Invisible Hand!",7],["I'll force you to stop using the PC name.",8],["Perhaps we have nothing more to discuss.",9]]],1,1,4],[["My continued use of the PC name is a stand for the principles of PROGRESSIVE conservatism. I'm happy to say I have no place amongst the toxic cesspool of your party.","As you wish, Richard. I maintain there is always a place for you should your mind change.","It won't. Good day."],1,0,6,function(){a.game.globalAchievements.starkeConvo=!0}],[["My mind won't change, Sir Kenney. Good day."],0,0,6],[["The Hand? What? How!?","They seek the lost Crystals of Confederation. With their power the NDP would bring untold levels of regulation to Alberta's market.","But free-market principles are what have helped make Alberta great...","Indeed. The UCP and NDP are in a race to find more of the lost crystals and time is of the essence."],1,1,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["You're a nasty piece of work, Sir Kenney. This is the very kind of personal-vendetta politics that turned me off of you.","Success in politics is attained only through the willingness to seize every available opportunity, Sir Starke. And right now, I have all the leverage over you. Now what do you say?","Humph. Very well, KENNEY."],1,0,12,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["Then be on your way."],1,0,10],[["You've returned. Have you something to say to me?",[["The NDP seek to destroy the Invisible Hand!",7],["I'll force you to stop using the PC name.",8],["Never mind.",9]]],1,0,10],[["I am asking for your help. Not for the UCP, but for all Conservatism. We need a way into Edmonton where more crystals are to be found.","Yes...yes. The situation sounds grave. I will put aside my doubts about you and your party, which, though great, are nothing compared to the threat of government intervention of our markets."],1,1,12,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["The PC party had a network of tunnels built between Calgary and Edmonton long ago.","You will find the entrance inside City Hall. Follow the tunnels to an underground lake that feeds into the Bow River, from which you can enter Edmonton undetected."],0,0,13,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Richard Starke"),!1)}],[["Thank you, Sir Starke. The PC legacy of abuse of taxpayer dollars will surely aid me in my quest to depose the very problem its arrogance helped create.","Hmph. Don't get saucy.","The Tory gods smile on you, Sir Starke. Glory to the Hand!","*Sigh* Yeah, yeah... the Hand..."],1,1,14,function(){a.f.starke_edmonton_path()}],[["Be on your way, Sir Kenney."],0,0,14]],Arundeep:[[["Markets have been behaving strangely as of late. Oil prices are all over the map.","It's anybody's guess what will happen next."],0,0,1],[["What's going on with the markets?"],0,0,1]],"Sandra Jansen":[[["Queen Notley!","Minister of Infrastructure, Sandra Jansen. Since you left the discredited Progressive Conservative party and joined us, you have fought ably and nobly for the NDP cause.","That snake Jason Kenney has hollowed out the centre of politics in this province, My queen. Callous and opportunistic, he brings discord to Alberta.","Indeed. You are a fighter, comrade Jansen. For that reason, I made you chief of the Alberta NDP Order of the Valkyrie, charged with securing our government's position in Calgary.","I relish the battle, my queen. I will grind the UCP foe into the dirt with the heel of my Stetson and my lickspittle former colleagues in the PC party will rue the day Kenney arrived on their doorstep.","Very good, comrade Jansen."],1,0,1],[["My lickspittle former colleagues in the PC party will rue the day Kenney arrived on their doorstep."],0,0,1],[["My queen! We may have the advantage. And if we press the attack, we may well take parts of Calgary.","Our governments' hold on power would then most certainly be secured."],0,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Sandra Jansen"),!1,!0)}],[["That is heartening news, comrade Jansen. Let us rally our troops."],1,1,4,function(){a.game.player.data.dI=14,a.game.dialogue.initDialogue(null,a.game.player,!1,!0)}],[["Queen Notley. The NDP Grand Commissar himself, Jagmeet Singh, has arrived and seeks an audience with you.","He's at the other end of the hall.",[["Unnnngggghhhh...",5],["Very well.",6]]],0,0,4],[["I'll go. What choice do I have?"],1,1,7],[["Very well. I'll meet with him on my way out the Pride festivities."],1,1,7],[["We will fight, fight, fight for the NDP!"],0,0,7],[["Our battle and ultimate victory against the racists, misogynists and bullies of the UCP will be our finest moment!"],0,0,7]],"Shannon Phillips":[[["Queen Notley. Solidarity forever!","Solidarity, comrade Phillips. As my Minister of Environment and Parks and Minister Responsible for the Climate Change Office, you have fought many battles.","I do it in the name of solidarity, my queen. Gaia provides Albertans with health and prosperity, but so does Industry. We must develop our resources through consultation and negotiation to stimulate investment, while exercising responsible stewardship of the environment.","Very good, comrade Phillips.","UCP forces have stepped up their attacks as of late, but our lines are holding. The Climate Leadership Plan supports our government's goal of recovering the crystals, thereby diversifying our economy, creating jobs and improving Albertans' health.","I have faith in you, comrade."],1,0,1],[["Solidarity forever, queen Notley!"],0,0,1],[["Finally, the mask has slipped with respect to what Jason Kenney wants to do to the people of this province."],0,0,3],[["Kenney does not want to talk to Albertans about doing things like firing pregnant women.","He does not want to talk to Albertans about restoring an employer's ability to fire someone who needs to take time off to care for a child with cancer."],0,0,2]],"Deron Bilous":[[["Economic Development and Trade Minister, Deron Bilous. How goes the economic diversification initiative that will finish off the Invisible Hand once and for all?","My queen!  My ministry continues to work hand-in-hand with the secret crystal taskforce to secure the lost crystals and bring the conservatives' false faith in completely open, unregulated markets."],1,1,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Deron Bilous"),!1)}],[["We will expose the conservatives' wrong-headed approach to economic management once and for all.","Albertans will embrace a thoughtful approach to our economy, with a regulatory scheme developed in consultation with the province's top business leaders and small enterprises alike."],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Deron Bilous"),!1)}],[["And what of our efforts to combat British Columbia's chief warlord John Horgan and his band of marauders obstructing pipeline development on our western border?","Our efforts on that front are slowed by his government's possession of the Crystal of Infrastructure Projects, my queen. From this crystal flows much of the magic from which we Albertans draw our prosperity and his SHITHEAD government is using it against us!","Comrade Bilous! Mind your tongue!","Apologies, my queen. My passion to win this battle and build the TransMountain pipeline is overwhelming, and the war our supposed New Democrat fellows in British Columbia wage on us has me fiercely dismayed.","I understand, comrade. But leave it to me to deal with the warlord Horgan and the leader of our federal wing, the Emperor Contender Jagmeet Singh. Their lack of solidarity with Alberta's interests will be their undoing."],1,1,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Deron Bilous"),!1)}],[["The war our New Decomcrat 'allies' in B.C. and on the federal level has me fiercely dismayed."],1,1,3],[["We stand on guard for the NDP! None shall pass!"],0,0,4],[["Greetings, comrades!","Comrade...","My stars! I've just heard there is a foodtruck fire by the legislature grounds. It's created a green onion cake free-for-all!","Are...are you serious?"],1,1,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Deron Bilous"),!1,null,!0)}],[["Joe, I'm sorry. There are free all-I-can-eat green onion cakes.","Everything that I am has culminated in this moment. I don't care what happens after this. I have to go."],0,0,6,function(){var e=a.game.actions.getCharacter("Joe Ceci");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["Oh, you don't have to ask me twice. I'd give up everything I am for those delicious fried treats."],0,0,7,function(){return a.f.edmonton_clearPalaceGate()}],[["Kenney would force changes through quickly so opponents have no time to mobilize against them.","Isn't careful deliberation what democracy is for?"],0,0,9],[["Overturning the public sector through massive jobs cuts and the creation of state-owned enterprises to deliver government services with a focus on efficiency and profit..","always works better on paper than in practice."],0,0,8],[["Shout out to Take 5 Bakery. The best donuts in Edmonton! ALRIIIIGHT!"],0,0,11],[["The hypocrisy of the the BC government encouraging LNG development over our pipelines is too much!","LNG will bring a 174% increase to tanker traffic to Kitimat. So much for their concern about whales"],0,0,12],[["Ukraine is tops!"],0,0,10]],"Danielle Larivee":[[["Children's Services Minister Larivee. You oversee a difficult portfolio. You command my respect and that of this entire government.","Thank you, my queen. I ...","You seem troubled, comrade. What is it?","Well, I've been wondering...","You can ask anything of your queen. We are an egalitarian government.","That ... that's just it, though. You're the queen of a purportedly non-hierarchical collective. So what is it? Are we monarchist or socialist?","Oh, ho ho, comrade. You lack imagination! As your queen, I merely offer my guidance, to you, my ministers and comrades, in the execution of the duties to which you report to me in a spirit of allegiance and solidarity.","That makes no sense, my queen.","Ho ho, comrade, comrade...you're making my head hurt. Carry on, but rest assured you're always invited to question this government. Truth does not arise from self-censorship.","No, my queen. Er, uh, yes, my queen."],1,1,1],[["Solidarity forever, my ... queen."],0,0,1],[["I shudder to think of what a UCP government will do to essential public services the most vulnerable in our province depend on."],0,0,3],[["Im having conversations with everyday Albertans about their provinces future!"],0,0,2]],"David Shepherd":[[["My queen! I've written you a song for the upcoming Pride celebrations.","Comrade Shepherd, as the representative for the constituency of Edmonton-Centre you oversee the morale of our stronghold, the capital. Your talent will carry our base through the battles that lie ahead.","Thank you. Would you like to hear what I've written?",[["Please.",1],["Not now, comrade.",2]]],1,0,0],[["*clears throat*","Oooooh, Aaaaaaah, Waaaaaaa....","Baby, baby, baby...","Ooooh, Queen Notley, yeah...","Baby, baby, yeah...."],0,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("David Shepherd"),!1)}],[["I will continue to develop the song, my queen."],0,0,2],[["What do you think?",[["Very good, comrade!",4],["It needs some work.",5]]],0,0,3],[["Thank you, my queen. I will continue to develop the song."],0,0,2],[["Thank you, my queen. I will find a new direction."],0,0,2],[["I believe in music as a force for social change!"],0,0,7],[["Climate action isnt free. The cost must be covered by growing our economy and creating jobs.","Thats why TransMountain is essential!"],0,0,6]],"Shaye Anderson":[[["Queen Notley!","Municipal Affairs Minister Anderson. The battle in the rural districts of our realm has been arduous. Though the prospects are grim, your continued enthusiasm has been a bright spot for our government.","I credit my Samson-like resolve to my beard, my queen. Have you seen my beard?","Uh, yes, comrade Anderson. It's on your face. I'm looking right at it.","It's really big.","Yes, it is.","By the way, I stopped my pickup at the Timmy's drive-thru this morning and picked you up a large double-double. Here you go. *reaches into beard and procures a large Tim Horton's coffee*","Ah! The coffee of the proletariat. I am grateful, comrade. I'll have our media department arrange a photo of me sipping it at family-owned farm shortly. All the better to show our solidarity with the workers."],1,0,1],[["My beard's really big."],0,0,1],[["Hey, Queen Notley. Check out this cute animal video!","Oh my! The heart melts!"],1,0,3],[["Climate change is frightening. But the future is up to us!"],1,0,3]],"Alberta Parks Officer":[[["Apologies, sir. The road through the park is closed at this time.","If you speak with Calgary's mayor Nenshi, however, I'm certain he can arrange passage.","But please come visit Alberta parks again soon!"],1,0,0,function(){a.f.quiz_set_nenshi_quest()}],[["Welcome! The road is open. Just pass through the gatehouse."],1,0,1],[["Apologies, sir.The road through the park is closed at this time."],0,0,2]],"John Horgan":[[["Be still my dogs of war. The way ahead is flooded.","What?! From the swill before us drifts the fragrance of British Columbia's finest vintages.","*Horrified* Could it be OUR wines cast into the valley?!","Carelessly mixed together to create neither red nor white but a ...","*Disgusted* ...rose?!","Who would be so bold as to waste the bounty of our province and just...","...walk away?"],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["That would be me, Mr. Horgan. Jason Kenney! Hero of Alberta.","Jason. Jason Kenney? Yes, I've heard of you. Yet another self-declared hero to the West whose provenance is the East. Pathetic."],1,1,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["How now, Mr. Horgan? Free market Albertans have chosen me as their leader.","The land from whence I hail means little to the tolerant and open-minded people of Alberta.","What's important is they've heard my words, and have accepted the spirit of divine destiny that animates them."],0,1,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Are you sure Albertans aren't mistaking divine destiny for cattle emissions? Because what you're saying smells like cow shit to me.","I'm here to end your death-by-delay strategy of obstruction. Instead, I will obstruct YOU."],1,0,4,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Ba ha ha! What can you do? You're just an upstart former federal cabinet minister convinced of his own exceptionalism.","The real power to stop me lies in the hands of your Queen Notley and the Emperor Trudeau.",[["Yes, but they're listening to ME.",5],["The UCP is a threat to you.",10]]],0,0,4],[["Listening to a conservative?","Conservative AND master strategist!"],1,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Not only have I urged Emperor Trudeau to use his constitutional power to pass bill S-245 and ensure the pipeline is in the national interest ...","... but I've also convinced him to use the power of the purse to FORCE your province's submission.","Emperor Trudeau, if he acts wisely, will not hesitate to withhold funds marked for British Columbia.","Without infrastructure investments and job training funding, your people will cry out. And Alberta will reap an even greater victory."],0,1,7,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Mere threats."],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Maybe. But can you afford to renege on your party's promise that adult educational upgrades and English language programs would be tuition-free?","Or the BC Bus North service, providing travel options to your province's northern climes?","Face it: there is no NDP government without freewheeling spending, Mr. Horgan. It's your party's Achilles heel.","And that money must come from somewhere."],0,1,9,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["So the presumed hero of Alberta is speaking up in favour of government overreach against a province defending itself?","Ha ha ha","Mwa ha ha!","Sir Kenney, your words ... humour me.","I will withdraw my dogs of war to British Columbia's lands.","But know this: I would have thought that a province like Alberta, once harmed by the National Energy Program, would be keenly opposed to federal overreach.","And that you would sympathize with a province defending its interests.","I see now you will align yourself with whoever helps advance you.","Sir Kenney, principles are still a valuable currency in the realm of politics. You may have paid for your victory today in fool's gold."],0,0,9,function(){a.f.pipeline_end()}],[["When my party comes to power, we will show you no mercy.","We will flood your province with sanctions. Throttle ALL energy exports to you.","No more diplomacy.","Perhaps we'll even invade a 2-meter wide stretch of your province all the way to the coast and build our pipeline on it.","Alberta is mighty. The UCP will wield that might ably and B.C. will submit."],0,1,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Not if the constitution has anything to say about it. Your assuming powers you don't have.",[["I will trample the constitution!",12],["Your strategy of delay hurts all of Canada!",14]]],0,0,11],[["Justice for Alberta stands above all.","For too long has this province been on the wrong end of anti-pipeline rhetoric from those who would benefit from it.","Albertans share the bounty of their land and, once eagerly consumed by its critics, they call it toxic and brand Albertans climate criminals.","Enough, I say! No agreement between the federal government and Alberta is good enough if it saps the province of its dignity.","Alberta will go to arms for access to the ocean and I will lead them into the fray!"],0,1,13,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Hmm your words have moved me to withdraw my dogs of war, Sir Kenney. We will return to our lands.","What's more: I give you the crystal that powers my war caravan.","But know this: I would have thought that a province like Alberta, once harmed by the National Energy Program, would be keenly opposed to federal overreach.","And that you would sympathize with a province defending its interests.","I see now you will align yourself with whoever helps advance yours.","Sir Kenney, principles are still a valuable currency in the realm of politics. You may have paid for your victory today in fool's gold."],0,0,13,function(){a.f.pipeline_end()}],[["Investors are nervous. How will you pay for your generous social programs without the expansion of industry to support it?","AND DON'T SAY TAXES!"],0,1,15,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["*Mumbling* Not a lot of taxes..."],0,0,16,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Your stalling sets a poor precedent for major infrastructure investment across all of Canada.","What future investors will do business when the mechanisms for resolving disputes with the federal government are in complete disarray?","When there is clear potential for all projects to die the same way?"],0,1,17,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0)}],[["Hmm your words have moved me to withdraw my dogs of war, Sir Kenney. We will return to our lands.","But know this: Alberta has assumed zero risk in the project. Your territory will not see the threat of double-hulled barges dangerously coursing through narrow passages en route to sea.","Your business leaders in their suits, high up in their glass towers though they may be, cannot  will not!  see the risks I am defending British Columbia from.","Take your victory today, Sir Kenney, and the crystal that powers my war caravan.","It has served well my efforts to preserve British Columbians' dignity.","Use it to preserve Albertans'."],0,0,17,function(){a.f.pipeline_end()}],[["Queen Notley. Though let's be clear: not MY queen."],0,0,19,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Mr. Horgan. I understand you represent your province and there is *some* opposition to Alberta's pipeline reaching the coast.","But you wish to shake my hand and make peace while your government enthusiastically build LNG facilities as it puts my own government in peril?","Ha! Away with you both. I'll shake hands before the TV cameras, whatever is required for optics. But you won't get any real concessions from me, comrades.","For Queen Notley represents Albertans and will be held accountable to no other!"],0,1,20],[["Your decision is unfortunate, Queen Notley. This is a sordid web we weave when polticians on the same side of the aisle refuse to act in solidarity.","No better words have been spoken...COMRADE."],1,0,21,function(){return a.f.ndp_palace_02_horganExits()}],[["...COMRADE."],0,0,21],[["Something..."],1,1,21,function(){return a.f.ndp_palace_02_horganExits()}]],"David Suzuki":[[["Ha ha ha!"],0,0,0]],"Justin Trudeau":[[["Justin! How ARE you?","Sir Kenney. You fooled no one into thinking you were truly sorry for your comments about me.",[["Ha! No one who COUNTED was ever going to believe that apology!",1],["In fact, I AM sorry.",3]]],1,1,0],[["Is that so?","I said something radical and got the media off my back about 'bozo eruptions' amongst my candidates.","Hmm...","I got front-page coverage and looked good being hard on you."],1,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Justin, you're the most useful thing that's ever happend to me!","Oh my, yes! So are you!","You and I make the most mutually leverageable of enemies.","*Chuckles* I'd shake your hand but I don't want your oils all over me.","And I wouldn't want to inadvertently end up in your selfie."],1,1,2,function(){var e=a.game.actions.getCharacter("Justin Trudeau");a.game.actions.checkForQuestNodeId("Justin Trudeau","kq-q-pipeline-0")?e.data.dI=9:e.data.dI=30,a.game.dialogue.initDialogue(null,e,!1)}],[["Is that so?","Sorry we have such a milquetoast emperor! Ba ha ha!","Always good for a 'bon mot,' Jason. I like that about you.","Hmph. There's NOTHING I like about you."],1,1,4,function(){var e=a.game.actions.getCharacter("Justin Trudeau");a.game.actions.checkForQuestNodeId("Justin Trudeau","kq-q-pipeline-0")?e.data.dI=9:e.data.dI=30,a.game.dialogue.initDialogue(null,e,!1)}],[["Just as well. It would risk your worldview to give the progressive vision even a moment's consideration. It makes far too much sense.","But that's what makes you so very useful to my federal Liberals, Jason.","Your uncompromising attitude. It's too radical for most Canadians.","They seek balance. Compromise.","Now, with my newly forged sword, the Neo-Laurentia,' I shall reinforce these very values within the federation!",[["The Neo-Laurentia?",5],["I'm not here to listen to your twaddle.",9]]],0,0,5],[["Long have I been at work on the Aga Khan's island, forging in the flames of my own superlative image a new sword to rival conservatism.","I call it, the Neo-Laurentia!","My blade takes the name of the new order I shall bring to Canada, whose power will be centred on an empowered Ottawa that will shape this nation into its TRUE image:","that of a 21st Century, liberal and secular society!","Soon the Neo-Laurentian movement will dominate federalism!","In public schools, religion will be out and French in!","Progressive social policies will be legislated across the board.","Tax dollars from the vassal provinces will fill Ontario and Quebec's coffers.","Canada's heritage will be wiped from public institutions in favour of cultural symbols designed and approved by a committee of progressive academics.","It will be a glorious new age!",[["This is madness!",6],["Mere praddle off of a cocktail napkin...",8]]],0,0,5],[["It is a universal TRUTH that what the Invisible Hand giveth, the Invisible Hand taketh away!","You're willfully blind to the power of the open market.","Instead, you and your Liberal ilk pedal wrong-headed social policies and a statism that defies the will of the people.","And that WILL, Justin, is to see their fortunes guided by the wise and principled Hand.","NOT elitest bureaucrats!"],0,1,7,function(){var e=a.game.actions.getCharacter("Justin Trudeau");e.data.dialogue={swordConvo:!0},a.game.actions.addToCachedObject("Justin Trudeau",{dialogue:{swordConvo:!0}},"kq02-calgary-03"),a.game.dialogue.initDialogue(null,e,!1)}],[["My sword is powerful, Jason. More powerful than the Sword of Conservatism your master Harper forged in the time of the federal conservative unification.","It is this sword with which you carry out your own self-styled 'destiny.'","But MY destiny, Jason, is guided by forces more powerful than your backward-looking deities"],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["I haven't time for your nonsense. I have urgent business to discuss."],0,0,9,function(){var e=a.game.actions.getCharacter("Justin Trudeau");e.data.dialogue={swordConvo:!0},a.game.actions.addToCachedObject("Justin Trudeau",{dialogue:{swordConvo:!0}},"kq02-calgary-03"),a.game.dialogue.initDialogue(null,e,!1)}],[["So what would you ask of your emperor?",[["So you're a pipeline owner now?",10],["What news of the warlord Horgan?",32]]],0,0,9],[["My government did what was required to ensure Canada's prosperity. It wasn't easy, but it was the right decision.","That said, prosperity continues apace in this country, with the federal Liberals ... ","... in partnership with the Alberta NDP ...","... sounding the clarions."],0,0,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Conservatives like myself may have had little choice but to support your purchase, Justin.","But it was your policies and radical progressive values that forced you into this position.","Your own policies are a poisoned chalice.","With them, you harm Canadians. This will not stand!"],0,1,12,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[[["You sound like you're making a run for emperor. I'm trembling.","Nay! I'm simply defending Albertans, who want a role in Confederation based on respect and reciprocity."]],1,0,13,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["A strong Canada means a strong Alberta, and vice versa. Your vision for the country harms both.","Listen to me:"],0,1,14,function(){var e=a.game.actions.getCharacter("Justin Trudeau"),t=0;t=e.data.hasOwnProperty("dialogue")&&e.data.dialogue.swordConvo?27:15,e.data.dI=t,a.game.dialogue.initDialogue(null,e,!1)}],[[""],0,0,0],[["Allow me to argue my case.",[["I am a master strategist!",16],["I will argue with facts and numbers!",25],["I will threaten action with the sword",29]]],0,1,15],[["I can suggest courses of action inconceivable to the second-rate minds staffing your government.","Let us put aside our partisan bickering and work together  you, Queen Notley, and myself  to ensure the TransMountain pipeline's success."],0,1,17,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Hmm...what do you have in mind?",[["Pass bill S-245",18],["Use the power of the purse",24]]],1,0,17],[["Make the TransMountain pipeline officially in the national interest and override the B.C. government's delay tactics.","And withdraw bill C-69 at once! Your federal Liberals have made it impossible to get another pipeline approved in the future --"],0,1,19,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Hold it. That's only according to my GOOD friends. the oil executives, in this room..."],1,0,20,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Well, of course. Whatever!","And repeal bill C-48 and allow oil tankers off the northern B.C. coast","It hasn't gone unnoticed there's no equivalent ban in the east from bringing in oil from Venezuela and Nigeria."],0,1,21,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Finally, a UCP government will see to it all oil exports from Alberta to British Columbia are ended.","They'll come crawling back to the negotiating table and you, Justi--","...Emperor Trudeau...","... will share in the victory."],0,1,22,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Hmm...time is of the essence.","After cancelling Energy East I can ill afford to see TransMountain fail, especially having gone to such lengths to ensure its success.","Do as you must, Jason. I will continue to work with Queen Notley's NDP government to put and end the warlord Horgan's delaying.","But our interests here intersect, and there is much we both stand to gain from his defeat.","To the west, the warlord Horgan was last seen passing through the mountains.","There is a route following the unfinished pipeline his caravan will most surely take.","Do with that information what you will."],0,1,23,function(){a.game.player.addQuest("kq-q-pipeline")}],[["Do with the information I've given you what you will. But I will continue to work with Queen Notley's government."],0,0,23],[["Withhold federal funds marked for British Columbia.","Cut off the money from the tax and spend B.C. NDP and their social programs will crumble, bringing the government to its knees."],0,1,21,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Year after year, Canada loses $15 billion off the sale of its oil because the U.S. remains our only export partner, resulting in a lower price.","At that rate, we as Canadians cannot be divided within our federal system!","I realise we are sworn enemies, but for the moment we face a challenge greater than the both of us."],0,0,26,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["You're not wrong, Jason. Continue."],0,0,16,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Listen to me:",[["I am a master strategist!",16],["I will argue with facts and numbers!",25],["We're done here.",28]]],0,1,27],[["Jason, have you not yet said your piece?"],0,0,27,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Jason, if a battle of might is what you seek you're in for a rude awakening."],0,1,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Justin Trudeau"),!1)}],[["Ho ho. Your wit is, as ever, biting.","Unfortunately, I have little to say to you at this time.","Return when there is something worthwhile to discuss."],0,0,31],[["Return when you have something worthwhile to discuss."],0,0,31],[["You're not in the federal government anymore. I needn't tell you anything.","Justi-- I mean, Emperor Trudeau -- listen to me:"],1,0,32,function(){var e=a.game.actions.getCharacter("Justin Trudeau"),t=0;t=e.data.hasOwnProperty("dialogue")&&e.data.dialogue.swordConvo?27:15,e.data.dI=t,a.game.dialogue.initDialogue(null,e,!1)}],[["Heya, Edmonton. It's me! Justin!"],0,0,34,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Rachel Notley"),!1,null,!0)}],[["But, I --"],0,0,34,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Rachel Notley"),!1,null,!0)}]],Pirate:[[["Yarrgh! We be the crewsmen for the Dread Pirate Fildebrandt. Who be ye?"],0,0,0]],"Hooded Figure":[[["The parts you will require to complete the challenge ahead lies elsewhere in these parts.","Find it or use other means. The choice is yours, Jason."],0,0,0],[["The way forward, Jason, requires the correct sequence of sygils to be set.","The solution can be found in Calgary. Go there and do not tarry!"],0,0,0,function(){a.game.mapWorld.updateWaypoint("kq-q-carbontree-3")}],[["Welcome, Jason Kenney.","Your destiny awaits on the other side of the river."],0,0,3,function(){a.f.boat_to_middle()}],[["You know, you sound awfully familiar to me...","We are indeed familiar, Jason Kenney. I've been sent by the High Council of Tory Elders to guide you on your quest."],1,1,4,function(){var e=a.game.objGroup.children[0];a.game.dialogue.initDialogue(null,e.children[1],!1)}],[["I am..."],0,0,4,function(){a.f.boat_reveal_self()}]],"Rona Ambrose":[[["Rona Ambrose! Warrior Priestess, First Order of Artemis. I kneel before thee!","You neednt bend the knee for long, Sir Kenney. For soon victory will be yours and as leader of this realm we shall be on equal footing.","But what doth summon thee?","Ive come to aid you in your quest, Sir Kenney. Long did we fight as compatriots at the federal level, heeding the clarion-cry of balanced budgets and resource development."],1,1,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Rona Ambrose"),!1)}],[["Since my return from the frontline of NAFTA renegotiations with the United Celestial Empire to the south, I have committed myself to recruiting more women into Albertan politics under the conservative banner.","I feel strongly that your party is currently bereft of female participation. Albertans dont need old white guys telling them what to do."],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Rona Ambrose"),!1)}],[["Well said!","*Sigh* Honestly, the male to female ratio in the UCP is cataclysmically embarrassing.","Huh huh. Yeah okay. I get it","But do not lose heart! Myself and all conservatism is on your side. Despite our namesake as conservatives, we will adapt as necessary. So tally forth, Sir Kenney. Glory to the Hand!"],1,1,2,function(){a.f.boat_to_shore()}]],"Bill Aberhart":[[["'Bible' Bill Aberhart? Leader of Alberta's Social Credit Party?","Indeed, it is I. The time of Rutherford's prophecy has drawn Alberta's heroes and historical footnotes alike to play their part. I humbly carry out mine."[["Fitting.",5]]],0,0,0,function(){a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["I'd have thought so, too, but it would appear my ideas of social credit have been consigned to the dustbin of Canada's history. Along with my party.","Just how in God's good name did it become the Pro-Life Alberta Political Association? Not that it doesn't represent my views, it just makes the mind wonder..."],0,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["In politics, there is much we who lead, though try as we might, can neither foresee nor control.","The NDP's goal of destroying the Invisible Hand, for instance..."],0,1,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["Ah, yes. I, too, once endeavoured to slay the Invisible Hand, long before that whipper-snapper Lougheed and his ilk embraced it like a cult.","The banks would have been the knee to my government! And no more would the plotters, money barons and the sons of Satan have enslaved Alberta's poor.","Thankfully, my one lasting contribution to the province -- the Alberta Treasury Branches -- remains to this day. The only government-run bank in all of North America!"],0,0,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["Uh, yeah. About that. I'm totally going to privatize it.","What?! You lout! Scoundrel! The sole remaining piece of my legacy and you'd callously throw it away?","Sir Aberhart, if the great Ralph Klein tried to do it, then it's the right decision by my account. We've nearly reached the shore.","Hmph. Be off with you, but your judgment will surely come."],1,1,5,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["Social credit was an idea for which there was never a time, Sir Aberhart. It was a dark magic, like carbon enchantments and ideologically-driven education reform.","Though, I do agree with you that the moral grounding of the education in your day is far preferable to what we have now."],0,1,6,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["That is just as well, Sir Kenney. But you're still guilty of playing lackey to the money barons and the sons of Satan who've enslaved Alberta's poor.","And I, I who fought the vile influence of capital on Alberta's farmers and labourers, am consigned to shuttling you safely to Edmonton.","Sugar! I led the greatest grassroots movement in the history of Canada!"],0,0,7,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}],[["And I will lead the greatest since, except I'll enjoy far more success.","Hmph. Only time will tell, Sir KENNEY..."],1,1,7,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Bill Aberhart"),!1)}]],"Freddie Mercury":[[["Freddie....Mercury?","Here I am! I am the master of your destiny. And you: a simple man with a simple name.","I ask that you open your mind and let me step inside...",[["Uh, okay...",1],["No!",5]]],0,0,0,function(){}],[["I see an orange queen, poking in the pile. Fie-fo she comes, marching single file.","She's a killer queen! Dynamite with a laster beam."],0,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Freddie Mercury"),!1)}],[["Yes, Quenn Notley IS a job killer, but cunning. I guarantee you, she, at times, blows even my mind. But the premiership is mine, so the Tory gods hath proclaimed it.","But to attain my prize, I require answers to my questions. Are you here to aid me in my quest, Mr. Mercury?"],0,1,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Freddie Mercury"),!1)}],[["Everything you need to know, you'll hear it on the radio.","Of course! Right-wing talk radio. The font of all wisdom. Of COURSE the answers I seek are there!"],1,0,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getBoatCharacter("Freddie Mercury"),!1)}],[["Very good, Mr. Mercury. We approach the shore where beyond lay Edmonton.","With your words, I am emboldened. I am a man that will go far.","With my head held high, I will pass this test the first time."],0,1,4,function(){return a.f.boat_to_shore()}],[["Just play the game. There's no escape from my authority!","You just want to be given the prize, but there's no chance for you, or any of us. It's all decided for us."],0,0,6,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Freddie Mercury"),!1)}],[["Agreed! Lady Destiny is indeed mighty. A real stormtrooper in stilettos.","And though the burden she hands me is great, it's both my pain and pleasure alone to bear it. Like Ralph Klein before me, leaderipsh of this province is mine to hold forever. So the Tory gods hath proclaimed it.","Pain is so close to pleasure. Who wants to lead forever?","I wish it were not so, but as you said, that decision rests in the lap of the gods.","And where will your principles go once you've taken the prize?","Ha ha! Any where the wind blows, my good man. Any where the wind blows."],1,1,6,function(){return a.f.boat_to_shore()}]],"Dying UCP Soldier":[[["*Choke* Sir Kenney! The battle is developing in our favour as the NDP slips back to Edmonton, but they are long from routed.","I, however, am *ungh* lost."],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Dying UCP Soldier"),!1)}],[["You have fought valiantly, fair warrior. Go gently into the fields of Elysium, where the lands are as bountiful as the Alberta prairie.","There you will find a herd to every cattleman, a big-C principled government is always in power, and you can trust that the minimal contributions you make as a taxpayer are spent wisely."],0,1,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Dying UCP Soldier"),!1)}],[["And *uuungh!* not on some cockamamie social engineering scheme by progressive bureaucrats!","Indeed.","Where...w-where the government can't *cough* FORCE me to wear a helmet on my ATV if I darn well don't please.","...Sure.","Where...where Alberta is an independent n-nation!",[["Now, let's not get ahead of ourselves...",3],["*Rolls eyes* Yeah, alright.",4],["What is WITH you separatists?",5]]],1,0,2],[["W-where the gays, they ... they can't marry!","*Groan* Ok, I gotta go..."],1,0,6],[["Where non-Christians drown in lakes of fire!","Ooooookay. I'm leaving you to die now."],1,0,6],[["Alberta will never be truly free until we've cast off the yoke of confeder-","*UNGH!*","Croak*"],1,0,6],[["..."],0,0,6]],"Truckstop Barista":[[["Hey, man. What can I get ya?","Coffees for freedom loving Albertans, please and thank you.","Ok! We have artisanal coffee available as an espresso, americano, cappuccino, flat white, iced, or pour over."],1,0,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Truckstop Barista"),!1)}],[["Ha! I win. Kept my cool. Nobody puts Derek Fildebrandt in the corner!","Whatever, man. It wasn't a contest."],1,1,2,function(){a.f.fildebrandt_endCoffeeChallenge(1)}],[["Whatever, man. It wasn't a contest."],0,0,2],[["We even do swiss drip with your choice of mountain spring, ozonated, ionized or distilled water. Your call, dude.","What on earth happened to good, old fashioned, regular, hard-working taxpayer coffee?","I ... don't know what that is. I imagine most people here pay their taxes...","I'm talking about coffee made in an everyday perculator and served in a styrofoam cup."],1,0,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Truckstop Barista"),!1)}],[["Styrofoam that, by the way, me as a FREE Albertan has EVERY RIGHT to toss carelessly from my truck when I'm done.","Or maybe I'm NOT done! Maybe I don't WANT anymore. Maybe it's lousy instant coffee that I wanted at the time and I decided I no longer do.","That's my freakin' RIGHT."],1,1,5,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Truckstop Barista"),!1)}],[["Sure, man. Tell you what, we've got a Valium mocha chai latte if you're interested. It's your right to pass on it if not.","Mocha...chai...WHAT?! OH. MY. GAWD!"],1,0,6,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Truckstop Barista"),!1)}],[["*Deep breathing* Keep it together, Derek. Can't let the liberals get the better of you...","It's served in a cup made of pulped feedlot grass with your choice of ethically-produced caramel, chocolate or whipped cream and gluten-free sprinkles."],1,1,7,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Truckstop Barista"),!1)}],[["Raaaaagh!"],1,1,7,function(){return a.f.fildebrandt_buttonMashChallenge()}],[["Gynnggghh!!!","That's it! I'm outta here!"],0,1,9],[["Now's probably not a good time to tell you we get business incentives from the government for our inclusive, globalised and ethical approach to coffee..."],0,0,9,function(){a.f.fildebrandt_endCoffeeChallenge(0)}]],Wendell:[[["Did you know Red Deer's official cookie is the Caramel Suprise?","True story!"],0,0,0]],Candice:[[["Coffee tastes so much better when I know its environmental impact has been factored into its cost to me as the consumer."],0,0,0]],Jay:[[["Would you consider putting aside those bacon and eggs for some fried seitan and tofu scramble?"],0,0,0]],"Oil Executive 1":[[["Money, money, money! Drill, drill, drill!"],0,0,1],[["Unless you've got a politician, academic, scientist or journalist you want me to buy, I don't have time for you."],0,0,0]],"Oil Executive 2":[[["I tend to stress-eat caviar and white truffles when locked in regulatory battles with governments.","It's not fair."],0,0,0],[["Oh, hello there. You have the look of someone who wants to do business. Lay it on me.","I come seeking a valve wheel to open the unfinished pipeline in the mountains.","Uh-huh. A politician asking for a favour. What's in it for me?","The end of delays to the pipeline's construction. The retreat of the B.C. NDP back to their territories.","Okay...","Um...the unbridled flow of money back into your sizeable pockets?"],1,0,2,function(){a.game.dialogue.initDialogue(!1,a.game.actions.getCharacter("Oil Executive 2"),!1)}],[["Mmmmm...money!","Money, money, money!","*sniffs self* Ooh, I'm covered in its aphrodesiac-like scent.","But I need more! MORE!","Here you go. A valve wheel. Use it and it will flood the road with all of the B.C. wine we're refusing to drink.","Do whatever you need to do to get the money flowing again so I might BATHE in ever-greater wealth."],0,0,3,function(){a.f.acquire_valveWheel("Oil Executive 3")}],[["Do whatever you need to do to get the money flowing again so I might BATHE in ever-greater wealth."],0,0,3]],"Oil Executive 3":[[["I've got a fifth Rolex riding on this pipeline's success."],0,0,0],[["I can smell an exploitable opportunity from a mile away, and you look like chum in the water to me. What are you after?","I seek a valve wheel to open the unfinished pipeline in the mountains.","Oh, yes. The TransMountain. Do you have a plan to fend off the irksome warlord Horgan and his marauding band of B.C. NDP members?","Yes!","I can help. But it will cost you ... your soul.","What?","Just kidding! Ha ha! Whooie! You should've seen your face."],1,0,2,function(){a.game.dialogue.initDialogue(!1,a.game.actions.getCharacter("Oil Executive 3"),!1)}],[["Hoo hoo! Hee hee! You're an Albertan politican ... I already have it."],0,0,3,function(){a.game.dialogue.initDialogue(!1,a.game.actions.getCharacter("Oil Executive 3"),!1)}],[["I am a servent of the Invisible Hand, the one true market force!","His wisdom suffuses our province's energy industry and ensures the land's bounty remains Albertans' to reap!"],0,1,4,function(){a.game.dialogue.initDialogue(!1,a.game.actions.getCharacter("Oil Executive 3"),!1)}],[["Of course. Of course. The Hand.","Here's the valve wheel. Use it and it will flood the road with all of the B.C. wine we were planning on sending back via the pipeline.","I want to see dollars coming out my ears when this is all over."],0,0,5,function(){a.f.acquire_valveWheel("Oil Executive 2")}],[["I want to see dollars coming out my ears when this is all over."],0,0,5]],"Oil Executive 4":[[["That Trudeau who's joined our ranks...I still don't trust him. It took a lot for us to get on-board with Queen Notley when she came to power."],0,0,0],[["My six-month vacation starts tomorrow but I've only made upward of $300,000 the past two quarters!"]]],"Oil Executive 5":[[["NO one will deny me my God-given right to pull as much oil from the ground as I want without paying royalties."],0,0,0]],"Hippolyte the Scurvy-Ridden Taxpayer":[[["Yarrgh! I may be plagued with scurvy, but that doesn't mean I expect a handout from the government to maintain me health.","'Personal responsibility above all else', as Cap'n Fildebrandt would say!"],0,0,0],[["Yargh! As a vanilla conservative, you're not welcome aboard.","But I abide ye so long as the cap'n says to."],0,0,1]],Lloyd:[[["Yaargh!"],0,0,0]],Max:[[["Yarrgh! We be the crewsmen for the Dread Air Pirate Fildebrandt, leader of the most vicious political party to ever sail Alberta's skies. Who might ye be?","I am Jason Kenney! Leader of the United Conservative Party and hero to Alberta!","Aye. I've heard of ye. Our cap'n has little good to say about ye. But in my opinion, he wants nothin' than to be in yer good graces.","Is that so? The scamp shouldn't have lied to me about illegally hunting deer.","Well, if the cap'n were around I'd leave it to you to discuss it with the him."],1,0,1],[["I'll leave it to you to discuss yer differences with the cap'n."],0,0,1]],"Derek Fildebrandt":[[["Jason Kenney. You kicked me out of the UCP but look at me now! I have my own party AND my own airborne pirate ship. Things are comin' up Fildebrandt.","Nice to see you again, Derek.","That's Dread Pirate Fildebrandt to YOU, Jason. I'm the most fearsome pirate captain to ever sail Alberta's skies. And an incomparable force in provincial politics bar NONE.","Derek, it's not even worth my time arguing with you.","No, it's not.","So I won't. Goodbye.","Wait. Uh, wait!",[["Yes?",2],["I'm off.",5]]],1,0,0,function(){}],[["Jason Kenney. You kicked me out of the UCP but look at me now! I have my own party AND my own airborne pirate ship. Things are comin' up Fildebrandt.","Nice to see you again, Derek.","That's Dread Pirate Fildebrandt to YOU, Jason. I'm the most fearsome pirate captain to ever sail Alberta's skies. And an incomparable force in provincial politics bar NONE.","Derek, it's not even worth my time arguing with you.","No, it's not.","So I won't. Goodbye.","Wait. Uh, wait!"],0,0,7],[["I, uh, know we've had our differences...","You lied to me repeatedly, Derek. About everything. You're a walking liability.","*Mumbling* But I'm a pirate...","Look, I may need your help. As a fellow conservative I'm sure you'll agree the situation is dire enough to merit your help in my quest.","What situation might that be?",[["The NDP have captured the Invisible Hand.",3],["I seek the lost Crystals of Confederation",4],["Never mind.",5]]],0,0,0],[["The Invisible Hand of the Market? The one true market force!? What is UP with liberals and their radical ideological, socialist agendas?","My sentiment exactly.","I mean, honestly. Liberals!","Truly, for all your faults, Derek, you feel the lusty battlecry of conservatism in your breast.","Jason, I live to engage liberals in swashbuckling combat and make their heads explode.","Then seize this opportunity to help a fellow a conservative.","What would you ask of me?","I need your ship to enter undetected into Edmonton.","Ha! A stealth mission. I can do that. The Dread Pirate Fildebrandt can do anything. Hop aboard!",[["Let's go.",16],["Not just yet.",14]]],0,0,3],[["Huh. You too, then?","It would appear the search for the lost Crystals is the biggest open secret throughout Alberta politics at the moment.","Nothing gets by Derek Fildebrandt. I'm a force of nature in Alberta politics. In fact, one such crystal powers my ship.","What crystal do you hold?","The Crystal of Rugged Individualism. It's a natural fit for ol' Derek, man of the people.","I believe kudos are in order. You would be wise to aid me then, Derek, as the stakes are high in the race for the crystals.","How so?","THe NDP seek to destroy the Invisible Hand of the Market and impose untold levels of regulation upon Alberta for all time to come."],0,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Wait! What?! Nobody just walks away from Derek Fildebrandt. Nobody!"],0,0,6],[["Hunh. You came crawling back. They always do. What is you want?",[["The NDP have captured the Invisible Hand.",3],["I seek the lost Crystals of Confederation",4],["Never mind.",5]]],0,0,6],[["Nobody just walks away from the Dread Pirate Fildebrandt. Nobody."],0,0,7],[["Welcome aboard my ship, maties, the headquarters of the Alberta Freedom Conservative P-AARGH-ty.","We'll lay anchor just outside Edmonton on a course that will take us directly over Red Deer.","If you head to the bow we'll talk more."],0,0,8,function(){a.f.airship_initFunction_tiles_laydown("fildebrandt_trigger_launch_quest",350)}],[["Ha! You never thought you'd come seeking the help of ol' Derek, did you, Jason?","Truthfully, no. But these are desperate times and the UCP must use every advantage available to it.","Same for the Alberta Freedom Conservative Party. Remember, I've worked with you, studied your strategies. I was the first to support you in your bid to merge with the Wildrose.","Yes, you have been a staunch warrior for Conservatism. The Tory gods have a plan for you.","You bet they do. They need ME to stop not only the radical socialists who've taken over this province, but also YOU, Jason."],1,0,10,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Your party's too vanilla. In trying to please everyone you've created a watered-down movement that doesn't do ENOUGH for conservatives in this province.","Nonetheless, the UCP's bid for power is far stronger than yours.","I'm sorry. Do YOU have a flying pirate ship? Do ya? Huh?","No. But our means of winning power in this province our rooted in pragmatism, not ostentatious displays of conservativism."],1,0,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Ostentatious?! This is about Freedom! Albertans being in control of their own laws instead of being told what to do by dictatorial Emperors in Ottawa hungry to take all our oil for themselves.","*Sigh* Derek, you're tiresome. Tell you what:",[["Get us coffee.",12],["Leave us alone.",13]]],1,0,12],[["When we land in Red Deer. Then I'll consider a place for you on my caucus when the UCP takes power.","Uh...oh my god. I'd do ANYTHING to be in your party again. It's a deal! We're approaching Red Deer now!"],1,1,12,function(){a.f.fildebrandt_launch_quest(!0)}],[["Just...give us some peace and quiet so we can make our plans for Edmonton?","What? N-nobody gets peace and quiet from Derek Fildebrandt! We're landing in Red Deer right now! I'm going on a coffee run for my crew cause I'm a NICE guy and I'm getting NONE for you!"],1,0,13,function(){a.f.fildebrandt_launch_quest(!1)}],[["My crew is ready to depart anytime."],0,0,15],[["Ready to go?",[["Let's go.",16],["Not just yet.",14]]],0,0,15],[["Then we're off!"],0,0,16,function(){a.f.fildebrandt_edmonton_path()}],[["Coffees! I have your coffees! Oh boy, oh boy, here you go!","So, let's talk about ol' Derek's role in the United Conservative Party--"],0,0,23,function(){a.f.fildebrandt_dragonCry()}],[["Jason, before you say anything, no, I don't have your coffees.","And whatever you see on social media, it's not my fault. It's the liberals'."],0,0,22,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Jason, we have our differences, but you saved my ship and I thank you.","Derek, you can thank me by getting us safely to Edmonton and landing outside the city."],1,0,19,function(){a.f.edmonton_setup_from_airship()}],[["Mmmm. This coffee's delicious. I have my own coffee JUST like I have my own PARTY.","How do you like THEM apples, Jason?"],1,0,20,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Look, before you say anything, no, I don't have coffees for me and my crew because I CHANGED MY MIND.","As a free Albertan, I can do that. Unlike the MLAs in YOUR party, JASON."],1,0,21,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}],[["Whatever, Derek. How far are we from Edmonton?"],0,1,22,function(){return a.f.fildebrandt_dragonCry()}],[["Ooh, it'd better not be taxpayer-funded!","Take everyone below! I will head to the bow and confront Notley's winged beast."],1,0,24,function(){a.f.airship_initFunction_tiles_laydown("launch_dragon_bossFight",220)}],[["MY pirate ship is PRIVATELY OWNED, JUST as it should be."],0,0,24]],"Don Braid":[[["Hi, I'm Don Braid. Political scribe with the Herald. You must be Jason Kenney.","It is I! THE Jason Kenney, scourge to toothless media elites such as yourself.","A touch standoffish, I see. It's no matter. I've been a humble scribe a long time and have seen it all.",[["Tell me the news",1],["You and your cronies think you're so smart...",3]]],1,0,0],[["Well, things are grim, a situation our province's politics currently reflect.","Two fractious parties going toe-to-toe, abandoning the spirit of compromise that characterized our politics only a decade ago.","Albertans were a unified and cohesive people. It helped us win many battles against the Emperors to the east in Ottawa.","I fear, Mr. Kenney, you, too, are a symptom of our current disunity.",[["Yeah, whatever. I'm looking for quests. Just give me the goods.",2],["You and your cronies think you're so smart...",3]]],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Don Braid"),!0)}],[["Certainly. To the west, British Columbia's Chief Warlord John Horgan has been tearing up pipeline projects while to the south rats have returned to the province, led by the ignoble Vermin King.",[["Tell me about the Chief Warlord John Horgan",4],["Tell me about the rats",5],["I've heard enough. We're done here.",7]]],0,0,3],[["Go on.","You opinion elites sitting in your echo chambers can't hear the voices of ordinary people over the din you create.","Uh-huh...","People want a fighter for them and their families, not be lectured by know-it-alls.","Hmm...","But the truth is we're winning and YOU in the MEDIA were against me and had it wrong from the start. So THERE."],1,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Don Braid"),!0)}],[["John Horgan, like our province's Queen, is of the NDP party. Many moons past, the two fought alongside one another in the name of the environment, but no more.","In a bid to maintain power in Alberta in the face of the united conservative movement you lead, Jason, Queen Notley has had to aggressively pursue a pro-pipeline policy.","The expansion of the Kinder Morgan pipeline from Alberta to British Columbia's coast was to be her signature accomplishment on the energy file...","...but opposition to the project in our neighbouring province has led Warlord Horgan to act against it.","Now he leads a band of marauders through the mountains laying waste to pipeline projects wherever he can find them. It's brought chaos and destruction to Alberta."],0,0,9,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Don Braid"),!0)}],[["As you well know, Alberta has been rat-free since the 1950s when the province developed a program to monitor the rat population spreading from the east.","Its success is inarguable proof of Alberta's ingenuity, but global forces being what they are, a new population has found its way into the province.","Led by the Vermin King, his rat army have infested the lands to Calgary's east.","The king himself takes refuge inside a cave, the keys to which are hidden on his rat minions.","Purging Alberta of this menace would restore our province's pride in being rat-free."],0,0,11,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Don Braid"),!0)}],[["So there indeed! Your posturing is to be commended, Sir Kenney!","Thank you.","Is there anything else I can help you with?"[["No. I have more voters to win over. I'm off.",7]]],0,0,6],[["Good day to you."],0,0,8],[["Mr. Kenney. You've returned to gloat more or do you seek information?",[["Yeah, uh...have you got any news for me?",1],["No. I have more voters to win over. I'm off.",7]]],0,0,9],[["Have we as a province not suffered enough? The time is right for strong leadership.","Say what you will, Jason, Queen Notley's purchase of the pipeline was bold and went a long way to ensure the project would go ahead.","Yes, but, uh... it's far from being a 'fait accompli.' Only a true LEADER can deliver the pipeline and that leader is ME.","Okay, Jason. I don't doubt it. Good luck to you."],1,1,10,function(){a.game.npcFunctions.donBraid_pipeline_switchout(),a.game.player.addQuest("kq-q-pipeline")}],[["Good luck to you, Jason."],0,0,10],[["This sounds like exactly the kind of problem the winds of destiny carried me here to solve.","That's a unique take, Jason. Good luck to you."],1,1,10,function(){a.game.npcFunctions.donBraid_ratKing_switchout(),a.game.player.addQuest("kq-q-ratking")}]],"Dale the Intern":[[["Don't mind me. I'm just the intern. Uh, I don't actually know anyone here."],0,0,0]],"Brad Wall":[[["Jason, amigo! Hail to the Invisible Hand!","The Hand! How are you, Brad?","Oh, as well as any popular former Saskatchewan premier now working as an advisor to a posh lawfirm in Alberta's energy and agriculture sectors can be."],1,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Brad Wall"),!0)}],[["Which is say to say, 'Pretty darn good, Jason. Pretty darn good.'","The only bee in my bonnet is this blasted carbon tax Queen Notley and Emperor Trudeau are working to impose. It's not right."],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Brad Wall"),!0)}],[["*Chuckles* It's misguided, to say the least. And most displeasing to the Hand!","Most indeed! My clients are seething. Something must be done.",[["I see an opportunity for my firm leadership.",3],["What are the other province's leaders planning?",4]]],1,1,2],[["Trudeau and Notley are wielding dark magicks  also known as progressive trickery  to draw carbon from the air at the expense of taxpayers and business.","Jason, are you familiar with the sorcery that is the Great Tree of Carbon Taxation?",[["No. Tell me more.",5],["*Pfft* Of course!",6]]],0,0,2],[["Doug Ford, Grand Duke of Ontario, and my successor in Saskatchewan, Scott Moe, have taken the lead in opposing the tax.","Together the seek the source of the magick, the Great Tree of Carbon Taxation. Have you heard of it?",[["No. Tell me more.",5],["*Pfft* Of course!",7]]],0,0,2],[["Ages ago (around 2007), Alberta became the first realm throughout the whole of this mighty continent to plant the seeds of the Carbon Tax Tree deep in the Enchanted Forest of Regulations.","Its roots spread quickly, leading both the federal Liberal and Conservative parties to campaign on the carbon tax.","But it was always folly. My government in Saskatchewan developed a plan at the behest of special interests, but fought tooth and nail against implementing it.","Since then, conservative opinion has turned against cap and trade. Think of the oil and gas industry! The jobs!"],0,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Brad Wall"),!0)}],[["Oh, I know. I know!","The tree must come down. Principled conservatives MUST axe that tax!"],1,1,7,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Brad Wall"),!0)}],[["Brad, my friend, leave it to me. I will seek out the tree in the Enchanted Forest and bring it toppling to the ground.","I believe it will open the way for my victory over the NDP and its nefarious anti-market ways."],0,1,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Brad Wall"),!0)}],[["Go, Jason. The taxpayers and my well-heeled energy and agriculture industry clients are counting on you."],1,0,8,function(){a.game.npcFunctions.carbontree_quest_setup(),a.game.player.addQuest("kq-q-carbontree")}],[["Jason! My sources tell me you have big things planned."],0,0,9]],"Paula Simons":[[["Hi, there. I'm Paula Simons, columnist for Ye Journale of Edmonton. I put quill to parchment on matters ranging from municipal and provincial affairs, to culture and the city's history.","Is there something I can help you with?"],0,0,23,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Ah, Edmonton! What a beautiful city. First incorporated as a town in 1892, it became Alberta's capital at the province's formation. It's always been a big centre for labour activity, as the NDP's strength here attests.",[["What is the source of Edmonton's power?",5],["I wish to crush the socialists!",4],["Tell me about the NDP",2],["Tell me about the UCP",3]]],1,0,1],[["The NDP's prolonged period on the fringe of Alberta politics ended in 2015, when voters swept them into power. This was fitting, given Alberta was the NDP's birthplace and they'd never governed here provincially.","There is speculation they were carried to power by prophecy, one foretold in the ancient scriptures of Alexander Rutherford, the province's first premier and reputed forger of the Crystals of Confederation.","One such passage reads, 'Lo! When the governing institutions of this province have grown laggard and corrupt, from its heartland will rise a chinook so great as to lift the veil of democratic incontinence and let shine the sun on a new age.'","Were the scriptures referring to a new age under the NDP or a reuniting of the conservatives? Like many ancient texts, it's impossible to know for certain.",[["Definitely refers to conservatives reuniting",11],["Tell me about Edmonton",1],["Tell me about the UCP",3]]],0,0,0],[["The United Conservative Party is the major contender to Alberta's crown. Feelings on them throughout the province are mixed, with skeptics questioning whether the bickering strands of conservatism can truly remain united, especially if they take power from the NDP.","After all, without the common animus of a socialist party in power, have the oft-differing conservative parties of Alberta have anything else to unite them beyond sputtering outrage?",[["*Pfft* Yes. A brilliant leader!",12],["Tell me about the NDP",2],["Tell me about Edmonton",1]]],0,0,0],[["Oh my! Well, I suggest you calm down. But, yes, there are many, both progressives and conservatives, who are fed up with them, just as is so often the case at this point in a government's lifespan.","While the labour constituency has remained ardently on the NDP's side, the party under Queen Notley has alienated many other progressive groups over its support of pipeline construction. But, such are the tumultuous fortunes of politics.",[["What is the source of Edmonton's power?",5],["Tell me about the NDP",2],["Tell me about the UCP",3]]],0,0,0],[["An intriguing question! If you believe the story of the Crystals of Confederation, you'd probably say its source emanates from the Crystal of Edmonton, formed from the mighty battle between the city and the former town of Strathcona, and now lost to time.",[["What might guide me to this crystal?",6],["What else can you tell me?",7]]],0,0,0],[["You mean if we continued this hypothetical line of query? Well, I'd say you'd need an artifact so revered by Edmontonians as to be embued with its civic spirit. Like, say, a well-loved Oilers jersey.","If the tales are to be believed, Edmontonians have long sworn breathlessly of the power wearing their team's sports jersey has imparted them with.","Though I'm not a particularly sporty girl, so it's not something I'd be caught dead wearing.","I like to speak my mind, but I'll be the first to admit I don't speak for everyone.",[["I require such a jersey!",9],["What else can you tell me?",7]]],0,0,0],[["Well, Edmontonians love their foodtrucks. It's like they say: 'The way to a person's heart is through his or her stomach.'","I'd wager a good portion of Edmontionans' strength  and by that I mean nutrition  comes from green onion cakes.","In fact, they're beloved enough to make any Albertan politician give up everything, even cross the floor, for one!","Rumour has it Danielle Smith was bribed over to the Progressive Conservatives from the Wildrose with just a single one!"],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Thank you for the advice, squishy-liberal-though-pipeline-supporting citizen.","I prefer 'reasonably greenish,' and you're welcome."],1,1,25,function(){a.f.edmonton_addFrontGateTileData()}],[["Ah ha! I understand the proprieter of the marijuana shop across the way keeps one on display. It's his pride and joy!","I can only imagine what unspeakable things he'd ask you to do for it...","Totes kidding!"],0,0,10,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Thank you for the advice, squishy-liberal-though-pipeline-supporting citizen.","I prefer 'reasonably greenish,' and you're welcome."],1,1,27,function(){var e=a.game.actions.getCharacter("Clare");e.data.dI=1,a.game.dialogue.initDialogue(null,e,!1)}],[["I imagine only time will tell. But I have to admit the NDP is vulnerable. And while I don't buy the common notion that Alberta is a naturally conservative province, the UCP is making fast progress.","Outside of Edmonton -- dear Edmonton! -- the NDP is most vulnerable.",[["Tell me about those vulnerabilities",19],["I wish to crush the socialists!",4]]],0,0,11],[["The free market is the single source of Truth and the Invisible Hand is Its shepherd. Only the UCP honours the Hand's wisdom.","The UCP talks a big game on the free market, making a great show of genuflecting before the Invisible Hand."],1,1,13,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["In practice, however, they adhere to the free market mostly when it suits them, like any political party.",[["That's just not true!",14],["Keenly observed, scribe.",15]]],1,0,0],[["Is that so? I don't see them giving up on their support for subsidies to the energy industry, do you?",[["It's the will of the Hand!",16],["Keenly observed, scribe.",15]]],1,0,0],[["Thank you. It's worth adding that the governing NDP have been more free-market about cannabis consumption than anywhere else in Canada.","The same laws for smoking a cigarette apply to cannabis here.",[["The NDP is dangerous",16],["Tell me about the NDP",2],["Tell me about Edmonton",1]]],0,0,0],[["The NDP curries favour with dangerous groups. They hold hostage the Invisible Hand itself and know no other power than the flow of foreign money to their ideological causes!","Their depravity is covered at length by the Sun newspapers and other especially litigous digital outlets I shall not name."],0,1,17,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["*Sigh* The freedom in our society to choose what we read is a wonderful thing.","And if that's your attitude, you may be better off talking to (well guy) who guards the well outside.","Funny man. Stridently anti-NDP."],0,0,18,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Ah ha! This individual sounds like a valuable ally. Thank you for your time, progressive citizen.","It is my humble duty."],1,1,25,function(){a.f.edmonton_talkToNoah(2)}],[["Why, I suggest you read my columns! Or, better yet, take out a subscription with our fair newspaper.","They're good for more than just wrapping artisanally crafted food from farmer's markets, after all.",[["Ba ha ha ha!",20],["What about personal vulnerabilities?",21]]],0,0,0],[["Say what you will about print, but, without a doubt in this case, the old school is best the school","I get my news for free off the Internet, thanks... Or from the Sun."],1,0,18,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["What about vulnerabilities of a ... personal nature?","That's an odd question! If you're looking to do physical harm, I'm afraid I can be of no help."],1,1,0,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["But if you seek a richer and ... more poetic ... understanding of our province's political soul, there's a lot to be found in the ancient wisdom of finding the way to a person's heart through his or her stomach.","It's my sincerest belief that the richness and variety of foodtrucks in our city is directly related to the inclinations of our province's politicians. The free market notwithstanding."],0,0,10,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Yes. I was sent your way by an anti-pipeline activist who claims you are a font of knowledge about Edmonton.","Ah, yes. I imagine that they're quite disappointed in me, seeing as I support pipeline construction."],1,1,24,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["I'm a squishy progressive so they understandably assumed I'd be on their side in that whole debate. But what can I say? I'm an Albertan.","Anyway, what knowledge do you seek from me?",[["Tell me about Edmonton",1],["Tell me about the NDP",2],["Tell me about the UCP",3]]],0,0,0],[["I trust you're using the knowledge I imparted on you wisely."],0,0,25],[["I do apologise, but I'm busy at present. These op-eds won't write themselves, unfortunately!"],0,0,26],[["Ah! What you call body odour, Clare, I call civic pride!","So what do you say? Do you want it?",[["I'll take it!",28],["Not a chance!",29]]],0,0,27],[["Ha ha! The power is mine!","That's the spirit! Welcome to your first day of being a full-fledged Edmontonion!"],1,1,25,function(){a.f.edmonton_jerseyAcquireFromSimons()}],[["That's a perfectly reasonable answer.","But if you don't mind, maybe talk to Noah outside by the well? He may want it and it would serve as a peace offering of sorts between us and him."],0,0,25,function(){a.f.edmonton_talkToNoah(4)}],[["Wowie! What a battle!","The NDP and UCP armies arrived at Red Deer  the convention capital of Alberta!  arrayed in mighty phalanxes, the sun glinting off polished chrome and steel.","Never did Alberta see anything more gallant, spruce, brilliant or well disposed as the two armies. Pickup truck horns and fifes made music such as Hell itself never heard.","As the mighty conflagration played out, the NDP succumbed to the united might of the conservative army, just as pollsters and pundits alike had predicted leading into the conflict. Soon, the NDP were pushed back to Edmonton, but they were not out!","NDP units in ridings across the province had yet to succumb to the full might of the UCP. By the time the conservative army had reached Edmonton, it will still uncertain who would win the day.","And so the battle raged on. As Kenney made his way to claim his prize at the feet of the Alberta Legislature, Queen Notley awaited him, readying herself for the opportunity to destroy the Invisible Hand...","...before the very person who'd returned to Alberta claiming to be its one, natural defender.","This is Paula Simon for Ye Journale of Edmonton, signing off!"],0,0,30,function(){a.game.mapWorld.changeStage(null,{targetMap:"kq02-battle-01",targetPosition:"284,1794"},a.f.finalBattle_talkToSoldier)}]],"Ravi, Leader of all Millennials":[[["What is UP, guys? It's Ravi here, comin' atcha from Edmonton, City of Champiooooooons!","*Airhorn* [Breeeeoooooo! Breeoo-breeooo-breeooo!]","Oh my God, you guys. I have with me here some peeps who JUST EMERGED from my friggin' basement. Like, what's up with that?!"],0,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["What is UP, guys? It's Ravi here, comin' atcha from Edmonton, City of Champiooooooons!","*Airhorn* [Breeeeoooooo! Breeoo-breeooo-breeooo!]","Oh my God, you guys. I've got CUSTOMERS!","Of course, not hard to find those at a marijuana retailer's these days, is it?"],0,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["You're back! But you've got only one thing I asked for.","Look, I'm a chill dude, but you could've done better.","Lucky for you, I'm into poke bowls and oatmeal now. Gotta keep with what's trending.","Here's your jersey. Wearing it will guide you to the source of Edmonton's power.","Just do a better job looking for whatever it is you're after than you did getting me my lunch, 'k?"],0,0,5,function(){a.f.avocadoToast_removeToast()}],[["You're back! But you've only got a couple of the things I asked for.","Whatever. I'm a chill dude. Here's your jersey. Wearing it will guide you to the source of Edmonton's power, blah blah blah...."],0,0,5,function(){a.f.avocadoToast_removeToast()}],[["Welcome back! And you have everything I asked for!","I've gotta Instagram this bad boy. But first, as promised, here's your jersey.","Wear it and Edmontonians will rally around you, no matter what. Such is the magic embued in my well-loved jersey."],0,0,5,function(){a.f.avocadoToast_removeToast()}],[["Good luck on your quest! I'm reading a Reddit thread that lists all the potential outcomes.","But no spoilers! Ravi out!"],0,0,30],[["Hey guys! What is UP?","Are...you talking to us?","Heh. Yeah! You here to buy? I'm an independent retailer, licensed to sell the herb, the merch. You name it!","Why are you on a camera?","I've got my 24-hour personal diary vlog going on. This right here is how I sell cannabis CULTURE!"],1,0,7,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["Ganja's the new bitumin, baby, and I get MY product to market via broadband. No heavy infrastructure, just views and likes that carry my goods all the way to the consumer and their dollars back to me.","It's about PERSONALITY. It's about TRUST. That's what I'm SELLING. Now what are you BUYING?","We're not here to buy anything...","BROWSING? Okay! Super cool. Talk to me if you have any questions.",[["Just who...what...are you?",11],["I seek the source of Edmonton's power!",10],["None. Goodbye.",8]]],0,0,8,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["Laters."],0,0,9],[["So...what is UP?",[["Just who...what...are you?",11],["I seek the source of Edmonton's power!",10],["Nothing. Goodbye.",8]]],0,0,0],[["The source of Edmonton's power? Like, the lost Crystals of Confederation? There's, like, this one, big Reddit thread all about it.","How could this be?","Yo, this one guy, cattleman6996, has this theory the Crystal of Edmonton is hidden right here in the city in a place that should be obvious, but it's not.",[["How would I locate this crystal?",16],["Just who...what...are you?",11]]],1,0,0],[["I'm Ravi, Leader of all Millennials. My name's right there, in the dialogue window you're reading right now.","What are you talking about?","I'm just breaking the fourth wall. That's right! I see through the media paradigm."],1,0,21,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["Uh-huh? WELL. Right here in the Reddit thread on Kenney's Quest Episode 2, ableg_grrrrl writes that you're Jason Kenney in disguise come to Edmonton seeking one of the Crystals of Confederation. Is that right?","Wait. Yes, but...","So what you want from me is a means of finding one such crystal and I HAPPEN to have an enchanted Oilers jersey that will take you right to one."],1,0,13,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["HOWEVER, THIS decision tree only takes you to the Crystal of Edmonton.","Decision tree? What sorcery is this? Trees are for logging and the creation of jobs!","Hold up! This tree doesn't take you to the other crystal: the one you steal."],1,0,22,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["Try some of this Bubblegum Sundae strain. Or better, the Horseradish Garden Party. It's a kush. Very smooth.","Smoke a little bit of that and you'll understand everything. I mean EVERYTHING.","The cosmic matrix of decision trees that forms our unconscious universe...","The player of this game, whose guiding hand is responsible for the constant limiting and expansion of our horizon of possibilities. That's the REAL Invisible Hand, man...","...the real Invisible Hand..."],1,0,23,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["It's whacko theories like yours that are besieging our nation's Christian patrimony. I'll have none of it!","Call it what you will, but things are changing. You gotta expand your mind, son. I've got this indica with a THC level through the roof that'll do just the thing...",[["I want thy jersey!",16],["The only expansion that matters is the market's.",24]]],1,1,0],[["The long lost, no-one's-ever-found-before crystals? THOSE ones?","Totes! You'd need to channel the spirit of the city, as emboadied in an echanted item of some sort.","As it so happens, my old Oilers jersey will do just that.",[["I want thy jersey!",20],["Why don't you use it?",17]]],0,0,0],[["I'm a business owner! I don't have time for treasure hunting!","Besides, harnessing mythical forms of power is a politician's game. I've got the REAL power in my hands: likes."],0,0,25,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["You'll be back. It's *air quotes* 'destiny'."],0,0,19],[["I knew you'd be back.",[["I want thy jersey!",20],["I'm not actually talking to you.",18]]],0,0,0],[["Ah! You ARE here for something. Let's barter.","Very well. What would you--","Go get me lunch.","What? Is that...all?","Yep. I don't ask for much in this world. I'm a simple man who pays his taxes and who's happy to be pay more for the public benefit."],1,0,26,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["It's what I do. I'm a millennial! A thought-leader. A Ted-Xer.","I'm an independent business owner, a hyphenated Canadian AND a member of the next generation of Albertans.","Boom! Blew your mind.",[["It's a liberal media paradigm!",12],["I seek the source of Edmonton's power!",16]]],0,0,0],[["So YOU have to decide whether you want to retrieve the Crystal of Edmonton or take the other quest shown on this map.","THAT quest will lead you along the tree that offers a greater number of possibilities for the completion of your quest. Got that?",[["I'm very confused.",14],["This is nonsense.",15],["I want thy jersey!",20]]],0,0,0],[["Ha! The only cosmic force that matters is the market. And the Hand, its wise shepherd.","Whatever you say. Try the kush?",[["I want thy jersey!",20],["No, thanks. I'm off.",18]]],1,1,0],[["After all, what more is there to life than honest work and family values? The Hand gives its blessing to those who live by both.","Uh-huh. So you'll try the indica?",[["I want thy jersey!",20],["Never! I'm off.",18]]],1,1,0],[["Then give me thy jersey, boy!"],0,1,20,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["But your boy's gotta eat! I want avocado toast, the meal of my people.","Get it with the works: eggs, bacon and Sriracha, the hotsauce of my...","Say it!"],0,0,27,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["...People?","You got it! Come back here when you've got that or, y'know, whatever you manage to find. No big."],1,1,28,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Ravi, Leader of all Millennials"),!1)}],[["Then -- and ONLY then -- is the jersey that will lead you to near limitless power yours.","Now, be off!"],0,0,29,function(){a.f.takeEdmontonQuest("kq-q-avocadotoast")}],[["Get me lunch and the jersey's yours."],0,0,29],[["Ravi out!"],0,0,30]],"Brewpub Owner":[[["Yes, sir! The beers we brew here are better than anything and everything they offer in Calgary."],0,0,0],[["My good man! I seek the fabled avocado toast -- the object of my demographic's fever dreams.","Irony! Welcome to my establishment, fellow millennial!","I am indeed one of you.","Avocado toast coming right up. Try a free sample while you wait. I insist.","Well, I ","Come on. It's free. You're willing to go broke for this stuff ... aren't you?","Why ... well, yes, of course..."],1,1,0,function(){a.f.avocadoToast_buttonMashChallenge()}]],Seimah:[[["Jason Kenney's UCP is botulism incarnate."],0,0,0]],"Priest of the Invisible Hand":[[["From the Scriptures of Rutherford, we sing..."],0,0,0]],Cow:[[["Moo."],0,0,0]],"Priestess of the Invisible Hand":[[["Lo! Unto Albertans comes a boom in oil prices that brings with it great value to home properties and employment salaries!"],0,0,0]],"Doug Ford":[[["Jason! *Huff* *Wheeze*. Jason, ol' buddy, wait up!","Oh. *Rolls eyes* Hello, Doug.","I'd heard from a lot of folks you were headed out this way to take down that f$&*@ing Carbon Tax Tree and I knew I needed to help.","*Grimacing* Yeah. Well. Just stand beside me and smile.","Let's ally ourselves. You go on ahead. I've got my Escalade parked nearby. If you need help just holler.","Uh-huh. THANKS, Doug..."],1,0,1],[["Jason! I've heard from folks here in Alberta that I am the ONLY Ontarian they'd be happy to have come here and tell them what to do.","And there's nothing I love more than telling people what to do!","Now go cut us down that carbon tree!"],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!0)}],[["Now go cut us down that carbon tree!"],0,1,3],[[["I'll just be in my Escalade reading the Sun."]],0,1,2],[["Dammit. I'll get the Sun to write something up for me."],0,0,4],[["Jason! Jason! *Huff* *Puff* Wait up, buddy!","Ow! My knees..."],0,0,6,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!0)}],[["*Sigh* Doug, you're...still here.","I wouldn't miss a chance to take a swipe at Trudeau, you know what I mean?","Yeah, yeah...","Oof! Big tree! It'll look good as bbq fuel at my next Fordfest. Whaddaya think of THAT, Jason!","Whatever...","So...what are we gonna do about it?"],1,1,6,function(){var e=a.game.actions.getCharacter("Doug Ford"),t=a.game.player.hasItem("axe")?7:8;e.data.dI=t,a.game.dialogue.initDialogue(null,e,!0)}],[["The conservative GODS  who speak to ME, Doug. ME!  led me to the location of the mythical Great Carbon Tax Axe, which I now hold in my possession.","It is a uniquely powerful magical item forged specifically to fell this BLIGHT upon free-market values.","And I will be the one to wield it. Here goes!"],0,1,9,function(){a.f.greatTree_removeTree(10)}],[["I...I don't actually know.","Ba ha ha. BA HA HA HA!"],0,1,9,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!0)}],[["I've got one of my lackies waiting in my Escalade just outside the forest.","We're gonna hitch that puppy up to this tree and bring 'er crashing down!'","Folks'll LOVE it! I'm calling up the Sun right now to give 'em an exclusive about how ol' Dougie gave a finishing right-hook to the carbon tax."],1,0,11,function(){a.f.greatTree_dougRunsOff()}],[["This...is a good day for democracy.","Hoo hoo! Lame-o Justin's going to be so mad!"],1,1,11,function(){return a.f.call_calgary_scrum("kenney")}],[["Ugh. At least I recovered the crystal...","Hoo hoo! Lame-o Justin's going to be so mad!"],1,1,12,function(){a.f.call_calgary_scrum("ford")}],[["As I pledged during my campaign for Grand Duke of Ontario, I and, uh, Jason here...","... have cleared the Enchanted Forest of Regulations of the hated Carbon Tax Tree.","The tree was THE WORST magical enchantment Canada could ever have.","Folks, Ford Nation made a promise, and Ford Nation, as always, has delivered.","Did you get that, you CBC hacks?"],0,0,13,function(){var e=a.game.actions.getCharacter("CBC Reporter");e.data.dI=2,a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["Thank you! Thank you! No more questions."],0,0,14,function(){var e=a.game.actions.getCharacter("Other Reporter");a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["No more questions! I'm in charge!"],0,0,15,function(){var e=a.game.actions.getCharacter("Other Reporter");a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["Don't you twerps get it? I'M IN CHARGE!!","Minions! Silence the media at once."],0,0,15,function(){a.f.ford_exits_scrum()}],[["Outta my way, Jason. Let a pro handle this.","Folks, I am a MAN. And guys like Jason here want to be like me.","So when I stood up to the elites in my own party and convinced them to reverse their commitments to this job-killing enchantment, Alberta's conservatives...","...who recognise me as a champion of their industries and jobs, but first and foremost as a MAN,...","...Alberta's conservatives told me they wanted me in their corner. ME. A REAL MAN!","That's it for questions. I'm in charge. Everyone do what I say."],0,0,17,function(){a.f.ford_exits_scrum()}]],"Other Reporter":[[["Mr. Ford! Legal opinion finds the Supreme Court will likely side with Ottawa on imposing the carbon tax enchantment in absence of the tree.","Do you care to comment?"],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!1,null,!0)}],[["But, Mr. Ford --"],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!1,null,!0)}]],"CBC Reporter":[[["Sir Kenney. Your messaging on carbon enchantments bas been unclear.","You've said you, in fact, SUPPORT an enchantment, just one implemented differently from what Queen Notley's NDP has done?"],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("CBC Reporter"),!1)}],[["I'm not opposed, in principle, to enchanting major emitters with a spell requiring they pay more...","Like the Specified Gas Emitters Regulation? You've said you'd prefer it yet it also requires industry to pay for emissions, so can you clarify?","Look, the Enchanted Forest of Regulations is deep, dark and full of trees. Let's not lose ourselves amongst them..."],1,1,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!1,null,!0)}],[["Mr.Ford! Legal experts have indicated the federal government has the authority to IMPOSE the carbon tax enchantment on the entire Dominion, despite your having felled the tree.","Do you intend to spend deeply in a battle against Emperor Trudeau that you may already have lost?"],0,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!1,null,!0)}]],"The Invisible Hand":[[["At last, Hand, you are my prisoner.","You have been the source of previous Albertan governments' ideological recklessness. In their worship of you, they left stewardship of Alberta's economy in your power.","But time and again, you've failed Albertans. Unquestioning belief in your vagaries brought suffering to this province's people. But no more.","I will bring this economy under control through diversification and regulation, but not before I destroy you."],0,1,1,function(){var e=a.game.enemyGroup.children[a.game.enemyGroup.children.length-1];e.data.dI=1,a.game.dialogue.initDialogue(null,e,!1,null,!0)}],[["ROAR!! THE MARKET WILL NOT STAND FOR THIS! I WILL PUNISH ALBERTA WITH INDISCRIMINATE POVERTY FOR GENERATIONS TO COME!","The days of Alberta being subject to your whims are over, Hand. Only Jason Kenney now stands between Albertans and a better future. But the NDP's vision will prevail."],1,0,1,function(){a.f.kenneyReturn_beginQuest_changeStageCall()}],[["ROAR! You puny mortals have defied the Hand!","For your arrogance, I will make Alberta suffer a market downturn so great as to take its economy back 200 hundred years!"],1,0,3,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:3,character:"The Invisible Hand"}},!1)}],[["No! Oh, glorious Hand! That is --","SILENCE!"],1,1,4,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:4,character:"The Invisible Hand"}},!1)}],[["That is the will of the Hand to which you have pledged your faith, mortal!","From now on, Albertan liquor stores will stock nothing but second-rate ross from Ontario."],1,0,5,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:5,character:"The Invisible Hand"}},!1)}],[["Nono!","Albertans will drive only Pontiac Aztecs. Prices for synthetic crude will plummet! Taxes will soar!","Gah! No! *sob*"],1,1,6,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:6,character:"The Invisible Hand"}},!1)}],[["The Hand! Why have you foresaken us?","The market will not controlled by mere mortals. Government revenues will not be diversified. Only unbridled faith in my will can rule Alberta for I am its Master!"],1,1,7,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:7,character:"The Invisible Hand"}},!1)}],[["Conservative might alone will not defeat the Hand. I must use my sword forged from the crystals of confederation. But is it enough to defeat you, Hand?","I have no choice but to find out..."],1,1,8,function(){a.game.dialogue.initDialogue(null,{data:{name:"The Invisible Hand",dI:8,character:"The Invisible Hand"}},!1)}],[["HAVE AT THEE, PEASANT!"],0,0,9,function(){a.f.finalBoss_endCutscene()}]],"Leela Aheer":[[["Sir Kenney! Uniter of Alberta's Right!","Vanquisher of government overreach!","Slayer of deficits!","What is it you would ask of this faithful candidate?"],0,0,1,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Leela Aheer"),!1)}],[["Leela, my FAVOURITE candidate for Chestermere-Strathmore. It was a bitter fight to secure your place in that riding, but the effort was worth it.","I'm humbled and grateful, my liege.",[["I am on a quest.",2],["You've been instrumental.",5]]],1,1,2],[["What would that be?","I am on a quest to recover the lost Crystals of Confederation. Keep it secret.","Jason, after you placed so much confidence in me I would never betray you."],1,0,5],[["I may have the stature of a mouse, but I carry in me the soul of a lioness, Sir, Kenney, Sir!"],1,0,3,function(){var e=a.game.actions.getCharacter("Stephen Harper");e.data.dI=11,a.game.dialogue.initDialogue(null,e,!1)}],[["I will serve you when the battle comes, my liege!"],0,0,4],[["Leela, you've been instrumental in building our party into one of the most popular political parties in Canada.","Shucks. Go on.","I mean it! And, my goodness, do we need women representatives in our party.","Ha ha. Yeah...yeah, we do.","Oh, yes! Do we ever.","*sigh* Yeah... Do. We. Ever.","I mean, we have only two female MLAs in the party!","It's absurd.","And the NDP have, like, over 50% female representation in its cabinet.","Mm-hmm.","But we can't compromise on our principle of MERIT over an ideological feminist agenda.","Of course not.","Leela, I'm glad you agree.","Agreeing with you is what we UCP MLAs do, my liege.","Very good! Carry on, Leela. Glory to the Hand!"],1,1,4],[["Let us go forth and conquer, my liege!"],0,0,6],[["Let us don our disguises. For Edmonton is a dangerous place and it's imperative we Conservatives blend in."],0,1,7,function(){a.f.edmonton_initDisguises()}],[["Ugh. I smell like a thrift store."],0,0,8],[["Leela! I sense a pull from the jersey.","Are you sure there aren't any rats nesting in there?","Nay! Come, let's dig up the ground here."],1,1,10,function(){a.f.edmonton_crystal_uncovery()}],[["Well, we've got the crystal. Let's go!"],0,1,10,function(){a.f.edmonton_crystal_escape()}],[["Hey"],0,0,11],[["I admit I have no clue what to do with this thing.","Is social license even a thing?","Never mind. It obviously has some form of power alien to conservatives. Let us make haste back to Calgary, and commence with our siege!"],1,1,12,function(){a.f.edmonton_crystal_escape()}],[["Sir, we ought to go.","But I hear whisperings of a wise woman named Paula Simons over at ye Journale of Edmonton who possesses great knowledge of the city.","Let us seek her out."],0,0,14,function(){a.f.edmonton_setPaulaQuestNode()}],[["Let us seek out the wise woman Paula Simons."],0,0,14],[["If you had a moustache, now would be the perfect time to twirl it, sir."],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Look at her. Currying favour to her base through frivolity. Albertan politicians ought to be above such nonesense.","Personally, I feel your bland statesmansip as a leader inspiring, sir.","Thank you, Leela."],1,1,17],[["We must find a way to steal one of the NDP's crystals or uncover a new one.","Where to begin...?"],0,0,17],[["Hark! I feel the jersey's power, Leela. It compels us to seek out the Legislature building to the west.","Onwards, sir!"],1,1,19],[["To the Legislature!"],0,0,19],[["By the Hand! The Crystal of Edmonton is ours, and with it, the hearts of the people of this great city.","Which you don't say to argue against the inherent superiority of Calgary, do you, sir?","Uh, no. No, of course not. Now, let us return there at once!"],1,1,20,function(){a.f.edmonton_crystal_escape()}],[["Is that...Queen Notley's dragon?!"],0,0,0,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Derek Fildebrandt"),!1)}]],Sady:[[["The Alberta Liberal Party isn't out of the running yet. Just you wait."],0,0,0]],Chet:[[["Don't let the fact that we're working in total isolation fool you: The Alberta Liberals are still relevant!"],0,0,0]],"Zain Velji":[[["Queen Notley! Welcome to the Stratejesters, episode fiiiiive-ninety-six. With me, as always, are --","I know! I know! I don't have time for this, jesters. Dispense with your wisdom, if you *ahem* care to call it that."],1,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Carter"),!1)}],[["Despite not having recorded a new episode in two years."],0,0,2,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Carter"),!1,!1,!0)}],[["Guys, the stakes just got pretty high..."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!1)}],[["I'm with Carter on this one. We live in a society that's inherently pluralistic and your average Alberta voter recognizes Kenney for what he is.","Whether that's enough for them to vote against him remains to be seen."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!1)}],[["If I could add something? It's worth pointing out the lip service conservatives have paid to the Hand, even while supporting subsidies for the energy industry.","No government in Alberta has truly ever given 100% of their soul to the Invisible Hand, but it's been in their interest to make great hay of it."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=10,a.game.dialogue.initDialogue(null,e,!1)}],[["But this is what the power of the crystals is all about..."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=11,a.game.dialogue.initDialogue(null,e,!1)}],[["Use your eyes, Carter. There's a giant hand floating in place thanks to a big crystal beneath it. The crystals are real.","And this government's going to use them to eliminate THE VERY THING that has kept Alberta locked in a vicious cycle of boom and bust.","It can only mean a better regulated and predictable economy from here on out."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=13,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["Yes, it is, now that you're making it one!","That's enough, jesters. Answer my other questions:",[["Military strategy.",8],["Countering Jason Kenney.",9],["I've heard enough.",10]]],1,0,0],[["I think Corey wants to answer this one."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=1,a.game.dialogue.initDialogue(null,e,!1)}],[["I think Carter wants to answer this one."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=8,a.game.dialogue.initDialogue(null,e,!1)}],[["Alright! We'll leave it there. That's a wrap on episode 596 of the Stratejesters.","My name is Zain Velji. With me, as always: Stephen Carter, Corey Hogan. And we'll see you next time."],0,0,11],[["NO. There will NOT be an episode 597."],0,0,11],[["Ah-ha. Right you are, Queen Notley.","Guys, you heard her..."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=15,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}]],"Stephen Carter":[[["Well, hello to you, too!"],0,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Corey Hogan"),!1,!1,!0)}],[["All because of Corey.","That's enough! Tell me the answers I seek:",[["Military strategy.",2],["Countering Jason Kenney.",8],["Destroying the Invisible Hand.",9]]],1,0,2],[["What are my options for a full-scale military assault on Jason Kenney's forces?"],1,1,2,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=1,a.game.dialogue.initDialogue(null,e,!1)}],[["No. No, we're not! Corey, we are knowledgeable people who have knowledge on all knowable subjects. That's what we're paid for."],0,0,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Corey Hogan"),!1,!1,!0)}],[["It's not lying. It's called presenting the client with ... a creative narrative!","My instinct is to concentrate my battalions in Calgary's winnable ridings where we have the best support."],1,0,5,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Corey Hogan"),!1,!1,!0)}],[["Your chances in Calgary are slimming the more you ignore the city. Calgarians feel you've forgotten them. My two cents.",[["How have I failed?",6],["I will have you liquidated.",7]]],1,0,5],[["You've been so busy campaigning in Edmonton, Calgary's been almost a second thought. Calgarians don't know you.","Spend more time there personally, and don't just rely on your MLAs.","Overall, your best strategy is to be popular. Once people know and trust you, they'll the do the heavy lifting for you, meaning you won't have to invade.","The ridings will already be yours.",[["Countering Jason Kenney",8],["Destroying the Invisible Hand.",9],["I've heard enough.",16]]],0,0,0],[["Ah, c'mon!","I am a compassionate queen, buy even I have my limits. I have the stocks reserved for you if you fail to provide me relevant counsel."],1,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=2,a.game.dialogue.initDialogue(null,e,!1)}],[["Jason Kenney's a callous opportunist and it's going to get the better of him.","Remember the barbaric cultural practices hotline in the 2015 federal election? Kenney's idea.","He's not openly welcoming racists into his big tent' conservative party, but something's attracting them. Thankfully, in 2015, it cost the federal Conservatives big.","Albertan voters are savvy to the dog whistling and it's a major vulnerability for Kenney as a result."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=6,a.game.dialogue.initDialogue(null,e,!1)}],[["Oh, ho ho! I know Corey wants to answer this one."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=8,a.game.dialogue.initDialogue(null,e,!1)}],[["It's not going to work. Unless you can get Albertans to accept a provincial consumption tax, killing the conservative god will have no effect.","Because as Zain was saying, the Invisible Hand is just something 'free market' Albertans -- or whatever Kenney's calling them -- pay lip service to only."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=5,a.game.dialogue.initDialogue(null,e,!1)}],[["Both the NDP and UCP have denied they're looking for these alleged crystals. I don't know if they're real or not..are they real?",[["Absolutely not.",14],["Yes.",12]]],0,0,0],[["Alright! So I'm wrong. But that's not the point.","The point is..."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=6,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["This isn't a debate about the validity of the crystals..."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=7,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["Ok! I don't know about you guys, but I'm satisfied with that denial. So there are no crystals.","The NDP is f#&@*d. My queen, what you really need is divine intervention from supernatural powers."],0,0,0,function(){var e=a.game.actions.getCharacter("Corey Hogan");e.data.dI=9,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["I'm looking away. I'm not seeing anything!","All I'll say is Calgary's bid for the Global Gladiatorial Games would have brought in a range of different investment opportunities.","It would have been a practicle solution to encouraging diversification of investment in this province. That's it.","You want to destroy the Invisible Hand? There's your alternative.",[["Military strategy.",2],["Countering Jason Kenney.",8],["I've heard enough.",16]]],0,0,0],[["Back to you, Zain."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=10,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}]],"Corey Hogan":[[["That's not the welcome I'd have expected for the podcast voted most favourite by Calgarians in 2018."],0,0,1,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Zain Velji"),!1,!1,!0)}],[["*Cough* We're out of our depth on that one--"],0,0,2,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=3,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["But we can't just lie..."],0,0,3,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Carter"),!1,!1,!0)}],[["You've got to keep your ridings in Calgary. If you can claim the beach heads there, your victory is a minority government.","That's the best outcome. Edmonton's your base. It's locked down, barring some catastrophic invasion by the UCP.","But if you're willing to dedicate resources to the ground fight in Calgary, especially the suburbs, you have a chance."],1,0,4,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Carter"),!1,!1,!0)}],[["So none of your bullshit, Carter.",[["Countering Jason Kenney",5],["Destroying the Invisible Hand.",8],["I've heard enough.",10]]],0,0,0],[["I think Carter's got a lot to say on this subject."],0,0,0,function(){var e=a.game.actions.getCharacter("Stephen Carter");e.data.dI=8,a.game.dialogue.initDialogue(null,e,!1)}],[["Look. I wish he weren't, but Carter's wrong and here's why.","Xenophobia, unfortunately, works. Fear as a motivator has staying power.","I'd like to think Canadians and Albertans voters are above that, but UCP support's been growing in spite of all the UCP shenanigans with racist nominees.","Kenney blows his dog whistle and supporters come a-running."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=3,a.game.dialogue.initDialogue(null,e,!1)}],[["Listen. This is less a campaign about local MLAs than it is about you versus Kenney.","From what I've seen, you've been doing it right: going on hard on Kenney for inviting racists into his party's tent.",[["Military strategy.",1],["Destroying the Invisible Hand.",8],["I've heard enough.",10]]],0,0,0],[["I'm telling ya, destroying the Invisible Hand is the best idea an Albertan government has had for a long time.","Every government has wanted to diversify in order to soften the Invisible Hand's influence but failed. Why? Free market dogma."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["Use your eyes, Carter. There's a giant hand floating in place thanks to a big crystal beneath it.","There's nothing to see over there. Look away."],1,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=12,a.game.dialogue.initDialogue(null,e,!1,!1,!0)}],[["Back to you, Zain."],0,0,0,function(){var e=a.game.actions.getCharacter("Zain Velji");e.data.dI=10,a.game.dialogue.initDialogue(null,e,!1)}]],Nathan:[[["Green justice!"],0,0,1],[["The tar sands are Mordor!"],0,0,0]],Gabby:[[["Greetings, fellow voter in the aged 18-34 demographic! How are you advancing the liberal agenda today?","We're here on behalf of the Order of Gaia and its illustrious leader Tzeporah Berman to protest the Notley government's lies."],1,1,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Notley, the media...the whole Alberta establishment is against safe, responsible stewardship of the environment."],0,0,1],[["Her government's pipeline projects are a slap in the face to the many concerned citizen groups the NDP has previously worked with to ensure safe and responsible development of Alberta's resources.","Instead, Queen Notley has proven herself a Judas to the environment.",[["Tell me about Tzeporah Berman",3],["Tell me about Queen Notley",4],["I seek knowledge about Edmonton",5]]],0,0,2],[["Freedom fighter Tzeporah Berman is the leader of our order. Her conviction as an environmental activist is both celebrated and reviled throughout Canada.","Despite the hatred cast at her, she carries on, undeterred.","Those same people who would silence her from holding an honest discussion about Alberta's energy policies would cry 'foul' over alleged free speech violations everywhere else as though they were free speech's biggest defenders.","If hypocrisy were a deity those alleged 'defenders' would worship at its feet.",[["Tell me about Queen Notley",4],["I seek knowledge about Edmonton",5]]],0,0,3],[["On every front, Queen Notley has abandoned environmentalists, just lately having pulled out of the federal climate plan. What petulance!","The Emperor Trudeau will impose one all the same and she knows that.","We had a lot of hope when the NDP took power in 2015. But she's failed environmental groups, First Nations and Gaia Herself!",[["Tell me about Gaia",6],["Tell me about Tzeporah Berman",3],["Tell me about Emperor Trudeau",7]]],0,0,4],[["Um...ok. Edmonton is Alberta's best city. That's about all you need to know.","I'll add that it's got culture and nature that far surpasses anything you'll find in Calgary...","But your question has nothing to do with our demonstration here. Why are you asking?",[["Exploit the city's weaknesses",11],["Understand the city's greatness",12]]],0,0,5],[["The earth goddess' vengeance will be swift. We ignore her many warnings at our peril.","But those who truly care, not just about Alberta or Canada, but the whole of humanity, put the environment's future ahead of short-term gain from resource extraction.","Our order works to remind people that only collective action will solve global emissions problems. Every nation has to work together.",[["But what about the economy?",13],["I have an idea",10]]],0,0,6],[["Sir Sparkly-Hair himself is no better a friend. He, too, has stabbed group like ours in the back in order to get to the top.","Even though the two appear to be enemies now that TransMountain is delayed, it's all bluster.","They have no choice but to work together behind the scenes. I know how these ELITES in their backrooms work."],0,0,8,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Elites, amiright? Gaia ought to take them all down!","Yeah...Yeah! The whole system's got to go!",[["The UCP has a plan",9],["I have an idea",10]]],1,1,8],[["I hear the UCP has, uh... a PLAN to make our politicans more...uh, accountable...","Ha ha ha ha ha ha ha! You mean to the oil executives!"],1,1,14,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["I bet Gaia would like nothing more than to harm the political fortunes of Queen Notley and Emperor Trudeau.","Yeah? Of course She would!","If we take a picture of the two of them palling around together on stage there it will prove to Albertans how much in cahoots the two are.","Hmm. I've got my phone here. How do you know Emperor Trudeau is around?","He'll be here. He can't resist the smell of adulation."],1,0,23,function(){a.f.edmonton_trudeauNotleyCutscene()}],[["Huh? Are you...from Calgary? You don't look it but I don't like where this is headed.","Go talk to the Edmonton's resident wise woman, Paula Simons, over at ye Journale of Edmonton.","She's pro-pipeline and I don't read trust the lamestream media, anyway. But she knows stuff.","And if you're up to something funny she'll take no guff from you."],0,0,1,function(){a.f.edmonton_setPaulaQuestNode()}],[["Well, to that I say just spend a little time in Calgary and you'll understand!","But seriously, that's a question Edmonton's resident wise woman, Paula Simons, can answer. You'll find her at ye Journale of Edmonton.","Though she's pro-pipeline and I don't read trust the lamestream media, anyway. However, she knows stuff."],0,0,1,function(){a.f.edmonton_setPaulaQuestNode()}],[["Without a healthy environment we risk having no economy to fight for at all. Priorities, man!","I question the precise degree to which there are anthropogenic causes of climate change. We need to consider the range of perspectives on the subject.","That's exactly what groups like our order is doing--","THINK OF EVERYDAY ALBERTANS' JOBS! If we get it wrong, it will do incalculable damage to ordinary peoples' welfare.","But so will environmental dam--","And -- *chuckle* -- newsflash! The climate's been changing since the beginning of time!"],1,0,19,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Go on. You're killing me! Between Notley and that slimeball Jason Kenney, I'll take the devil I know, thanks very much.",[["We're not THAT bad!",15],["Um...Good point",16]]],0,0,14],[["Leftists consistently fail to appreciate how the Hand's cosmic wisdom benefits them!","Ah ha! Another pro-pipeline operative trying to infiltrate our order. Go back to the hole you crawled out of."],1,1,15,function(){var e=a.game.actions.getCompanion();e.data.dI=13,a.game.dialogue.initDialogue(null,e,!1)}],[["Seriously, the only political leaders I trust are the ones working within the system to burn it all to the ground.","Queen Notley and Emperor Trudeau have proven once again that you can't back anyone trying to work from the centre."],0,0,17,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["We're a lot alike. I, too, shun compromise with my enemies.","I know! It would be treasonous tot he cause when so much is on the line."],1,1,18,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["I have to constantly remind myself of my radical roots, especially when I read our local propaganda outlet, ye Journale of Edmonton, and its columnists try and persuade me.","They can almost get me. They're sneaky with their charm and ignorance disguised as common sense.","Paula Simons is the worst. She's so damned REASONABLE and her knowledge of Edmonton is without peer.","I tell ya, if you were trying to exploit the inner workings of the city to achieve your own nefarious ends, Paula's the one who'd know how to do it.","Anyway, enough chit chat. I've got to get back to demonstrating."],0,0,1,function(){a.f.edmonon_setPaulaQuestNode()}],[["This isn't about the beginning of time, this is about human-influenced climate change from CO2 emissions that have the potential to make the planet uninhabitable for us!",[["*Respond deferentially*",20],["*Respond belligerently*",21]]],0,0,19],[["Um...*cough*...I, uh, hear what you're saying. I will not argue with you further.","Hey, I welcome argument. Just come to the showdown armed with reasonable talking points rather than regurgitated one-liners from the Edmonton Sun."],1,1,22,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["CO2 is not pollution! Life would cease to exist without it. Our forests breathe it!","Of course, but not in unchecked volumes.","You need to have more faith in the market to generate solutions. Can I interest you in some literature on the subjects? Adam Smith, perhaps?","What are you? Some kind of politician? Get out of here.","Ha ha. 'Some kind' indeed!","You know, you're as infuriating to talk to as Paula Simons, resident Edmonton expert. You two would hit it off."],1,1,1,function(){a.f.edmonton_setPaulaQuestNode()}],[["My final suggestion to you is, if you're looking for info on Edmonton, talk to Paula Simons over at ye Journale of Edmonton. She's a font of knowledge on the city."],0,0,23,function(){a.f.edmonton_setPaulaQuestNode()}],[["Ha! Got 'em! Sending this out to all my social feeds now...'","Ha ha! *Rubbing hands* Proof of Queen Notley's close relationship to Emperor Trudeau will only strengthen my case before Albertans that she's working more in his interests than their's"],1,0,24,function(){var e=a.game.actions.getCompanion();e.data.dI=15,a.game.dialogue.initDialogue(null,e,!1)}],[["What are you two being all shifty and conniving about?","Uh, celebrating our achievement in the name of Karl Marx, comrade!","You guys realise..."],1,0,25,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)}],[["Nevermind.","Hey, if you're looking for info on Edmonton, the person to talk to is ye Journale of Edmonton's Paula Simons. She's a fountain of knowledge on the city."],0,0,1,function(){a.f.edmonton_setPaulaQuestNode()}]],"Farmer's Market Vendor":[[["Get your locally-sourced, GMO-free meat here! Grown and cured right here in 'berta.","Farmers markets are the future!"],0,0,0],[["Get your locally-sourced, GMO-free meat here! Grown and cured right here in 'berta.","Have you any bacon?","Why, yes, sir! Here you are."],1,0,2,function(){a.f.avocadoToast_acquireBacon()}],[["Humans are carnivores and that's a fact."],0,0,0]],Clare:[[["If I have to eat any more Wok Box I'm going to be sick..."],0,0,0],[["I'm sorry. I overheard you both talking...","There's an old, moldy Oilers jersey that the last person to have this desk left behind.","It smells horrible, but it's yours if you want it."],0,0,2,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Paula Simons"),!1)}],[["Unwashed sports equipment is the stuff of nightmares."],0,0,2]],Noah:[[["Ain't no libs gettin' between me and this here well.","They're crawlin' through this city. In the LRT line, the sewers, the steam tunnels 'neath the ledge'","...LIBS!"],0,0,1],[["No one comes in, no one comes out."],0,0,1],[["Hunh. A lib. I don't talk to the likes of you.","My good man! There are leftists whom you revile offering you a free Oilers jersey in their office over yonder. Might you be interested?","Hmmph. The liberal media finally showing ol' Noah some respect? I suppose I ought to. They owe it to me."],1,0,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Noah"),!1)}],[["I'm going to temporarily step away. DO NOT go down the well!"],0,0,3,function(){a.f.edmonton_createWellEntrance()}],[["Good day, cranky citizen!","Harrumph. Another liberal spouting 'irony.'","*Whispering* I - AM - HERE - FROM - THE - UNITED - CONSERVATIVE - PARTY.","You don't say?","WHAT - CAN - YOU - TELL - ABOUT - GETTING - INSIDE - THE - NDP'S - PALACE?","Say no more, friend! This here well leads directly into their palace. But it's crawling with socialists, like this entire town."],1,1,5,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Noah"),!1)}],[["Tell you what: I'm going to step away from this here well and if you happen to climb inside, I won't have seen a thing.","Thank you, sir. Glory to the Hand!","Oh, my! Yes! The Hand!"],1,0,5,function(){a.f.edmonton_createWellEntrance()}]],Jayshri:[[["The UCP can take its plans for two-tier healthcare and shove it up its ideological rear."],0,0,0]],Bill:[[["Hey hey! Ho ho! Rachel Notley's got to go!","...and make room for another, truly progressive leader!"],0,0,1],[["Let's be real: they're called the 'tar sands.'"],0,0,2],[["Queen Notley sold her soul to the energy industry. She's a progressive JUDAS!"],0,0,0]],"Jagmeet Singh":[[["Love and courage, comrade Notley! I'm so happy we're able to Jag-meet.",[["Solidarity, Grand Commissar.",1],["Love and courage, Grand Commissar.",2]]],0,0,0],[["Solidarity, Grand Commissar. However, you have a funny way of showing it yourself. your public statements on the matter of Alberta's pipelines suggest just the opposite.","Hey, now! You know where I stand on the pipelines. Where I HAVE to stand as leader of a federal party broadly opposed to them.","Which you only gauged after keeping quiet on them for so long. You make an art of opportunism, and a mockery of solidarity, Commissar."],1,1,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Love and Courage, Grand Commissar Singh. Although your public statements on the matter of Alberta's pipelines suggest just the opposite.","Hey, now! You know where I stand on the pipelines. Where I HAVE to stand as leader of a federal party broadly opposed to them.","Which you only gauged after keeping quiet on them for so long. You make an art of opportunism, and a mockery of solidarity, Commissar."],1,1,3,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["But as a compassionate queen, I forgive you for waiting until the political winds had shown you what your principles are.","Listen, you and I need to work together. I hear rumblings of your Alberta NDP breaking with the rest of the party."],1,1,4,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["You know an independent progressive Albertan government would be foolhardy, right?","We have a legacy as NDPers. Mouseland! The Cooperative Commonwalth Federation! Jack Layton's moustache! They all represent something bigger than you or I.",[["I know of no such plans.",5],["It's been discussed.",6]]],0,0,5],[["Rumours in the media, I'm sure. The Alberta NDP is as aligned as ever to the goals of the rest of the party. We defend working families.","Does social justice not mean fair, dignified work for everyone? And does that not mean the pipeline's construction is a legitimate endeavour according to our party's principles?"],0,1,7,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Not in any serious way. But the rumours have been helpful.","Queen Notley, the NDP is embattled on all levels. Right-wing ethno-nationalism is resurgent globally. Solidarity! "],1,1,8,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Comrade Notley, you and I both know that can't come at the cost of our ideals.","What about at the cost of actually getting elected?","Come now. That's not the NDP way! Soldarity!"],1,0,8,function(){return a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Solidarity means supporting your NDP governments in power, not placing their leaders' heads before the chopping block.","Albertans are asking what the point of supporting me is when I can't get the leader of my own federal party to support me!"],0,1,9,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Jagmeet Singh"),!1)}],[["Look, I understand your predicament. But for the rest of the party, I'm asking you to go along to get along.","Here, I've invited John Horgan here so you two can bury the hatchet and we can move forward together as one party."],0,0,10,function(){a.f.ndp_palace_02_horganEnters()}],[["Ok, comrades. Shake hands and agree to Jag-meet one another halfway. C'mon!",[["Shake hands.",11],["Refuse.",12]]],0,0,0],[["Very well. I recognize that concessions with one another are required..."],0,1,13,function(){var e=a.game.actions.getCharacter("John Horgan");e.data.dI=22,a.game.dialogue.initDialogue(null,e,!1)}],[["No."],0,1,14,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!1)}],[["SO glad we were able to have this discussion!"],0,0,13],[["I'm not going to force you to do anything, but I encourage you to think of the whole of the NDP, not just its parts."],0,0,14],[["Comrade Notley! Comrade Notley!","*Pant* Uh, huh huh. Hoo-yee. Hi! I've been waiting to meet with you.",[["Solidarity, Grand Commissar.",1],["Love and courage, Grand Commissar.",2]]],0,0,15]]}}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NpcFunctions=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(a(13),a(30)),r=a(32),s=a(17),l=a(3),h=a(10),c=a(31),u=a(52),d=a(37),g=a(2),m=a(21),p=a(4);t.NpcFunctions=function e(t){var a=this;n(this,e),this.testFunction=function(){console.log("test function fired")},this.intro_notleyMountsDragon=function(){a.game.sfx.play("sfx_jump_up",.6),a.game.actions.walk(a.game.notley,{x:0,y:-120},300,null,function(){a.game.actions.walk(a.game.notley,{x:-60,y:0},200,null,function(){a.game.dialogue.initDialogue(null,a.game.notley,!0)},!0)})},this.intro_notleyRevealsCrystal=function(){a.game.time.events.add(600,function(){a.game.notley.animations.play("show-crystal").stop(),console.log("NOTLEY!",a.game.notley),a.game.sfx.play("sfx_sword_shine"),a.game.time.events.add(1200,function(){a.game.dialogue.initDialogue(null,a.game.notley,!0)})})},this.intro_notleyFliesAway=function(){a.game.dragon.scream(1200,function(){a.game.dragon.quickExit(function(){a.distantDragon=a.game.add.sprite(a.game.player.x,580,"bg-textures","dragon-flying-away.png"),a.distantDragon.anchor.setTo(.5),a.game.actions.walkTo(a.game.player,{x:645,y:820},2200,300,function(){a.game.dialogue.initDialogue(null,a.game.player,!1),a.game.add.tween(a.distantDragon).to({alpha:0},4e3,null,!0,1e3),a.game.add.tween(a.distantDragon.scale).to({x:.65,y:.65},4300,null,!0,700)})})})},this.intro_kenneyHoldsUpSword=function(){a.game.player.frameName="hero-sword-high/_01.png",a.game.sfx.play("sfx_sword_shine"),a.game.time.events.add(1200,function(){a.game.dialogue.initDialogue(null,a.game.player,!1)})},this.intro_endScene=function(){a.game.dragon=null,a.game.notley=null,a.game.camera.fade("#000000",800),a.game.camera.onFadeComplete.addOnce(function(){a.game.sfx.stop(),a.game.state.start("StartMenu")})},this.newGameInitFunction_calgary_00=function(){a.game.player.isTalking=!0,a.game.player.animations.stop();var e=a.game.actions.getCharacter("Chief of Staff");a.game.actions.walkTo(e,{x:542,y:390},1500,200,function(){e.frameName="npc-09-mr/_01.png"}),a.game.actions.setNewCachePosition(a.game.currentStage,e,542,390),a.game.time.events.add(2500,function(){a.game.player.data.dI=2,a.game.dialogue.heroSpeaks()})},this.pantheon_arrival=function(){a.game.player.isTalking=!0,a.game.player.removeQuest("kq-q-kananaskis"),a.game.player.body.velocity.set(0),a.game.actions.walkTo(a.game.player,{x:450,y:260},1600,0,function(){a.game.sfx.play("sfx_shake"),a.game.camera.shake(.006,1e3),a.game.camera.onShakeComplete.addOnce(function(){var e={data:{name:"Voice",dI:0}};a.game.dialogue.initDialogue(null,e,!1)})})},this.pantheon_thatcher=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.pantheonTriggered=!1,a.game.pantheonTriggered||(a.game.pantheonTriggered=!0,a.game.actions.walkTo(a.game.player,{x:608,y:540},700,null,function(){a.game.actions.enterDeity({character:"Margaret Thatcher",id:15,portrait:"thatcher"},544,415,"blue",!0),a.game.actions.enterDeity({character:"Ralph Klein",id:14,portrait:"klein"},673,415,"blue");a.game.player.frameName="hero-mb/_01.png"}))},this.pantheon_endScene=function(){a.game.mapWorld.changeStage(null,{targetMap:"kq02-calgary-00",targetPosition:"480,348"},a.game.npcFunctions.pantheon_return),console.log("STAGE INIT FUNCTION IS NOW",o(a.game.stageInitFunction[0]))},this.pantheon_return=function(){a.set_calgary_assets(),a.game.stageDismissFunction[0]=a.ndp_palace01_changeStageCall,a.game.player.isTalking=!0,a.game.player.alpha=0,a.game.actions.getCharacter("Chief of Staff").frameName="npc-09-mr/_01.png",a.game.time.events.add(800,function(){var e=a.game.actions.getCharacter("Stephen Harper");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!1,null,!0)})},this.pantheon_return_enter_kenney=function(){var e=a.game.actions.addFlame(a.game.player.x,a.game.player.y,"blue");a.game.add.tween(e.position).to({y:e.position.y+40},1200,"Quad.easeOut",!0).onComplete.add(function(){e.destroy(),a.game.player.alpha=1,a.game.time.events.add(300,function(){a.game.NPCGroup.forEach(function(e){a.game.actions.jump(e,180,a.game.rnd.integerInRange(20,220))})}),a.game.time.events.add(1300,function(){var e=a.game.actions.getCharacter("Chief of Staff");e.data.dI=4,a.game.dialogue.initDialogue(null,e,!0)})})},this.set_calgary_assets=function(){a.game.actions.removeCacheObject("kq02-calgary-01",["type","object"],["colour","black"],["objectType","truck"],["direction","0,1"]),a.game.actions.removeCacheObject("kq02-calgary-01",["type","npc"],["character","Charlotte"]),a.game.globalAchievements.crystalsLive=!0,a.game.actions.setCharacterDICache("Alberta Parks Officer",0,"kq02-calgary-02"),a.game.actions.setNewCacheObject("kq02-calgary-01",a.game.actions.createMapObjectForCache(1348,2030,375,32,32,{coords:"130,1350",key:"mapChange",stage:"kq02-calgary-03",type:"mapChange"})),a.game.actions.changeMapTiles("kq02-calgary-02","foreground",{593:0,594:0,623:0,624:0})},this.ford_intro=function(){a.game.player.isTalking=!0;var e={character:"Doug Ford",dI:0,id:32,name:"Doug Ford",static:!0,type:"npc",key:"npc",portrait:"ford"};a.game.actions.setNewCacheObject("kq02-forest-00",{x:300,y:200,properties:e});var t=new l.NPC(a.game,a.game.world.width/2,-32,"sprites","",e);a.game.NPCGroup.add(t),a.game.actions.walk(t,{x:-60,y:200},1200,200,function(){a.game.dialogue.initDialogue(null,t,!0)})},this.sygils_intro=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.actions.walkTo(a.game.player,{x:482,y:812},1200,300,function(){a.game.actions.removeCacheObject("kq02-mountains-00",["type","npc"],["character","Hooded Figure"]);a.game.actions.enterDeity({character:"Hooded Figure",id:34,dI:1},354,750,"blue",!0)},!0)},this.greatTree_arrival=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.actions.walkTo(a.game.player,{x:482,y:1862},1600,200,function(){var e=a.game.actions.getCharacter("Doug Ford");e.position.setTo(230,1500),a.game.actions.walkTo(e,{x:400,y:1860},1600,100,function(){e.data.dI=5,a.game.dialogue.initDialogue(null,e,!0)})})},this.greatTree_removeTree=function(e){for(var t={},n=0;n<488;n++){t[(n+1542).toString()]=0}a.game.actions.changeMapTiles("kq02-forest-00","foreground",t),a.game.actions.changeMapTiles("kq02-forest-00","detail",t),a.game.actions.changeMapTiles("kq02-forest-00","subdetail",t);var o=a.game.player.x+", "+a.game.player.y;a.game.sfx.play("sfx_treeFall"),a.game.stageInitFunction[1]=e,a.game.mapWorld.changeStage(null,{targetMap:"kq02-forest-00",targetPosition:o},a.game.npcFunctions.set_postTree_convo)},this.set_postTree_convo=function(){console.log("INIT post-tree convo"),console.log("!!!",a.game.stageInitFunction),a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Doug Ford");e.position.setTo(400,1860),e.data.dI=a.game.stageInitFunction[1],a.game.stageInitFunction[1]=null,a.game.mapWorld.updateWaypoint("kq-q-carbontree-5"),a.game.player.crystalAcquired("Crystal of Regulatory Freedom",function(){a.game.player.isTalking=!0,a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Doug Ford"),!0)})},this.greatTree_dougRunsOff=function(){var e=a.game.actions.getCharacter("Doug Ford");a.game.actions.walkTo(e,{x:230,y:1500},1300,100,function(){a.game.player.data.dI=8,a.game.dialogue.initDialogue(null,a.game.player,!1)})},this.pipeline_end=function(e){a.game.sfx.stop(),a.game.player.removeQuest("kq-q-pipeline"),a.game.player.crystalAcquired("Crystal of Infrastructure Projects",function(){a.game.actions.removeCacheObject("kq02-mountains-00",["key","mapChange"],["stage","kq02-mountains-01"],["coords","1160,1160"]),a.game.actions.removeCacheObject("kq02-mountains-00",["key","mapChange"],["stage","kq02-mountains-01"],["coords","1160,1160"]),a.game.atlas["kq02-mountains-00"].nodes=["kq02-calgary-01","kq02-forest-00"],a.game.startingPosition=[480,226],a.game.currentStage="kq02-mountains-00",a.game.data.players.jasonKenney.crystals.length>=2&&(a.game.stageInitFunction[0]=a.call_deities_two_crystals),a.game.state.start("Game")})},this.calgary_02_clearWay=function(){a.game.actions.removeFromCachedObject("Naheed Nenshi","questNodeId","kq02-calgary-01"),a.game.actions.setCharacterDICache("Alberta Parks Officer",1,"kq02-calgary-02"),a.game.actions.changeMapTiles("kq02-calgary-02","collision",{593:992,594:993,623:996,624:997,816:0,817:0,818:0,819:0,846:0,847:0,848:0,849:0,877:0,878:0})},this.mountains_reconfig_atlas=function(){a.game.atlas["kq02-calgary-01"].nodes=["kq02-calgary-00","kq02-mountains-00","kq02-badlands-00","kq02-calgary-03"],a.game.atlas["kq02-mountains-00"].nodes=["kq02-calgary-01","kq02-mountains-01","kq02-forest-00"],a.game.actions.setMapChangeProps("kq02-calgary-02",{coords:"1824,850",key:"mapChange",stage:"kq02-mountains-00",type:"mapChange"},"kq02-calgary-01")},this.ndp_palace01_moveTrolls=function(){var e=[],t=[];a.game.enemyGroup.children.forEach(function(a,n){n>=12||(a.x<440?e.push(a):t.push(a))}),e.forEach(function(e,t){a.game.add.tween(e).delay(200*t).to({x:-60},1400+60*t,null,!0),console.log("TROLL!!!!",e)}),t.forEach(function(e,t){a.game.add.tween(e).delay(200*t).to({x:a.game.world.width+60},1400+60*t,null,!0)})},this.ndp_palace01_changeStageCall=function(){a.game.currentCharacter="rachelNotley",a.game.startingPosition=[0,560],a.game.currentStage="kq02-palace-00",a.game.stageInitFunction[0]=a.ndp_palace_01,a.game.musicHandler.stop(),a.game.state.start("Game")},this.ndp_palace02_changeStageCall=function(){var e="kq02-edmonton-02"===a.game.currentStage?[1190,1770]:[260,1670];a.game.data.players.jasonKenney.startingCoords.x=e[0],a.game.data.players.jasonKenney.startingCoords.y=e[1],a.game.currentCharacter="rachelNotley",a.ndp_palace_02_setup(),a.game.startingPosition=[0,560],a.game.currentStage="kq02-palace-00",a.game.stageInitFunction[0]=a.ndp_palace_02_initFunction,a.game.state.start("Game")},this.ndp_palace_02_initFunction=function(){a.game.player.isTalking=!0,a.game.actions.walkTo(a.game.player,{x:220},1800,200,function(){a.game.actions.walkTo(a.game.player,{y:410},800,0,function(){a.game.actions.walkTo(a.game.player,{x:a.game.camera.width/2+12},1800,0,null,!0),a.game.camera.follow(a.game.player),a.game.player.data.dI=9,a.game.dialogue.initDialogue(null,a.game.player,!1)})}),void 0!==a.game.triggerGroup.children[0]&&(a.game.triggerGroup.children[0].y=750),void 0!==a.game.triggerGroup.children[0]&&(a.game.triggerGroup.children[1].y=750),a.invisibleHand_setup(482,1040,5),a.game.actions.getCharacter("Corey Hogan").visible=!1,a.game.actions.getCharacter("Stephen Carter").visible=!1,a.game.stageDismissFunction[0]=a.ndp_palace_02_return},this.ndp_palace_02_walkPastHand=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.setTo(0),a.game.actions.walkTo(a.game.player,{x:460,y:1160},1200,100,function(){a.game.player.isTalking=!1,a.game.actions.changeMapTiles("kq02-palace-00","subforeground",{1178:0,1179:0,1180:0,1181:0,1182:0}),a.game.actions.changeMapTiles("kq02-palace-00","collision",{1208:0,1209:0,1210:0,1211:0,1212:0})})},this.ndp_palace_02_horganEnters=function(){a.game.player.isTalking=!0;var e={character:"John Horgan",name:"John Horgan",dI:18,portrait:"horgan"},t=new l.NPC(a.game,a.game.world.width+36,a.game.player.y+16,"bc-ndp","horgan_0.png",e);a.game.NPCGroup.add(t),a.game.add.tween(t.position).to({x:a.game.player.x-42},800,Phaser.Easing.Elastic.Out,!0).onComplete.addOnce(function(){a.game.dialogue.initDialogue(null,t,!1)})},this.ndp_palace_02_horganExits=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("John Horgan");a.game.add.tween(e.position).to({x:a.game.world.width+36},800,Phaser.Easing.Quadratic.Out,!0).onComplete.addOnce(function(){e.kill(),a.game.player.isTalking=!1})},this.ndp_palace_02_setup=function(){var e={x:308,y:1272,properties:{engageDistance:90,character:"Zain Velji",dI:0,id:45,key:"npc",name:"Zain Velji",portrait:"velji",static:!0,type:"npc"}},t={x:302,y:1272,properties:{character:"Stephen Carter",dI:0,id:47,key:"npc",name:"Stephen Carter",portrait:"carter",static:!0,type:"npc"}},n={x:366,y:1272,properties:{character:"Corey Hogan",dI:0,id:46,key:"npc",name:"Corey Hogan",portrait:"hogan",static:!0,type:"npc"}};a.game.actions.setNewCacheObject("kq02-palace-00",e),a.game.actions.setNewCacheObject("kq02-palace-00",t),a.game.actions.setNewCacheObject("kq02-palace-00",n);var o={x:600,y:1272,properties:{character:"Jagmeet Singh",dI:0,id:63,key:"npc",name:"Jagmeet Singh",portrait:"singh",static:!0,type:"npc"}};a.game.actions.setNewCacheObject("kq02-palace-00",o);for(var i=0;i<11;i++)a.game.actions.removeCacheObject("kq02-palace-00",["character","Troll"]);a.game.actions.removeCacheObject("kq02-palace-00",["initFunction","ndp_palace_01_talkToHand"],["type","trigger"]),a.game.actions.removeCacheObject("kq02-palace-00",["initFunction","ndp_palace_01_talkToHand"],["type","trigger"]);var r={x:362,y:720,properties:{initFunction:"ndp_palace_02_walkPastHand",once:!0,type:"trigger"}},s={x:506,y:720,properties:{initFunction:"ndp_palace_02_walkPastHand",once:!0,type:"trigger"}};a.game.actions.setNewCacheObject("kq02-palace-00",r),a.game.actions.setNewCacheObject("kq02-palace-00",s);var l={x:420,y:1920,properties:{coords:"640,320",key:"mapChange",stage:"kq02-edmonton-00",type:"mapChange"}},h={x:484,y:1920,properties:{coords:"640,320",key:"mapChange",stage:"kq02-edmonton-00",type:"mapChange"}};a.game.actions.setNewCacheObject("kq02-palace-00",l),a.game.actions.setNewCacheObject("kq02-palace-00",h),a.game.actions.changeMapTiles("kq02-palace-00","subforeground",{1178:2991,1179:2992,1180:2993,1181:2994,1182:2995}),a.game.actions.changeMapTiles("kq02-palace-00","collision",{1208:2996,1209:2997,1210:2998,1211:2999,1212:3e3}),a.game.actions.setCharacterDICache("Shaye Anderson",2,"kq02-palace-00"),a.game.actions.setCharacterDICache("David Shepherd",6,"kq02-palace-00"),a.game.actions.setCharacterDICache("Danielle Larivee",2,"kq02-palace-00"),a.game.actions.setCharacterDICache("Deron Bilous",10,"kq02-palace-00"),a.game.actions.setCharacterDICache("Shannon Phillips",2,"kq02-palace-00")},this.ndp_palace_02=function(){a.game.actions.getCharacter("Rachel Notley").data.dI=0},this.ndp_palace_ceciSpeaks=function(e){a.game.player.isTalking=!0;var t=a.game.actions.getCharacter("Joe Ceci");t.data.dI=e||0,a.game.actions.walkTo(a.game.player,{x:367,y:370},1200,0,null,!0),a.game.actions.walkTo(t,{x:480,y:415},1400,400,function(){a.game.dialogue.initDialogue(null,t,!1,null,!0)},!0)},this.ndp_palace_01_talkToHand=function(){a.game.player.body.velocity.set(0),a.game.player.isTalking=!0,a.game.actions.walkTo(a.game.player,{y:1222},600,0,function(){a.game.actions.walkTo(a.game.player,{x:290},800,200,function(){a.game.player.frameName="npc-16-ml/_01.png";var e={data:{character:"The Invisible Hand",dI:0,name:"The Invisible Hand"}};a.game.dialogue.initDialogue(null,e,!1)})})},this.ndp_palace_02_return=function(){a.game.currentCharacter="jasonKenney",a.game.currentStage="kq02-edmonton-00",a.game.startingPosition=[a.game.data.players.jasonKenney.startingCoords.x,a.game.data.players.jasonKenney.startingCoords.y],a.game.state.start("Game")},this.ndp_palace_01_out=function(){a.game.currentCharacter="jasonKenney",a.game.currentStage="kq02-calgary-01",a.game.startingPosition=[932,276],a.game.state.start("Game")},this.ndp_palace_01=function(){a.game.player.isTalking=!0,a.game.camera.unfollow(),a.game.actions.animateNPCs("walk-backward","enemyGroup",null,!0);var e=a.game.add.graphics(0,0);e.beginFill("#000",1),e.drawRect(a.game.camera.width,a.game.camera.height,0,0),e.endFill(),e.fixedToCamera=!0,a.game.add.tween(e).to({alpha:0},1600,null,!0).onComplete.add(function(){e.destroy()}),a.game.actions.walkTo(a.game.player,{x:220},1800,200,function(){a.game.actions.walkTo(a.game.player,{y:410},800,0,function(){a.game.actions.walkTo(a.game.player,{x:a.game.camera.width/2+12},1800,0,null,!0),a.game.camera.follow(a.game.player),a.game.player.data.dI=5,a.game.dialogue.initDialogue(null,a.game.player,!1)})}),a.game.camera.y=0,a.game.camera.x=0,a.invisibleHand_setup(482,1300,0)},this.kenneyReturn_beginQuest_changeStageCall=function(){a.game.currentCharacter="jasonKenney",a.game.startingPosition=[930,260],a.game.currentStage="kq02-calgary-01";var e={x:1060,y:756.33,properties:{character:"Don Braid",dI:0,id:52,key:"npc",name:"Don Braid",portrait:"braid",questNodeId:"kq-q-pipeline-0",static:!0,type:"npc"}};a.game.actions.setNewCacheObject("kq02-calgary-01",e);var t={x:1381,y:510,properties:{character:"Naheed Nenshi",dI:0,id:18,key:"npc",name:"Naheed Nenshi",portrait:"nenshi",questNodeId:"kq-q-quiz-0",static:!0,type:"npc"}};a.game.actions.setNewCacheObject("kq02-calgary-01",t),a.game.musicHandler.stop(),a.game.state.start("Game")},this.kenneyReturn_beginQuest=function(){},this.acquire_valveWheel=function(e){var t={class:"Valve Wheel",key:"inventoryItem",subClass:"wheel",itemName:"Valve Wheel",type:"pickup"},n=new g.PickupItem(a.game,a.game.player.x,a.game.player.y,"sprites",null,t,!0);n.initInventoryItem(n.data),n.destroy(),a.game.mapWorld.updateWaypoint("kq-q-pipeline-3"),a.game.actions.getCharacter(e).data.dI=0},this.place_valveWheel=function(){a.game.player.hasItem("wheel")&&(a.game.player.body.velocity.set(0),a.game.player.isTalking=!0,a.horgan_set_wine_flood())},this.horgan_set_wine_flood=function(){a.game.player.removeInventoryItem("wheel");for(var e={},t=0;t<6;t++)for(var n=t+44,o=8;o<30;o++){var i=o+40*n;i=i.toString(),e[i]=2822}a.game.actions.changeMapTiles("kq02-mountains-01","collision",{1628:2944,1728:2821,1729:2821,1730:2821,1731:2821,1732:2821,1733:2821,1734:2821,1735:2821,1736:2821,1737:2821,1738:2821,1739:2821,1740:2821,1741:2821,1742:2821,1743:2821,1744:2821,1745:2821,1746:2821,1747:2821,1748:2821,1749:2821}),a.game.actions.changeMapTiles("kq02-mountains-01","collision",e),a.game.mapWorld.searchAndRemoveTriggers("horgan_set_wine_flood"),a.game.actions.removeCacheObject("kq02-mountains-01",["type","trigger"],["initFunction","horgan_set_wine_flood"]);a.game.player.x,a.game.player.y;a.game.currentPosition=[a.game.player.x,a.game.player.y],a.game.stageInitFunction[0]=a.horgan_enter,a.game.musicHandler.stop(),a.game.state.start("Game")},this.horgan_enter=function(){a.game.musicHandler.stop(),a.game.musicHandler.play("theme-horgan"),a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.player.frameName="hero-mab/_01.png";var e=new i.BCNdp(a.game,a.game.world.width/2,-600),t={character:"John Horgan",name:"John Horgan",dI:0,portrait:"horgan"},n=new l.NPC(a.game,0,290,"bc-ndp","horgan_0.png",t);n.animations.play("gesticulate"),e.addChild(n),a.game.NPCGroup.add(n),a.game.world.setChildIndex(e,5),a.game.camera.follow(null);var o=a.game.add.tween(e.position).to({y:520},6e3,Phaser.Easing.Quadratic.Out,!0),r=a.game.add.tween(a.game.camera).to({x:a.game.width/6,y:0},1200,Phaser.Easing.Quadratic.InOut,!0);r.onComplete.add(function(){r.onComplete.removeAll(),a.game.camera.follow(e.children[13]),a.game.player.x=a.game.world.width/2,a.game.player.y=1300}),o.onComplete.add(function(){e.stop(),a.game.camera.follow(null),a.game.camera.x=a.game.width/6,a.game.camera.y=e.y,a.game.add.tween(a.game.camera).to({x:a.game.width/6,y:1300},3e3,Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){a.game.musicHandler.stop(),a.game.sfx.play("sfx_wind"),a.game.camera.follow(a.game.player),a.game.actions.walkTo(a.game.player,{x:a.game.player.x,y:900},1600,100,function(){n.animations.stop(),n.frameName="npc-",a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("John Horgan"),!0,null,!0)})})})},this.end_horgan=function(){a.game.sfx.stop()},this.boat_arrival=function(){a.game.world.setChildIndex(a.game.objGroup,6),a.game.player.isTalking=!0,a.game.player.body.velocity.setTo(0);var e=a.game.actions.getCompanion();a.game.actions.walkTo(e,{x:372,y:372},600,200),a.game.actions.walkTo(a.game.player,{x:330,y:320},500,200,function(){a.game.actions.walkTo(a.game.player,{y:372},200,0,function(){a.game.actions.getCharacter("Hooded Figure").data.dI=2,a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Hooded Figure"),!1)})})},this.boat_to_middle=function(){var e=a.game.objGroup.children[0];a.game.player.isTalking=!0;var t=a.game.player,n=a.game.actions.getCharacter("Hooded Figure"),o=a.game.actions.getCompanion();e.addChild(t),e.addChild(n),e.addChild(o),t.position.setTo(0,-18),n.position.setTo(-36,-18),o.position.setTo(36,-18),a.game.add.tween(e.position).to({x:a.game.world.width/2},3e3,null,!0).onComplete.add(function(){a.game.dialogue.initDialogue(null,e.children[1],!1)})},this.boat_return_figure=function(){return"ambrose"},this.boat_reveal_self=function(){var e,t,n=a.boat_return_figure();switch(n){case"ambrose":e="Rona Ambrose",t=39;break;case"aberhart":e="Bill Aberhart",t=41;break;case"mercury":e="Freddie Mercury",t=40}var o={character:e,dI:0,id:t,key:"npc",name:e,portrait:n,static:!0,type:"npc"},i=a.game.objGroup.children[0].children[1];i.data=o,i.frameName="npc-"+t+"-mf/_01.png",a.game.dialogue.initDialogue(null,i,!1)},this.boat_to_shore=function(){a.game.player.isTalking=!0;var e=a.game.objGroup.children[0].children[1];e.frameName="npc-"+e.data.id+"-mf/_01.png";var t=a.game.objGroup.children[0];a.game.add.tween(t.position).to({x:1805},3e3,null,!0).onComplete.add(function(){var e=a.game.objGroup.children[0],t=e.children[2];a.game.actions.walkTo(t,{x:170},600,200),a.game.actions.walkTo(a.game.player,{x:140},600,200,function(){a.game.player.isTalking=!1})})},this.avocadoToast_buttonMashChallenge=function(){a.buttonMash=new r.ButtonMash(a.game,"avocadoToast")},this.avocadoToast_win=function(){a.game.mapWorld.updateWaypoint("kq-q-avocadotoast-2"),a.avocadoToast_acquireToast()},this.avocadoToast_lose=function(){a.game.mapWorld.updateWaypoint("kq-q-avocadotoast-2"),a.avocadoToast_acquireToast()},this.avocadoToast_acquireToast=function(){a.game.dialogue.alert("Avocado toast acquired! Seek out the other fixings to optimise this sacred dish.");var e={itemName:"Avocado Toast",key:"inventoryItem"},t=new g.PickupItem(a.game,0,0,"sprites","trigger.png",e);a.game.mapWorld.pickupItem(null,t),a.game.globalAchievements.avocadoToast.previous="toast-avocado",a.avocadoToast_createItemSprites()},this.avocadoToast_createItemSprites=function(){var e=a.game.actions.getCharacter("Farmer's Market Vendor");e.data.dI=1,a.game.actions.setDICache(e,"kq02-edmonton-00");var t=986,n=1294,o={itemFunction:"avocadoToast_acquireSriracha",message:"Sriracha acquired!",objectType:"sign",type:"object"},i=new p.Obj(a.game,t,n,"sprites","",o);a.game.objGroup.add(i),a.game.actions.setNewCacheObject("kq02-edmonton-00",{x:t,y:n,properties:o}),t=955,n=1009;var r={itemFunction:"avocadoToast_acquireEgg",message:"Egg acquired!",objectType:"sign",type:"object"},s=new p.Obj(a.game,t,n,"sprites","",r);a.game.objGroup.add(s),a.game.actions.setNewCacheObject("kq02-edmonton-00",{x:t,y:n,properties:r})},this.avocadoToast_acquireEgg=function(){a.game.globalAchievements.avocadoToast.egg=!0,a.avocadoToast_removeExisting(),a.avocadoToast_makeSequence(),a.game.actions.removeCacheObject("kq02-edmonton-00",["itemFunction","avocadoToast_acquireEgg"],["type","object"])},this.avocadoToast_acquireBacon=function(){a.game.globalAchievements.avocadoToast.bacon=!0,a.avocadoToast_removeExisting(),a.avocadoToast_makeSequence()},this.avocadoToast_acquireSriracha=function(){a.game.globalAchievements.avocadoToast.sriracha=!0,a.avocadoToast_removeExisting(),a.avocadoToast_makeSequence(),a.game.actions.removeCacheObject("kq02-edmonton-00",["itemFunction","avocadoToast_acquireSriracha"],["type","object"])},this.avocadoToast_removeExisting=function(){a.game.player.removeInventoryItem(a.game.globalAchievements.avocadoToast.previous)},this.avocadoToast_makeSequence=function(){var e=a.game.globalAchievements.avocadoToast.egg?"egg":"",t=a.game.globalAchievements.avocadoToast.bacon?"bacon":"",n=a.game.globalAchievements.avocadoToast.sriracha?"sriracha":"",o="("+e+"-"+t+"-"+n+")",i=e+"-"+t+"-"+n,r="Avocado Toast "+o,s={itemName:r,key:"inventoryItem"},l=new g.PickupItem(a.game,0,0,"sprites","trigger.png",s);a.game.mapWorld.pickupItem(null,l),a.game.globalAchievements.avocadoToast.previous="toast-avocado-"+i;var h=[a.game.globalAchievements.avocadoToast.egg,a.game.globalAchievements.avocadoToast.bacon,a.game.globalAchievements.avocadoToast.sriracha],c=h.filter(function(e){return e}),u=a.game.actions.getCharacter("Ravi, Leader of all Millennials");switch(c.length){case 1:u.data.dI=2;break;case 2:u.data.dI=3;break;case 3:a.game.dialogue.alert("Congratulations! You've found all of the sacred ingredients."),u.data.dI=4}},this.avocadoToast_removeToast=function(){a.avocadoToast_removeExisting(),a.game.mapWorld.updateWaypoint("kq-q-avocadotoast-3"),a.game.player.hasItem("Oilers jersey")||a.edmonton_acquireJersey()},this.edmonton_acquireJersey=function(){var e={itemName:"Oilers Jersey",key:"inventoryItem"},t=new g.PickupItem(a.game,0,0,"sprites","trigger.png",e);a.game.mapWorld.pickupItem(null,t),a.game.time.events.add(3e3,function(){if(!a.game.player.isTalking){var e=a.game.actions.getCompanion(18);a.game.dialogue.initDialogue(null,e,!1)}})},this.set_calgary_03_to_trigger_palace_00=function(){a.game.stageDismissFunction[0]=a.ndp_palace02_changeStageCall},this.edmonton_crystal=function(){if(a.game.player.hasItem("jersey-edmonton")){a.game.player.isTalking=!0,a.game.player.body.velocity.setTo(0);a.game.actions.getCompanion().data.dI=9,a.game.dialogue.initDialogue(null,a.game.actions.getCompanion(),!1)}},this.edmonton_crystal_uncovery=function(){a.game.player.removeInventoryItem("jersey-edmonton"),a.game.actions.changeMapTiles("kq02-edmonton-01","subdetail",{1029:2851,1030:2852,1059:2853,1060:2854}),a.game.stageInitFunction[0]=a.edmonton_crystal_discovery,a.game.startingPosition=[a.game.player.x,a.game.player.y],a.game.musicHandler.stop(),a.game.state.start("Game")},this.edmonton_crystal_discovery=function(){a.game.player.isTalking=!0,a.game.time.events.add(1e3,function(){a.game.player.crystalAcquired("Crystal of Edmonton",function(){var e=a.game.actions.getCompanion(20);a.game.dialogue.initDialogue(null,e,!1)})})},this.edmonton_crystal_escape=function(){if(a.game.data.players.jasonKenney.quests=[],a.game.data.players.jasonKenney.portrait="kenney",a.game.data.players.jasonKenney.inDisguise=!1,a.game.data.companion.hasOwnProperty("portrait")){var e=a.game.data.companion.character;a.game.data.companion.portrait="Leela Aheer"===e?"aheer":"nixon",a.game.data.companion.dI=11,a.game.data.companion.id="Leela Aheer"===e?31:17}var t={targetMap:"kq02-calgary-00",targetPosition:"500,660"};a.game.mapWorld.changeStage(null,t,a.edmonton_crystal_returnCalgary)},this.edmonton_crystal_returnCalgary=function(){a.game.player.isTalking=!0,a.game.data.players.jasonKenney.hasCompanion=!1;var e=a.game.actions.getCompanion();e.position.set(480,650),a.game.actions.getCharacter("Chief of Staff").position.set(576,428),a.game.time.events.add(600,function(){a.game.actions.walkTo(e,{x:480,y:650},1300);var t=a.game.add.tween(a.game.player).to({x:480,y:530},1500,null,!0,200);a.game.player.animations.play("walk-backward"),t.onComplete.addOnce(function(){var e=a.game.actions.getCharacter("Stephen Harper");a.game.player.animations.play("walk-backward").stop(),e.data.dI=12,a.game.dialogue.initDialogue(null,e,!1)})})},this.edmonton_setPaulaQuestNode=function(){a.game.actions.getCharacter("Paula Simons").data.dI=0,a.game.actions.setCharacterDICache("Paula Simons",0,"kq02-edmonton-00"),a.takeEdmontonQuest("kq-q-environment")},this.edmonton_trudeauNotleyCutscene=function(){a.game.player.isTalking=!0,a.game.camera.follow(null),a.game.add.tween(a.game.camera).to({x:610-a.game.camera.width/2,y:547-a.game.camera.height/2},700,null,!0).onComplete.add(function(){var e=a.game.actions.getCharacter("Rachel Notley");e.data.dI=10,a.game.dialogue.initDialogue(null,e,!1,null,!0)})},this.edmonton_trudeauNotleyCutscene_trudeauAppears=function(){a.game.player.isTalking=!0;var e={character:"Justin Trudeau",dI:33,id:42,key:"npc",name:"Justin Trudeau",portrait:"trudeau",static:!0,type:"npc"},t=new l.NPC(a.game,495,450,"sprites","",e);a.game.NPCGroup.add(t),a.game.actions.walkTo(t,{x:576},400,400,function(){a.game.actions.walkTo(t,{y:547},300,100,function(){var e=a.game.actions.getCharacter("Justin Trudeau");e.animations.play("celebrate"),a.game.dialogue.initDialogue(null,e,!1,null,!0)})})},this.edmonton_trudeauNotleyCutscene_trudeauExits=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Justin Trudeau");a.game.actions.walkTo(e,{y:510},300,400,function(){e.animations.play("walk-forward").stop(),a.game.time.events.add(800,function(){a.game.actions.walkTo(e,{x:486,y:430},400,0,function(){a.game.actions.getCharacter("Justin Trudeau").destroy(),a.game.camera.follow(a.game.player),a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Gabby"),!1)})})})},this.fildebrandt_trigger_launch_quest=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.actions.walkTo(a.game.player,{x:a.game.world.width/2,y:260},600,200,function(){var e=a.game.actions.getCharacter("Derek Fildebrandt");e.position.set(a.game.camera.width/1.33,a.game.camera.height+32),e.data.dI=9,a.game.actions.walkTo(e,{x:a.game.player.x+36,y:a.game.player.y},1200,100,function(){a.game.dialogue.initDialogue("right",e,!0)})},!0)},this.fildebrandt_launch_quest=function(e){a.game.globalAchievements.fildebrandtGetsYouCoffee=e||!1,a.game.currentCharacter="derekFildebrandt";var t={targetPosition:"1430,580",targetMap:"kq02-truckstop-00"};a.game.mapWorld.changeStage(null,t,a.fildebrandt_add_quest)},this.fildebrandt_add_quest=function(){},this.fildebrandt_buttonMashChallenge=function(){a.buttonMash=new r.ButtonMash(a.game,"fildebrandt")},this.fildebrandt_losesChallenge=function(){a.game.actions.setCharacterDICache("Derek Fildebrandt",18,"kq02-airship-00");var e=a.game.actions.getCharacter("Truckstop Barista");e.data.dI=3,a.game.dialogue.initDialogue(null,e,!0),a.fildebrandt_setMapChange()},this.fildebrandt_winsChallenge=function(){a.game.actions.setCharacterDICache("Derek Fildebrandt",17,"kq02-airship-00");var e=a.game.actions.getCharacter("Truckstop Barista");e.data.dI=1,a.game.dialogue.initDialogue(null,e,!0),a.fildebrandt_setMapChange()},this.fildebrandt_setMapChange=function(){var e={x:1250,y:24,properties:{coords:"480,960",key:"mapChange",stage:"kq02-airship-00",type:"mapChange",questNodeId:"kq-q-coffee-2"}},t=new s.MapChangeSprite(null,a.game,e.x,e.y,"sprites",e.properties),n=new s.MapChangeSprite(null,a.game,1314,e.y,"sprites",e.properties),o=new s.MapChangeSprite(null,a.game,1186,e.y,"sprites",e.properties);a.game.stagesGroup.add(t),a.game.stagesGroup.add(n),a.game.stagesGroup.add(o),a.game.mapWorld.updateWaypoint("kq-q-coffee-1"),a.game.currentCharacter="jasonKenney"},this.fildebrandt_endCoffeeChallenge=function(e){
//!!!!
var t;e?(t=a.game.globalAchievements.fildebrandtGetsYouCoffee?17:20,a.game.actions.setCharacterDICache("Derek Fildebrandt",t,"kq02-airship-00")):(t=a.game.globalAchievements.fildebrandtGetsYouCoffee?18:21,a.game.actions.setCharacterDICache("Derek Fildebrandt",t,"kq02-airship-00")),a.game.currentCharacter="jasonKenney",a.game.startingPosition=[480,960],a.game.currentStage="kq02-airship-00",a.game.camera.fade("#000000"),a.game.camera.onFadeComplete.addOnce(function(){a.game.musicHandler.stop(),a.game.state.start("Game")})},this.airship_initFunction_tiles_laydown=function(e,t){for(var n={initFunction:e,once:!0,type:"trigger"},o=0;o<8;o++){var i=new m.Trigger(a.game,122+72*o,t,"sprites","trigger",n);a.game.triggerGroup.add(i)}},this.fildebrandt_dragonCry=function(){a.game.player.isTalking=!0,a.game.sfx.play("sfx_dragon_roar"),a.game.NPCGroup.forEach(function(e){a.game.actions.jump(e,180,a.game.rnd.integerInRange(20,220))}),a.game.time.events.add(2200,function(){a.game.musicHandler.stop(),a.game.musicHandler.play("boss-intro"),a.game.time.events.add(600,function(){a.game.actions.getCharacter("Derek Fildebrandt").data.dI=23,a.game.dialogue.initDialogue(null,a.game.actions.getCompanion(21),!1)}),a.game.time.events.add(15130,function(){a.game.musicHandler.play("boss-main")})})},this.launch_dragon_bossFight=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.actions.walkTo(a.game.player,{y:320},1e3,0,null,!0),a.game.camera.follow(null);var e=a.game.actions.getCompanion();e.data.isFollowing=!1,e.body.velocity.set(0),a.game.NPCGroup.forEach(function(e){a.game.actions.walkTo(e,{y:1e3},1200),e.data.static=!0}),a.game.player.cameraBounds=!0;var t=new h.Dragon(a.game,a.game.world.width/2,-200,"sprites","",{});a.game.enemyGroup.add(t),t.dramaticEntrance(2400,function(){t.scream(1200,function(){a.game.player.isTalking=!1,a.game.bossFight=new c.BossFight(a.game,t,"dragon"),t.setState("_MOVING"),t.combatActive=!0,t.setAttackTimer(500,t.fireball)})})},this.reset_dragon_bossFight=function(){a.launch_dragon_bossFight()},this.end_dragon_bossFight=function(e){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),e.scream(2e3,function(){e.quickExit(function(){a.game.actions.walkTo(a.game.player,{x:a.game.camera.width/2,y:a.game.camera.height/2+48},700,100,function(){var e=a.game.actions.getCharacter("Derek Fildebrandt");e.position.set(a.game.world.width/2+100,a.game.camera.height+32),a.game.actions.walkTo(e,{x:a.game.player.x+48,y:a.game.player.y},1200,100,function(){e.data.dI=19,a.game.dialogue.initDialogue("forward",e,!0)});var t=a.game.actions.getCompanion();t.position.set(a.game.world.width/3,a.game.camera.height+32),a.game.actions.walkTo(t,{x:a.game.player.x-48,y:a.game.player.y},2e3)})})})},this.edmonton_setup_from_airship=function(){a.game.actions.setCharacterDICache("Ravi, Leader of all Millennials",1,"kq02-edmonton-00"),a.game.actions.getCompanion().data.isFollowing=!0;var e={targetPosition:"580,450",targetMap:"kq02-edmonton-02",data:""};a.game.mapWorld.changeStage(null,e,a.edmonton_setup_from_caves)},this.edmonton_setup_from_caves=function(){a.game.player.body.velocity.setTo(0),a.game.player.isTalking=!0;a.game.time.events.add(500,function(){var e=a.game.actions.getCompanion();e.data.dI=7,a.game.dialogue.initDialogue(null,e,!1)})},this.edmonton_setup_from_airship_launch_dialogue=function(){a.game.player.isTalking=!0,a.game.time.events.add(800,function(){var e=a.game.data.companion;e.dI=7,a.game.dialogue.initDialogue(!1,e,null)})},this.launch_ratKing_bossFight=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0);var e=a.game.actions.getWaypointIndex("kq-q-ratking");a.game.waypointGroup.children[e].destroy(),a.game.actions.walkTo(a.game.player,{x:a.game.camera.width/2,y:300},1e3,200,function(){a.game.camera.follow(null),a.game.player.cameraBounds=!0;var e=new u.RatKing(a.game,a.game.world.width/2,-200,"sprites","",{});a.game.enemyGroup.add(e),e.dramaticEntrance(function(){e.scream(1200,function(){e.setSignal(),e.frameName="move/_01.png",a.game.bossFight=new c.BossFight(a.game,e,"rat-king"),e.setState("_MOVING"),e.combatActive=!0,e.setAttackTimer(500,e.toxicBall),e.setMoveTimer(600),a.game.player.isTalking=!1})})})},this.end_ratKing_bossFight=function(e){e.setState("_PAUSED"),e.body.velocity.set(0),e.tint=16711680;var t=a.game.add.tween(e).to({alpha:0},1200,Phaser.Easing.Quadratic.Out,!0,500);a.game.sfx.play("sfx_ratDeath"),t.onComplete.add(function(){a.game.objGroup.children.forEach(function(e){return e.destroy()}),a.game.mapWorld.updateWaypoint("kq-q-ratking-4"),e.destroy(),a.game.bossFight=null,a.game.camera.follow(a.game.player),a.game.player.crystalAcquired("Crystal of Western Ingenuity",function(){2===a.game.player.data.crystals.length?a.call_deities_two_crystals():a.game.player.isTalking=!1})})},this.badlands_keys=function(){a.game.player.hasItem("RatKeyLeft")&&a.game.player.hasItem("RatKeyRight")&&a.badlands_open_door()},this.badlands_open_door=function(){a.game.player.removeInventoryItem("RatKeyLeft"),a.game.player.removeInventoryItem("RatKeyRight"),a.game.mapWorld.searchAndRemoveTriggers("badlands_keys"),a.game.actions.removeCacheObject("kq02-badlands-00",["type","trigger"],["initFunction","badlands_keys"]),a.game.actions.setNewCacheObject("kq02-badlands-00",a.game.actions.createMapObjectForCache(1348,804,1412,32,32,{coords:"400,1030",key:"mapChange",stage:"kq02-badlands-01",type:"mapChange"})),a.game.actions.changeMapTiles("kq02-badlands-00","detail",{1285:2500,1286:2501}),a.game.actions.changeMapTiles("kq02-badlands-00","collision",{1255:2495,1256:2496});var e=a.game.player.x+", "+(a.game.player.y+48);a.game.mapWorld.changeStage(null,{targetMap:"kq02-badlands-00",targetPosition:e})},this.quiz_set_nenshi_quest=function(){a.game.player.addQuest("kq-q-quiz",!0),a.game.actions.setCharacterDICache("Naheed Nenshi",6,"kq02-calgary-01"),a.game.actions.addToCachedObject("Naheed Nenshi",{questNodeId:"kq-q-quiz-1"},"kq02-calgary-01")},this.quiz_question=function(e){var t=a.game.actions.getCharacter("Naheed Nenshi"),n=a.game.quiz,o=function(e,t){return e===t?2:3};a.game.data.players.jasonKenney.quizQuestionsAnswered<5?function(){t.data.dI=1,a.game.npcDialogue.data["Naheed Nenshi"][1]=[[n[e].q,[[n[e].a[0],o(0,n[e].c)],[n[e].a[1],o(1,n[e].c)],[n[e].a[2],o(2,n[e].c)],[n[e].a[3],o(3,n[e].c)]]],1,0,1],a.game.npcDialogue.data["Naheed Nenshi"][2]=[[n[e].cA],1,1,1,function(){a.game.data.players.jasonKenney.quizScore++,a.game.npcFunctions.quiz_question(a.game.actions.randomQuizQ())}],a.game.npcDialogue.data["Naheed Nenshi"][3]=[[n[e].incA],1,1,1,function(){a.game.npcFunctions.quiz_question(a.game.actions.randomQuizQ())}],a.game.dialogue.initDialogue(null,t,!0),a.game.data.players.jasonKenney.quizQuestionsAnswered++,a.game.quiz.splice(e,1)}():(t.data.dI=a.game.data.players.jasonKenney.quizScore>=3?4:5,a.game.dialogue.initDialogue(null,t,!0))},this.curtain_down=function(){a.game.curtain=a.game.add.group();var e=0;!function t(n,o){if(!(n>=7)){var i=a.game.add.tileSprite(0,o,a.game.camera.width,152,"bg-textures","curtain.png");i.fixedToCamera=!0,a.game.curtain.addChildAt(i,0),a.game.add.tween(i.cameraOffset).to({y:60*n},200,Phaser.Linear,!0).onComplete.add(function(){e++,t(e,i.cameraOffset.y)})}}(e,-152)},this.curtain_up=function(){var e=a.game.curtain.children,t=0;!function n(o){if(o===e.length-1){var i=a.game.add.tween(e[o].cameraOffset).to({y:-152},200,Phaser.Linear,!0);i.onComplete.add(function(){e[o].kill(),a.game.curtain.destroy()})}else{var r=e[o],i=a.game.add.tween(r.cameraOffset).to({y:e[o+1].cameraOffset.y},200,Phaser.Linear,!0);i.onComplete.add(function(){r.kill(),t++,n(t)})}}(t)},this.ratKing_addMapTile=function(){var e={coords:"131,80",key:"mapChange",stage:"kq02-badlands-00",type:"mapChange",questNodeId:"kq-q-ratking-1"},t=a.game.actions.createMapObjectForCache(1348,546.33,1281.82,32,32,e),n=a.game.actions.createMapObjectForCache(1348,482.33,1281.82,32,32,e);a.game.actions.setNewCacheObject("kq02-calgary-01",t),a.game.actions.setNewCacheObject("kq02-calgary-01",n);var o=new s.MapChangeSprite(null,a.game,546.33,1249.82,"sprites",e),i=new s.MapChangeSprite(null,a.game,482.33,1249.82,"sprites",e);a.game.stagesGroup.add(o),a.game.stagesGroup.add(i)},this.donBraid_ratKing_switchout=function(){a.ratKing_addMapTile(),a.game.actions.getCharacter("Don Braid").data.nodeQuestId="kq-q-ratking-0",a.game.actions.removeFromCachedObject("Don Braid","questNodeId","kq02-calgary-01");var e=a.game.actions.getWaypointIndex("kq-q-pipeline");a.game.waypointGroup.children[e].data.questId="kq-q-ratking",a.game.waypointGroup.children[e].activate(),console.log("WAYPOINT NOW:",a.game.waypointGroup.children),a.game.actions.addToCachedObject("Justin Trudeau",{questNodeId:"kq-q-pipeline-0"},"kq02-calgary-03"),0!==a.game.cache.getTilemapData("kq02-calgary-03").data.layers[4].objects.filter(function(e){if(e.hasOwnProperty("properties"))return"Justin Trudeau"===e.properties.character})[0].properties.dI&&a.game.actions.setCharacterDICache("Justin Trudeau",9,"kq02-calgary-03")},this.donBraid_pipeline_switchout=function(){a.game.actions.addToCachedObject("Bartender",{questNodeId:"kq-q-ratking-0"},"kq02-calgary-01"),a.game.actions.setCharacterDICache("Bartender",1,"kq02-calgary-01");var e=a.game.actions.getCharacter("Bartender");e.data.dI=1,e.data.questNodeId="kq-q-ratking-0",a.game.mapWorld.createWaypoint("kq-q-ratking",e,"new")},this.nenshi_questComplete=function(){if(a.game.player.data.quests.find(function(e){return"kq-q-quiz"===e.id}))a.game.player.removeQuest("kq-q-quiz"),a.game.mapWorld.removeWaypoint("kq-q-quiz-1");else{a.game.mapWorld.removeWaypoint("kq-q-quiz-0");a.game.actions.getCharacter("Naheed Nenshi").data.questNodeId=""}a.game.actions.removeFromCachedObject("Naheed Nenshi","questNodeId","kq02-calgary-01")},this.carbontree_quest_setup=function(){a.game.actions.setNewCacheObject("kq02-mountains-00",a.game.actions.createMapObjectForCache(1348,172.67,1286.67,32,32,{coords:"450,133",key:"mapChange",stage:"kq02-forest-00",type:"mapChange",questNodeId:"kq-q-carbontree-2"})),a.game.actions.setNewCacheObject("kq02-mountains-00",a.game.actions.createMapObjectForCache(1348,236.67,1286.67,32,32,{coords:"450,133",key:"mapChange",stage:"kq02-forest-00",type:"mapChange",questNodeId:"kq-q-carbontree-2"}))},this.carbontree_quest_scrum_setup=function(e){var t={character:"Doug Ford",dI:12,id:32,name:"Doug Ford",static:!0,type:"npc",key:"npc",portrait:"ford"},n=new l.NPC(a.game,1585,741,"sprites",null,t),o={character:"CBC Reporter",dI:0,id:4,name:"CBC Reporter",static:!0,type:"npc",key:"npc",staticDir:!0},i={character:"Other Reporter",dI:0,id:6,name:"Other Reporter",static:!0,type:"npc",key:"npc",staticDir:!0},r=new l.NPC(a.game,1636,949,"sprites","npc-04-mb/_01.png",o),s=new l.NPC(a.game,1604,825,"sprites","npc-06-mb/_01.png",i),h={character:"Staffer 1",dI:0,id:62,name:"Staffer 1",static:!0,type:"npc",key:"npc"},c={character:"Staffer 2",dI:0,id:62,name:"Staffer 2",static:!0,type:"npc",key:"npc"},u={character:"Staffer 3",dI:0,id:62,name:"Staffer 3",static:!0,type:"npc",key:"npc"},d=new l.NPC(a.game,1481,800,"sprites",null,h),g=new l.NPC(a.game,1716,810,"sprites",null,c),m=new l.NPC(a.game,1448,820,"sprites",null,u);a.game.NPCGroup.add(n),a.game.NPCGroup.add(r),a.game.NPCGroup.add(s),a.game.NPCGroup.add(d),a.game.NPCGroup.add(g),a.game.NPCGroup.add(m);var p={1740:"0",1872:"0",1803:"0"};a.game.actions.changeMapTiles("kq02-calgary-01","collision",p);var y={1675:"0",1807:"0",1738:"0"};a.game.actions.changeMapTiles("kq02-calgary-01","subforeground",y);var f=a.game.actions.getCharacter("Patron 2");f.position.setTo(1450,940),f.data.static=!0,a.game.player.isTalking=!0,a.game.time.events.add(1200,function(){"kenney"===e?(a.game.player.data.dI=9,n.data.dI=16,a.game.dialogue.initDialogue(null,a.game.player,!0)):"ford"===e&&a.game.dialogue.initDialogue(null,n,!1,null,!0)})},this.call_calgary_scrum=function(e){var t={1740:"2952",1872:"2952",1803:"2952"};a.game.actions.changeMapTiles("kq02-calgary-01","collision",t);var n={1675:"2951",1807:"2951",1738:"2951"};a.game.actions.changeMapTiles("kq02-calgary-01","subforeground",n),a.game.mapWorld.changeStage(null,{targetMap:"kq02-calgary-01",targetPosition:"1647,741"},function(){a.carbontree_quest_scrum_setup(e)})},this.ford_exits_scrum=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Doug Ford");a.game.actions.walkTo(e,{y:790},500,120,function(){a.game.actions.walkTo(e,{x:1763},1200,null,function(){a.game.actions.walkTo(e,{y:400},1600,600,function(){a.game.data.players.jasonKenney.crystals.length>=2&&(a.game.stageInitFunction[0]=a.call_deities_two_crystals),a.game.musicHandler.stop(),a.game.currentStage="kq02-calgary-01",a.game.currentPosition=[1560,780],a.game.state.start("Game")})})}),a.game.dialogue.alert("STAFFERS: *Clap* *clap* *clap* *clap*","acquired");var t=a.game.actions.getCharacter("Staffer 1"),n=a.game.actions.getCharacter("Staffer 2"),o=a.game.actions.getCharacter("Staffer 3");t.animations.play("celebrate"),n.animations.play("celebrate"),o.animations.play("celebrate"),a.game.time.events.add(3e3,function(){a.game.dialogue.alert("*clap* *clap* *clap* *clap*","acquired")})},this.pipeline_quest_node_2=function(){a.game.dialogue.sign("To open pipeline, insert VALVE WHEEL here. VALVE WHEELs are the responsibility of oil company representatives in Calgary. Please speak with one if you wish to obtain a VALVE WHEEL.","sign"),a.game.actions.setNewCacheObject("kq02-mountains-01",a.game.actions.createMapObjectForCache(0,834.67,1313.33,64,64,{once:!0,questNodeId:"kq-q-pipeline-4",initFunction:"place_valveWheel",type:"trigger"})),a.game.actions.setCharacterDICache("Oil Executive 2",1,"kq02-calgary-03"),a.game.actions.setCharacterDICache("Oil Executive 3",1,"kq02-calgary-03")},this.valveWheel_recovered=function(){},this.call_deities_two_crystals=function(){a.game.player.isTalking=!0,a.game.musicHandler.setMusic("kq02-pantheon-00");var e=[0,0],t=[0,0];switch(a.game.currentStage){case"kq02-calgary-01":e=[1527,764],t=[1643,763];break;case"kq02-mountains-00":e=[484,260],t=[592,262];break;case"kq02-badlands-01":e=[416,226],t=[534,227]}a.game.actions.enterDeity({character:"Margaret Thatcher",id:15,portrait:"thatcher",dI:6},e[0],e[1],"blue",!0),a.game.actions.enterDeity({character:"Ralph Klein",id:14,portrait:"klein",dI:4},t[0],t[1],"blue");a.game.player.frameName="hero-mb/_01.png"},this.return_kenney_to_base_before_edmonton=function(){a.game.musicHandler.stop(),a.game.mapWorld.changeStage(null,{targetPosition:"480,360",targetMap:"kq02-calgary-00"},a.setup_edmonton_journey)},this.before_edmonton_enter_companions=function(){},this.setup_edmonton_journey=function(){a.game.player.data.quests=[],a.game.data.players.jasonKenney.quests=[],a.game.actions.removeCacheObject("kq02-calgary-01",["key","mapChange"],["stage","kq02-mountains-00"]),a.game.actions.removeCacheObject("kq02-calgary-01",["key","mapChange"],["stage","kq02-mountains-00"]),a.game.actions.removeCacheObject("kq02-calgary-01",["key","mapChange"],["stage","kq02-mountains-00"]),a.game.actions.removeCacheObject("kq02-calgary-01",["key","mapChange"],["stage","kq02-badlands-00"]),a.game.actions.removeCacheObject("kq02-calgary-01",["key","mapChange"],["stage","kq02-badlands-00"]),a.game.atlas["kq02-calgary-01"].nodes=["kq02-calgary-00","kq02-calgary-03","kq02-caves-00"],a.game.player.data.quests=[],a.game.data.players.jasonKenney.quests=[],a.game.player.data.inventory=[],a.game.data.players.jasonKenney.inventory=[],a.game.actions.removeFromCachedObject("Brad Wall","questNodeId","kq02-calgary-03"),a.game.actions.setCharacterDICache("Brad Wall",9,"kq02-calgary-03"),a.game.actions.removeCacheObject("kq02-calgary-03",["character","Justin Trudeau"]),a.game.actions.removeFromCachedObject("Bartender","questNodeId","kq02-calgary-01"),a.game.actions.removeFromCachedObject("Don Braid","questNodeId","kq02-calgary-01");var e={x:512,y:545,properties:{character:"Derek Fildebrandt",dI:0,id:33,key:"npc",name:"Derek Fildebrandt",portrait:"fildebrandt",static:!0,type:"npc",questNodeId:"kq-q-fildebrandtpath-0"}};a.game.actions.setNewCacheObject("kq02-calgary-03",e);var t=a.game.globalAchievements.starkeConvo?3:4;a.game.actions.setCharacterDICache("Richard Starke",t,"kq02-calgary-03"),a.game.actions.addToCachedObject("Richard Starke",{questNodeId:"kq-q-starkepath-0"},"kq02-calgary-03"),a.game.actions.removeCacheObject("kq02-calgary-01",["character","Leela Aheer"],["portrait","aheer"]),a.game.actions.removeCacheObject("kq02-calgary-01",["character","Jason Nixon"],["portrait","nixon"]),a.game.actions.getCharacter("Stephen Harper").data.dI=7,a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!1)},this.enter_companions=function(){a.game.player.isTalking=!0;var e={character:"Leela Aheer",dI:0,id:31,key:"npc",name:"Leela Aheer",portrait:"aheer",static:!0,type:"npc"},t={character:"Jason Nixon",dI:0,id:17,key:"npc",name:"Jason Nixon",portrait:"nixon",static:!0,type:"npc"},n=[480,610],o=new l.NPC(a.game,n[0],n[1],"sprites","",e),i=new l.NPC(a.game,n[0],n[1],"sprites","",t);a.game.NPCGroup.add(o),a.game.NPCGroup.add(i),a.game.actions.walkTo(o,{x:330,y:400},1800,0,null,!0),a.game.actions.walkTo(i,{x:638,y:400},1800,200,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Stephen Harper"),!1)},!0)},this.choose_companion=function(e){var t=a.game.actions.getCharacter(e);a.game.data.companion=t.data,a.game.data.players.jasonKenney.hasCompanion=!0,a.game.data.companion.isCompanion=!0,a.game.data.companion.isFollowing=!1,a.game.data.companion.isFollowing=!0;var n=a.game.actions.getCharacter("Leela Aheer"),o=a.game.actions.getCharacter("Jason Nixon");n.data.dI=e===n?3:4,o.data.dI=e===o?1:2,a.game.stageInitFunction[0]=""},this.set_companion_dI=function(e){a.game.data.companion.dI=e},this.set_companion_to_follow=function(){a.game.data.companion.isFollowing=!0},this.clear_pathNodes=function(){a.game.mapWorld.removeWaypoint("kq-q-fildebrandtpath-0"),a.game.mapWorld.removeWaypoint("kq-q-starkepath-0"),a.game.actions.removeFromCachedObject("Derek Fildebrandt","questNodeId","kq02-calgary-03"),a.game.actions.removeFromCachedObject("Richard Starke","questNodeId","kq02-calgary-03")},this.fildebrandt_edmonton_path=function(){a.game.data.players.jasonKenney.quests=[],a.game.mapWorld.changeStage(null,{targetMap:"kq02-airship-00",targetPosition:"478,646"},a.set_airship_stage_1_to_launch)},this.starke_edmonton_path=function(){a.game.actions.getCharacter("Derek Fildebrandt").data.dI=1,a.game.actions.setCharacterDICache("Derek Fildebrandt",1,"kq02-calgary-03"),a.game.actions.setNewCacheObject("kq02-calgary-01",a.game.actions.createMapObjectForCache(1348,1585,530,32,32,{coords:"1055,2482",key:"mapChange",stage:"kq02-caves-00",type:"mapChange",questNodeId:"kq-q-edmontonjourney-2"})),a.game.mapWorld.createWaypoint("kq-q-edmontonjourney",a.game.stagesGroup.children[0],"active"),a.game.mapWorld.updateWaypoint("kq-q-edmontonjourney-1"),a.game.quests["kq-q-edmontonjourney"].nodes[0].complete=!0,a.clear_pathNodes()},this.edmonton_setup_pride=function(){},this.set_airship_stage_1_to_launch=function(){a.game.stageInitFunction[0]=a.setup_airship_stage_1},this.setup_airship_stage_1=function(){var e={x:608,y:930,properties:{character:"Derek Fildebrandt",dI:8,id:33,key:"npc",name:"Derek Fildebrandt",portrait:"fildebrandt",static:!0,type:"npc"}},t={x:416,y:530,properties:{character:"Max",dI:0,id:37,key:"npc",name:"Max",static:!1,type:"npc"}},n={x:350,y:1220,properties:{character:"Lloyd",dI:0,id:37,key:"npc",name:"Lloyd",static:!1,type:"npc"}},o={x:610,y:1100,properties:{character:"Hippolye the Scurvy-Ridden Taxpayer",dI:1,id:37,key:"npc",name:"Hippolye the Scurvy-Ridden Taxpayer",static:!0,type:"npc"}};new l.NPC(a.game,e.x,e.y,"sprites","",e.properties),new l.NPC(a.game,t.x,t.y,"sprites","",t.properties),new l.NPC(a.game,n.x,n.y,"sprites","",n.properties),new l.NPC(a.game,o.x,o.y,"sprites","",o.properties);a.game.dialogue.initDialogue(null,filderandt,!1)},this.edmonton_initDisguises=function(){if(a.game.data.players.jasonKenney.portrait="kenney-hipster",a.game.data.players.jasonKenney.inDisguise=!0,a.game.data.companion.hasOwnProperty("portrait")){var e=a.game.data.companion.portrait;a.game.data.companion.portrait=e+"-hipster",a.game.data.companion.dI=8,a.game.data.companion.id="aheer"===e?50:49}a.game.musicHandler.stop();var t={targetMap:a.game.currentStage,targetPosition:a.game.player.x+","+a.game.player.y};a.game.mapWorld.changeStage(null,t,a.ndp_palace02_changeStageCall_Setup)},this.ndp_palace02_changeStageCall_Setup=function(){a.game.stageDismissFunction[0]=a.ndp_palace02_changeStageCall},this.edmonton_arrival_setup_dismissFunction=function(){a.game.stageInitFunction[0]=a.edmonton_arrival_setup},this.edmonton_triggers=function(e,t,n){for(var o=t,i={initFunction:e,once:!0,type:"trigger"},r=0;r<o;r++){var s=new m.Trigger(a.game,0+64*r,n,"sprites","trigger.png",i);a.game.triggerGroup.add(s),console.log("!!!ADDING TRIGGER!!!!",s)}},this.edmonton_ndp_cutscene=function(){a.game.musicHandler.stop(),a.game.musicHandler.play("song-ndp"),a.game.player.body.velocity.set(0),a.game.player.isTalking=!0,a.game.camera.follow(null),a.game.add.tween(a.game.camera).to({x:610-a.game.camera.width/2,y:547-a.game.camera.height/2},2e3,null,!0).onComplete.add(function(){var e=a.game.actions.getCharacter("Rachel Notley");e.data.dI=7,a.game.dialogue.initDialogue(null,e,!1,null,!0)})},this.edmonton_ndp_cutscene_end=function(){a.game.player.isTalking=!0,a.game.musicHandler.stop(),a.game.musicHandler.setMusic(a.game.currentStage),a.game.camera.follow(a.game.player);var e=a.game.actions.getCompanion();e.data.dI=16,a.game.dialogue.initDialogue(null,e,!1)},this.edmonton_arrival_setup=function(){console.log("ARRIVAL SETUP FIRED!!"),a.game.NPCGroup.children.filter(function(e){return"Reveller"===e.data.character}).forEach(function(e){e.animations.play("celebrate")}),a.game.actions.getCharacter("Rachel Notley").animations.play("dance"),a.game.actions.getCharacter("Sandra Jansen").animations.play("celebrate"),a.game.actions.getCharacter("Shannon Phillips").animations.play("celebrate"),a.game.actions.getCharacter("Danielle Larivee").animations.play("celebrate"),a.game.actions.getCharacter("Shaye Anderson").animations.play("celebrate"),a.game.actions.getCharacter("David Shepherd").animations.play("celebrate"),a.game.globalAchievements.edmonton_ndp_cutscene||(a.game.globalAchievements.edmonton_ndp_cutscene=!0,a.edmonton_triggers("edmonton_ndp_cutscene",16,866))},this.finalBattle_talkToSoldier=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Dying UCP Soldier");e.frameName="npc-12-death/_01.png",a.game.time.events.add(1200,function(){a.game.actions.walkTo(a.game.player,{x:356},1e3,0,function(){a.game.dialogue.initDialogue(null,e,!1)})})},this.finalBoss_set_trigger_setup=function(){a.game.globalAchievements.finalStage=!0;var e={x:660,y:290,properties:{character:"Rachel Notley",id:16,dI:8,key:"npc",name:"Rachel Notley",portrait:"notley",static:!0,type:"npc"}};a.game.actions.setNewCacheObject("kq02-edmonton-01",e);var t={x:450,y:1340,properties:{initFunction:"invisibleHand_setup",once:!0,type:"trigger",leaveInCache:!0}};a.game.actions.setNewCacheObject("kq02-edmonton-01",t)},this.finalBoss_setStageMusic=function(){a.game.musicHandler.stop(),a.game.musicHandler.play("theme-dungeon")},this.finalBoss_launch_battle=function(){a.game.player.body.velocity.set(0),a.game.player.isTalking=!0,a.game.actions.walkTo(a.game.player,{x:a.game.world.width/2,y:300},1200,0,function(){a.game.dialogue.initDialogue(null,a.game.actions.getCharacter("Rachel Notley"),!1)})},this.finalBoss_endCutscene=function(){var e=a.game.enemyGroup.children[0];a.game.bossFight=new c.BossFight(a.game,e,"invisible-hand"),a.game.objGroup.children[0].destroy(),e.startBattle()},this.finalBoss_lungeForCrystal=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Rachel Notley");e.animations.play("show-crystal"),a.game.sfx.play("sfx_sword_shine"),a.game.time.events.add(600,function(){var t=a.game.add.tween(a.game.player.position).to({x:e.x-38,y:e.y},400,Phaser.Easing.Quadratic.In,!0);t.onComplete.add(function(){t.onComplete.removeAll(),a.game.player.animations.play("attack-left"),a.game.sfx.play("sfx_break"),e.frameName="npc-16-mf/_01.png";var n=a.game.add.graphics();n.beginFill(16777215,1),n.drawRect(0,0,a.game.camera.width,a.game.camera.height),n.endFill(),n.alpha=0,n.fixedToCamera=!0,a.game.world.add(n),a.game.flash(n,!0),a.game.time.events.add(700,function(){n.destroy(),t.to({x:a.game.world.width/2,y:300},400,Phaser.Easing.Quadratic.Out,!0),a.game.add.tween(e.position).to({x:800},150,null,!0),a.game.enemyGroup.children[0].destroy(),a.game.enemyGroup.children[0].destroy(),a.game.enemyGroup.children[0].destroy(),t.onComplete.addOnce(function(){a.game.camera.follow(null),a.game.dialogue.initDialogue(null,e,!1)})})})})},this.finalBoss_notleyRuns=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Rachel Notley");a.game.add.tween(e.position).to({y:a.game.camera.height+36},650,null,!0).onComplete.addOnce(function(){e.destroy();var t={data:{name:"The Invisible Hand",dI:2,character:"The Invisible Hand"}};a.game.dialogue.initDialogue(null,t,!1)})},this.finalBoss_restart=function(){},this.end_invisibleHand_bossFight=function(e){e.death(),a.game.add.tween(e.position).to({x:a.game.world.width/2,y:a.game.camera.height/2},1200,Phaser.Linear,!0).onComplete.add(function(){e.body.velocity.set(0),a.game.camera.shake(.0025,3e3);var t=a.game.add.graphics();t.beginFill(16777215,1),t.drawRect(0,0,a.game.camera.width,a.game.camera.height),t.endFill(),t.alpha=0,t.fixedToCamera=!0,a.game.world.add(t),a.game.add.tween(t).to({alpha:1},3e3,Phaser.Linear,!0).onComplete.add(function(){a.game.time.events.stop(e.explosionTimer),a.end_determine_ending()})})},this.end_determine_ending=function(){},this.invisibleHand_setup=function(e,t,n){var o=e||482,i=t||1340;"kq02-edmonton-01"===a.game.currentStage&&(o=482,i=190,a.edmonton_triggers("finalBoss_launch_battle",14,530));var r=void 0!==n?n:0;console.log("RUNNING HAND SETUP");var s=a.game.add.graphics(o,i-30);s.beginFill(0,.35),s.drawCircle(0,0,120),s.endFill(),a.game.add.tween(s).to({height:180,width:180},2200,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0);var l=a.game.add.graphics(o,i-100);l.beginFill(15690515,.65),l.drawCircle(0,0,300),l.endFill(),a.game.add.tween(l).to({height:260,width:260},2200,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0);var h=a.game.add.graphics(o,i-100);h.beginFill(15894593,.35),h.drawCircle(0,0,330),h.endFill(),a.game.add.tween(h).to({height:300,width:300},1600,Phaser.Easing.Linear.None,!0,50,-1).yoyo(!0);var c=new d.InvisibleHand(a.game,o,i,"bosses-atlas",null,r);c.tweens={},c.tweens.handTween=a.game.add.tween(c.position).to({y:i+15},2200,Phaser.Easing.Linear.None,!0,0,-1),c.tweens.handTween.yoyo(!0),c.animations.play("prone"),a.game.enemyGroup.add(s),a.game.enemyGroup.add(l),a.game.enemyGroup.add(h),a.game.enemyGroup.add(c)},this.edmonton_jerseyAcquireFromSimons=function(){a.game.player.hasItem("Oilers jersey")||(a.edmonton_acquireJersey(),a.game.player.addQuest("kq-q-jersey",!0),a.game.mapWorld.createWaypoint("kq-q-jersey",a.game.stagesGroup.children[0],"active"))},this.edmonton_addFrontGateTileData=function(){a.game.actions.getCharacter("Noah").data.questNodeId="",a.game.actions.removeFromCachedObject("Noah","questNodeId","kq02-edmonton-00"),a.game.stagesGroup.children[1].data.questNodeId="kq-q-environment-3",a.game.stagesGroup.children[1].data.initFunction=a.edmonton_setPalaceArrival;var e={questNodeId:"kq-q-environment-3",coords:"465,1800",key:"mapChange",stage:"kq02-palace-00",type:"mapChange",initFunction:a.edmonton_setPalaceArrival};a.game.stagesGroup.children[0].destroy(),a.game.actions.setMapChangeProps("kq02-palace-00",e,"kq02-edmonton-00"),a.game.mapWorld.updateWaypoint("kq-q-environment-2");var t=a.game.actions.getCharacter("Deron Bilous"),n=a.game.actions.getCharacter("Joe Ceci");t.data.dI=5,n.data.dI=5,a.game.actions.setDICache(t,a.game.currentStage),a.game.actions.setDICache(n,a.game.currentStage)},this.edmonton_talkToNoah=function(e){a.game.actions.getCharacter("Noah").data.dI=e,a.game.mapWorld.updateWaypoint("kq-q-environment-2")},this.edmonton_createWellEntrance=function(){a.game.actions.removeCacheObject("kq02-edmonton-00",["character","Noah"],["type","npc"]);var e={coords:"261,383",key:"mapChange",stage:"kq02-palace-00",type:"mapChange",questNodeId:"kq-q-environment-3",initFunction:a.edmonton_setPalaceArrival},t=a.game.actions.createMapObjectForCache(1348,610,1410,32,32,e);a.game.actions.setNewCacheObject("kq02-edmonton-00",t),a.edmonton_setupPalace(),a.game.musicHandler.stop(),a.game.startingPosition=[a.game.player.x,a.game.player.y],a.game.state.start("Game")},this.edmonton_setPalaceArrival=function(){a.game.NPCGroup.children.forEach(function(e){return e.kill()}),a.game.enemyGroup.children.forEach(function(e){return e.kill()}),a.game.stagesGroup.children.forEach(function(e){return e.kill()}),a.game.mapWorld.createWaypoint("kq-q-environment",a.game.objGroup.children[1],"active"),a.invisibleHand_setup()},this.edmonton_clearPalaceGate=function(){a.game.player.isTalking=!0;var e=a.game.actions.getCharacter("Joe Ceci"),t=a.game.actions.getCharacter("Deron Bilous");a.game.actions.walkTo(e,{x:a.game.world.width+32},1600,200,function(){e.kill(),a.game.player.isTalking=!1}),a.game.actions.walkTo(t,{x:-32},1600,200,function(){t.kill()}),a.edmonton_setupPalace()},this.edmonton_setupPalace=function(){a.game.cache.getTilemapData("kq02-palace-00").data.layers[4].objects.push({x:450,y:1041,properties:{objectType:"crystalHolder",type:"object"}}),a.game.cache.getTilemapData("kq02-palace-00").data.layers[4].objects.push({x:454,y:1030,properties:{itemFunction:"edmonton_acquireSocialLicenseCrystal",message:"Crystal of Compassion and Social License",objectType:"sign",type:"object",questNodeId:"kq-q-environment-4"}})},this.edmonton_acquireEdmontonCrystal=function(){},this.edmonton_acquireSocialLicenseCrystal=function(){a.game.player.isTalking=!0,a.game.player.body.velocity.set(0),a.game.objGroup.children[1].children[0].kill(),a.game.player.crystalAcquired("Crystal of Compassion and Social License",function(){var e=a.game.actions.getCompanion();e.data.dI=12,a.game.dialogue.initDialogue(null,e,!1)})},this.takeEdmontonQuest=function(e){if("kq-q-avocadotoast"===e){var t=a.game.actions.getCharacter("Brewpub Owner");t.data.dI=1,a.game.actions.setDICache(t,"kq02-edmonton-00"),a.game.actions.addToCachedObject("Ravi, Leader of all Millennials",{questNodeId:"kq-q-avocadotoast-3"},"kq02-edmonton-00"),a.game.player.addQuest(e),a.game.mapWorld.updateWaypoint("kq-q-avocadotoast-1")}else"kq-q-environment"===e&&a.game.player.addQuest(e)},this.marchToWar_start=function(){a.game.musicHandler.stop(),a.game.musicHandler.play("marchToWar"),a.game.globalAchievements.marchToWar=!0,a.game.stage.disableVisibilityChange=!0;var e=a.game.actions.getCharacter("Preston Manning");e.data.dI=5,a.game.actions.walkTo(e,{x:460,y:360},700,100,function(){a.game.dialogue.initDialogue(null,e,!1,!0,!0)},!0)},this.marchToWar_scene0_end=function(){a.game.currentStage="kq02-calgary-01",a.game.currentPosition=0,a.game.stageInitFunction[0]=a.marchToWar_scene1_start,a.game.actions.removeCacheObject("kq02-calgary-01",["character","Empress Bovina"]),a.game.camera.onFadeComplete.removeAll(),a.game.state.start("Game")},this.marchToWar_switchScene=function(e,t){a.game.camera.x=e||0,a.game.camera.y=t||0},this.marchToWar_scene1_start=function(){a.game.player.isTalking=!0,a.game.player.alpha=0,a.game.camera.follow(null),a.marchToWar_switchScene(a.game.world.width/2-a.game.camera.width/2-150),a.game.add.tween(a.game.camera).to({x:1400},7600,null,!0),a.game.musicHandler.setVolume(.5),a.game.sfx.play("sfx_horn"),a.game.time.events.add(8e3,function(){a.marchToWar_scene1_end()})},this.marchToWar_scene1_end=function(){a.game.currentStage="kq02-calgary-03",a.game.stageInitFunction[0]=a.marchToWar_scene2_start,a.game.state.start("Game")},this.marchToWar_scene2_start=function(){a.game.player.isTalking=!0,a.game.player.alpha=0,a.game.camera.follow(null),a.marchToWar_switchScene(20,700),a.game.sfx.play("sfx_horn"),a.game.add.tween(a.game.camera).to({y:480},6800,null,!0),a.game.time.events.add(7e3,function(){a.marchToWar_scene2_end()})},this.marchToWar_scene2_end=function(){a.game.currentStage="kq02-calgary-02",a.game.stageInitFunction[0]=a.marchToWar_scene3_start,a.game.state.start("Game")},this.marchToWar_scene3_start=function(){a.game.player.isTalking=!0,a.game.player.alpha=0,a.game.camera.follow(null),a.marchToWar_switchScene(0,780),a.game.sfx.play("sfx_horn"),a.game.add.tween(a.game.camera).to({x:200,y:600},6300,null,!0),a.game.time.events.add(6500,function(){a.marchToWar_scene3_end()})},this.marchToWar_scene3_end=function(){a.game.currentCharacter="rachelNotley",a.game.musicHandler.setVolume(1),a.game.currentStage="kq02-palace-00",a.game.stageInitFunction[0]=a.marchToWar_scene4_start,a.game.state.start("Game")},this.marchToWar_scene4_start=function(){a.marchToWar_switchScene(42,120),a.game.player.position.set(a.game.camera.width/2,400);var e=a.game.actions.getCharacter("Joe Ceci");void 0!==e&&(e.data.dI=7,a.game.actions.walkTo(e,{x:420,y:410},800,1200,function(){a.game.dialogue.initDialogue(null,e,!1,!0)}))},this.marchToWar_scene4_end=function(){a.game.currentCharacter="jasonKenney",a.game.currentStage="kq02-battle-00",a.game.stageInitFunction[0]=a.marchToWar_scene5_start,a.game.state.start("Game")},this.marchToWar_scene5_start=function(){a.game.player.position.set(a.game.world.width/2,245),a.game.player.isTalking=!0,a.game.player.data.dI=10,a.game.time.events.add(1100,function(){a.game.dialogue.initDialogue(null,a.game.player,!1,!0)})},this.marchToWar_scene5_mountCar=function(){a.game.player.isTalking=!0,a.game.actions.walkTo(a.game.player,{x:406,y:170},700,400,function(){a.game.time.events.add(500,function(){a.game.player.alpha=0;var e=a.game.objGroup.children[0];e.animations.play("drive-up"),a.game.add.tween(e.position).to({y:-300},1800,Phaser.Easing.Quadratic.In,!0).onComplete.add(function(){a.marchToWar_scene5_end()})})})},this.marchToWar_scene5_end=function(){a.game.stageInitFunction[0]="",a.game.state.start("Battle")},this.battleSequence_scene1=function(){a.game.battleScene=2,a.game.time.events.add(500,function(){a.game.player.data.dI=11,a.game.dialogue.initDialogue(null,a.game.player,!1,!0,!0)})},this.battleSequence_scene2=function(){a.game.battleScene=3;var e=a.game.world.children[4],t=a.game.world.children[5];e.position.y=-500,t.position.y=a.game.camera.height;a.game.add.tween(e.position).to({y:0},10500,null,!0),a.game.add.tween(t.position).to({y:a.game.camera.height/2-200},10500,null,!0);a.game.time.events.add(4e3,function(){a.game.camera.fade(16777215,4600)}),a.game.camera.onFadeComplete.addOnce(function(){a.game.time.events.add(600,function(){a.intermission_setup()})})},this.intermission_setup=function(){a.game.currentStage="kq02-edmonton-00",a.game.stageInitFunction[0]=a.intermission_start,a.game.state.start("Game")},this.intermission_start=function(){a.game.globalAchievements.marchToWar=!1,a.game.musicHandler.stop(),a.game.musicHandler.play("intermission"),a.game.player.alpha=0;var e=a.game.actions.getCharacter("Paula Simons");a.game.player.position.set(e.x,e.y),a.game.camera.follow(e),a.game.time.events.add(1e3,function(){e.data.dI=30,a.game.dialogue.initDialogue(null,e,!1,!1,!0)})},this.game=t}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Ball=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return e.physics.arcade.enable(h),h.body.immovable=!0,h.body.onCollide=new Phaser.Signal,h.parent=l,h.frameName="ball.png",h.body.setSize(10,10,0,0),h.anchor.setTo(.5),h.swingRadius=0,h.swingPeriod=.012,h.isSwinging=!1,h.currentState="_RESTING",h.chain=h.game.add.graphics(0,0),h.chain.lineStyle(1,0,1),h.chain.moveTo(h.parent.x,h.parent.y),h.chain.lineTo(h.parent.x+h.x,h.parent.y+h.y),h}return i(t,e),r(t,[{key:"update",value:function(){}},{key:"swing",value:function(){this.currentState="_SWINGING"}},{key:"stopSwinging",value:function(){this.currentState="_RESTING",this.game.sfx.stop("sfx_ball"),this.ball.isSwinging=!1}},{key:"updateChain",value:function(){this.chain.clear(),this.chain.lineStyle(1,0,1),this.chain.moveTo(this.parent.x+11,this.parent.y-10),this.chain.lineTo(this.parent.x+this.x,this.parent.y+this.y)}},{key:"playerHit",value:function(){var e=this;this.game.player.isHit||"_SWINGING"!==this.currentState||(console.log("PLAYER STRUCK!!!!"),this.game.player.damage(1),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.calcHitDirection(this.game.player,null),this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player),this.game.time.events.add(200,function(){e.game.player.body.velocity.setTo(0),e.game.time.events.add(500,function(){e.game.player.isHit=!1})}))}},{key:"calcHitDirection",value:function(e,t){switch(null===t&&(t=this.faceDirection(this.game.player.x,this.game.player.y,!0)),t){case"right":e.body.velocity.set(this.game.player._STRIKE_VELOCITY,0);break;case"backward":e.body.velocity.set(0,-this.game.player._STRIKE_VELOCITY);break;case"forward":e.body.velocity.set(0,this.game.player._STRIKE_VELOCITY);break;case"left":e.body.velocity.set(-this.game.player._STRIKE_VELOCITY,0)}}},{key:"faceDirection",value:function(e,t,a){var n=this.game.physics.arcade.angleToXY(this.parent,e,t);if(n>-.785&&n<.785){if(a)return"right"}else if(n>.785&&n<2.356){if(a)return"forward"}else if(n<-.785&&n>-2.356){if(a)return"backward"}else if((n>-2.356||n<-2.356)&&a)return"left"}},{key:"rest",value:function(){this.x=12,this.y=0}},{key:"swing",value:function(){this.swingRadius=this.game.rnd.integerInRange(30,60),this.currentState="_SWINGING"}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Bullet=function(e){function t(e,a,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return h.game=e,h.game.add.existing(h),h.game.physics.arcade.enable(h),h.body.immovable=!0,h.body.onCollide=new Phaser.Signal,h.frameName="bullet.png",h.speed=220,h.body.setSize(5,5,0,0),h.anchor.setTo(.5),h.outOfBoundsKill=!0,h.checkWorldBounds=!0,h}return i(t,e),r(t,[{key:"hitPlayer",value:function(){var e=this;this.kill(),this.game.player.isHit||(console.log("PLAYER STRUCK BY BULLET!!!!"),this.game.player.damage(1),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.calcHitDirection(this.game.player,null),this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player),this.game.time.events.add(120,function(){e.game.player.body.velocity.setTo(0),e.game.time.events.add(500,function(){e.game.player.isHit=!1})}))}},{key:"calcHitDirection",value:function(e,t){switch(null===t&&(t=this.faceDirection(this.game.player.x,this.game.player.y,!0)),t){case"right":e.body.velocity.set(this.game.player._STRIKE_VELOCITY,0);break;case"backward":e.body.velocity.set(0,-this.game.player._STRIKE_VELOCITY);break;case"forward":e.body.velocity.set(0,this.game.player._STRIKE_VELOCITY);break;case"left":e.body.velocity.set(-this.game.player._STRIKE_VELOCITY,0)}}},{key:"faceDirection",value:function(e,t,a){var n=this.game.physics.arcade.angleToXY(this.parent,e,t);if(n>-.785&&n<.785){if(a)return"right"}else if(n>.785&&n<2.356){if(a)return"forward"}else if(n<-.785&&n>-2.356){if(a)return"backward"}else if((n>-2.356||n<-2.356)&&a)return"left"}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Fireball=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2);t.Fireball=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5],h=arguments[6],c=arguments[7];n(this,t);var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s));return u.rndLife=null,u.lifeTimer=null,console.log("FIREBALL GENERATED!!!"),u.game=e,u.game.add.existing(u),u.game.physics.arcade.enable(u),u.body.immovable=!0,u.body.onCollide=new Phaser.Signal,u.canDropItem=c||!1,u.speed=l||240,u.body.setSize(24,16,0,0),u.exploding=!1,u.anchor.setTo(.5),u.outOfBoundsKill=!0,u.checkWorldBounds=!0,u.animations.add("fire",Phaser.Animation.generateFrameNames("fireball_",0,2,".png"),5,!0),u.animations.add("explode",Phaser.Animation.generateFrameNames("explosion-01/_",1,16,".png"),16,!1),u.animations.play("fire"),h?u.lifeTimer=h:u.timerReset(),u}return i(t,e),r(t,[{key:"timerReset",value:function(e){this.rndLife=e||this.setRndLife(),0!==this.rndLife&&(this.lifeTimer=this.game.time.events.add(this.rndLife,this.explode,this))}},{key:"explode",value:function(){var e=this;this.game.sfx.play("sfx_fireballExplode"),this.exploding=!0,this.game.physics.arcade.moveToXY(this,this.x,this.y,0),this.body.setSize(0,0,0,0),this.canDropItem&&this.dropItem(),this.animations.play("explode").onComplete.add(function(){e.kill()})}},{key:"dropItem",value:function(){Phaser.Utils.chanceRoll(15)&&this.generateItem("health",this.position)}},{key:"generateItem",value:function(e,t){var a=e||"health",n=null;if("health"===a){n=Phaser.Utils.chanceRoll(20)?Phaser.Utils.chanceRoll(30)?"super-health":"uber-health":"health"}var o={class:a,key:"powerup",subClass:n,type:"pickup"};new s.PickupItem(this.game,t.x,t.y,"sprites",n,o,!0)}},{key:"setRndLife",value:function(){return Phaser.Utils.chanceRoll(50)?this.game.rnd.integerInRange(400,1e3):0}},{key:"hitPlayer",value:function(){this.exploding||(this.playerHit(),this.explode())}},{key:"playerHit",value:function(){var e=this;if(!this.game.player.isHit){this.game.player.damage(1),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.game.player.body.velocity.setTo(0,600),this.game.player.isTalking=!0,this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player);this.game.time.events.add(100,function(){e.game.player.isTalking=!1,e.game.player.body.velocity.setTo(0);e.game.time.events.add(700,function(){e.game.player.isHit=!1})})}}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuestsButton=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(51),l=a(0),h=function(e){return e&&e.__esModule?e:{default:e}}(l);t.QuestsButton=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites";n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.questTween=null,l.selectedQuest=null,l.callQuestDialogue=function(){l.game.player.inventoryActive&&l.game.inventoryButton.initInventory(!0),l.questTween=l.game.add.tween(l.questDialogue.questWindow.scale).to({x:1,y:1},200,"Quad.easeOut").start(),l.game.sfx.play("sfx_menuUp"),l.emit("questsEngaged"),l.game.player.questsActive=!0,l.keyLeft=l.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),l.keyLeft.onDown.add(l.questDialogue.moveSelectionLeft,l),l.keyRight=l.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),l.keyRight.onDown.add(l.questDialogue.moveSelectionRight,l),l.questTween.onComplete.add(function(){l.questDialogue.displayQuestItems()})},l.dismissQuestDialogue=function(e){l.game.questGroup.visible=!1,l.keyLeft.onDown.remove(l.questDialogue.moveSelectionLeft,l),l.keyRight.onDown.remove(l.questDialogue.moveSelectionRight,l),l.questDialogue.bulletsGroup.forEach(function(e){return e.destroy()}),l.emit("questsClosed"),e?(l.questDialogue.questWindow.scale.setTo(0),l.game.player.questsActive=!1):(l.questsTween=l.game.add.tween(l.questDialogue,questWindow.scale).to({x:0,y:0},200,"Quad.easeOut").start(),l.questsTween.onComplete.add(function(){l.game.player.questsActive=!1,l.game.player.isTalking=!1,l.emit("questsClosed")}))},l.game=e,e.add.existing(l),l.anchor.setTo(.5),l.inputEnabled=!0,l.input.useHandCursor=!0,l.fixedToCamera=!0,l.data.open=!1,l.frameName="ui-quill-open.png",l.scale.setTo(.88),l.questDialogue=new s.QuestsDialogue(l.game),h.default.mixin(l),l.questTween=l.game.add.tween(l.questDialogue.questWindow.scale),l.events.onInputDown.add(l.initQuests,l),l}return i(t,e),r(t,[{key:"initQuests",value:function(e){this.questTween.isRunning||this.game.inventoryButton.inventoryTween.isRunning||this.game.player.isTalking||(this.data.open?(this.data.open=!1,this.frameName="ui-quill-open.png",this.dismissQuestDialogue(e)):(this.data.open=!0,this.frameName="ui-quill-close.png",this.callQuestDialogue()))}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.QuestsDialogue=void 0;var o=a(53);t.QuestsDialogue=function e(t){var a=this;n(this,e),this.xPos=50,this.yPos=140,this.xSpacing=175,this.bulletGrey="0x515151",this.displayQuestItems=function(){a.bulletsGroup=[],a.quests=a.game.player.data.quests,0===a.quests.length?a.setEmptyQuestList():(a.currentSelectedQuest=0,a.arrowLeft.alpha=.25,a.quests.length<2?a.arrowRight.alpha=.25:a.arrowRight.alpha=1,a.quests.length<2&&(a.arrowRight.alpha=.25),a.questsNum=a.quests.length,console.log("CURRENT QUESTS NUMBER IS "+a.questsNum),a.setBullets(),a.updateText()),a.game.questGroup.visible=!0},this.setBullets=function(){a.quests.forEach(function(e,t){var n=a.game.add.graphics(a.xPos+20*t,152);n.beginFill(a.bulletGrey),n.drawCircle(0,0,10),n.endFill(),n.fixedToCamera=!0,a.bulletsGroup.push(n),console.log("NEW BULLET:",n)})},this.moveSelectionRight=function(){console.log("moving right"),console.log(a.questsNum),a.currentSelectedQuest!==a.questsNum-1&&(console.log("CURRENT QUESTS NUMBER IS "+a.questsNum),a.currentSelectedQuest++,a.game.sfx.play("sfx_menuMove"),a.updateText(),a.updateArrows())},this.moveSelectionLeft=function(){console.log("moving left"),a.currentSelectedQuest>0&&(a.currentSelectedQuest--,a.game.sfx.play("sfx_menuMove"),a.updateText(),a.updateArrows())},this.setEmptyQuestList=function(){a.questText.text="You have no active quests",a.questText.anchor.setTo(.5),a.questText.cameraOffset.x=a.game.camera.width/2,a.arrowLeft.visible=!1,a.arrowRight.visible=!1,a.questCurrentNodeIcon.visible=!1},this.updateArrows=function(){a.currentSelectedQuest===a.questsNum-1?a.arrowRight.alpha=.25:a.arrowRight.alpha=1,0===a.currentSelectedQuest?a.arrowLeft.alpha=.25:a.arrowLeft.alpha=1},this.updateText=function(){a.bulletsGroup.forEach(function(e){console.log("BullET GROUP ITEM"),e.beginFill(a.bulletGrey),e.drawCircle(0,0,10),e.endFill()}),console.log("current quest is "+a.currentSelectedQuest);var e=a.bulletsGroup[a.currentSelectedQuest];e.beginFill("0xf2d337"),e.drawCircle(0,0,10),e.endFill(),console.log(e,"currentSelectionQuest is "+a.currentSelectedQuest),a.arrowLeft.visible=!0,a.arrowRight.visible=!0,a.questCurrentNodeIcon=!0,a.questTitleText.text=a.quests[a.currentSelectedQuest].name.toUpperCase(),a.questText.anchor.setTo(0,0),a.questText.cameraOffset.x=a.xPos,a.questText.text=a.quests[a.currentSelectedQuest].desc;for(var t=a.quests[a.currentSelectedQuest].nodes,n=0,o=0;o<t.length;o++)console.log(t[o].complete),!1===t[o].complete&&(n=o,o=t.length);a.questCurrentNodeText.text=a.quests[a.currentSelectedQuest].nodes[n].desc},this.game=t,this.winW=this.game.camera.width-42,this.winH=this.game.camera.height-160,this.questWindow=this.game.add.graphics(this.game.camera.width/2+21,this.game.camera.height/2+30),this.questWindow.lineStyle(2,16777215,1),this.questWindow.beginFill("#000",.75),this.questWindow.drawRoundedRect(-this.game.camera.width/2,-this.winH/2,this.winW,this.winH,15),this.questWindow.fixedToCamera=!0,this.questWindow.anchor.setTo(.5),this.questWindow.scale.setTo(0),this.game.questGroup=this.game.add.group(),this.arrowRight=new o.ArrowButton(this.game,this.winW-40,140,"sprites","ui-arrow-right.png"),this.arrowLeft=new o.ArrowButton(this.game,this.winW-120,140,"sprites","ui-arrow-left.png"),this.game.questGroup.add(this.arrowRight),this.game.questGroup.add(this.arrowLeft),this.arrowRight.events.onInputDown.add(this.moveSelectionRight,this),this.arrowLeft.events.onInputDown.add(this.moveSelectionLeft,this),this.questTitleText=this.game.add.bitmapText(this.xPos,this.game.camera.height-this.game.camera.height/1.55,"VT323","",42),this.questTitleText.maxWidth=this.game.camera.width-80,this.questTitleText.fixedToCamera=!0,this.game.questGroup.add(this.questTitleText),this.questText=this.game.add.bitmapText(this.xPos,this.game.camera.height-this.game.camera.height/1.75,"VT323","",36),this.questText.fixedToCamera=!0,this.questText.maxWidth=this.game.camera.width-80,this.game.questGroup.add(this.questText),this.questCurrentNodeText=this.game.add.bitmapText(this.xPos+68,this.game.camera.height-this.game.camera.height/3.1,"VT323","",32),this.questCurrentNodeText.fixedToCamera=!0,this.questCurrentNodeText.maxWidth=this.game.camera.width-160,this.game.questGroup.add(this.questCurrentNodeText),this.questCurrentNodeIcon=this.game.add.sprite(this.xPos,this.game.camera.height-this.game.camera.height/3.1-8,"sprites","ui-waypoint-active.png"),this.questCurrentNodeIcon.fixedToCamera=!0,this.questCurrentNodeIcon.scale.setTo(.88),this.game.questGroup.add(this.questCurrentNodeIcon),this.game.questGroup.visible=!1,this.quests=this.game.player.data.quests,this.questsNum=this.quests.length,this.currentSelectedQuest=0,this.bulletsGroup=[]}},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RatKing=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(0),l=function(e){return e&&e.__esModule?e:{default:e}}(s),h=a(19),c=a(12);t.RatKing=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],h=arguments[5];n(this,t);var c=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,h));return c.combatActive=!1,c.attackTimer=null,c.moveTimer=null,c.movePauseTimer=null,c.pauseTimer=null,e.add.existing(c),c.game=e,e.physics.arcade.enable(c),c.body.immovable=!0,c.body.onCollide=new Phaser.Signal,c.data=h,l.default.mixin(c),c.targetPos={x:c.game.player.x,y:c.game.player.y},c.cW=c.game.camera.width,c.cH=c.game.camera.height,c.anchor.setTo(.5,.9),c.body.setSize(300,192,-150,0),c.currentState="_PAUSED",c.maxHealth=20,c.health=1,c.speed=320,c.direction=1,c.isType="BOSS",c.engageDistance=100,c.animations.add("move",Phaser.Animation.generateFrameNames("move/_0",1,2,".png"),6,!0),c.animations.add("attack",Phaser.Animation.generateFrameNames("attack/_0",1,2,".png"),6,!0),c.frameName="move/_01.png",c.cameraBounds=!0,c.create_top_boundary(),c}return i(t,e),r(t,[{key:"create_top_boundary",value:function(){var e=this.game.add.sprite(0,160,"sprites","trigger.png");this.game.physics.arcade.enable(e),e.body.immovable=!0,e.body.onCollide=new Phaser.Signal,e.body.setSize(this.game.camera.width,32),this.game.objGroup.add(e)}},{key:"setSignal",value:function(){this.signal=new c.ProjectileSignal(this.game,this.x-10,this.y,this,this),this.addChild(this.signal)}},{key:"setState",value:function(e){this.currentState=e,console.log("RAT KING:",e)}},{key:"update",value:function(){this.scale.x=-this.direction,this.x<=55&&(this.direction=1),this.x>=870&&(this.direction=-1),"_PAUSED"!==this.currentState&&"_MOVING"===this.currentState&&(this.body.velocity.set(this.speed*this.direction,0),this.combatActive)}},{key:"dramaticEntrance",value:function(e){var t=this.game.add.tween(this.position).to({y:180},1300,Phaser.Easing.Bounce.Out,!0,200);
//! sfx fall
this.game.add.tween(this.game.player.position).to({y:500},600,Phaser.Easing.Quadratic.InOut,!0,300),t.onComplete.add(e)}},{key:"scream",value:function(e,t){this.game.sfx.play("sfx_ratDeath"),this.frameName="attack/_01.png",this.game.camera.shake(.006,700),this.game.camera.onShakeComplete.addOnce(t)}},{key:"hit",value:function(){this.emit("bossHit")}},{key:"setMoveTimer",value:function(e){e||(e=this.setTime()),this.direction=Phaser.Utils.randomChoice(1,-1),this.setState("_MOVING"),this.moveTimer=this.game.time.events.add(e,this.stop,this)}},{key:"setAttackTimer",value:function(e,t){var a=this;this.animations.play("move"),console.log("ATTACK TIMER FIRED!!!"),e||(e=this.setDelay()),t||(t=this.toxicBall),this.attackTimer=this.game.time.events.add(e,function(){a.setAttackSignal(t)},this)}},{key:"setAttackSignal",value:function(e){this.signal.sig(e)}},{key:"stop",value:function(){this.body.velocity.set(0),this.setState("_PAUSED"),this.movePauseTimer=this.game.time.events.add(this.setPauseTime(),this.setMoveTimer,this)}},{key:"toxicBall",value:function(e){var t=e||this;t.animations.play("attack"),t.game.time.events.add(100,function(){t.createToxicball(),t.game.sfx.play("sfx_fireball"),t.game.time.events.add(400,function(){t.setAttackTimer()})})}},{key:"setTime",value:function(){return this.game.rnd.integerInRange(400,1500)}},{key:"setPauseTime",value:function(){return this.game.rnd.integerInRange(1500,3200)}},{key:"setDelay",value:function(){return this.game.rnd.integerInRange(500,1800)}},{key:"createToxicball",value:function(){var e=Phaser.Utils.chanceRoll(20),t=this.game.projectileGroup.getFirstExists(!1);t?(e?(t.speed=140,t.timerReset(this.bombTimer()),t.isBomb=!0):(t.speed=300,t.isBomb=!1,t.timerReset()),t.inBombMode=!1,t.aboutToExplode=!1,t.reset(this.x,this.y+13),t.exploding=!1,t.body.setSize(16,16,0,0),t.animations.play("fire")):(t=e?new h.Toxicball(this.game,this.x,this.y+13,"sprites",null,140,this.bombTimer(),!0,!0):new h.Toxicball(this.game,this.x,this.y+13,"sprites",null,300,null,!0,!1),this.game.projectileGroup.add(t)),t.origin=this,this.game.sfx.play("sfx_fireball"),this.game.physics.arcade.moveToXY(t,this.game.player.x,this.game.player.y,t.speed)}},{key:"bombTimer",value:function(){return this.game.rnd.integerInRange(300,700)}},{key:"playerHit",value:function(){var e=this;if(!this.game.player.isHit){this.game.player.damage(2),this.game.player.isHit=!0,this.game.player.currentState="_NEUTRAL",this.game.player.isAttacking=!1,this.game.player.body.velocity.setTo(0,600),this.game.player.isTalking=!0,this.game.healthPanel.playerHit(this.game.player.health),this.game.flash(this.game.player);this.game.time.events.add(300,function(){e.game.player.body.velocity.setTo(0),e.game.player.isTalking=!1;e.game.time.events.add(1e3,function(){e.game.player.isHit=!1})})}}}]),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});t.ArrowButton=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments[3],s=arguments[4];n(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r));return l.game=e,l.frameName=s,l.inputEnabled=!0,l.input.useHandCursor=!0,l.fixedToCamera=!0,l}return i(t,e),t}(Phaser.Sprite)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.Waypoint=function(e){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sprites",s=arguments[4],l=arguments[5];n(this,t);var h=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,i,r,s,l));return h.returnAngle=function(){var e=h.game.player.position,t=h.data.target.position;return Phaser.Math.radToDeg(Phaser.Math.angleBetweenPoints(e,t))},h.returnX=function(){var e=h.game.camera.x+24,t=e+h.game.camera.width-48,a=h.data.target.x;return e>a?e:a>e&&t>a?a:t},h.returnY=function(){var e=h.game.camera.y+24,t=e+h.game.camera.height-48,a=h.data.target.y;return e>a?e:a>e&&t>a?a:t},h.activate=function(){h.data.status="active",h.animations.play("active-waypoint")},h.game=e,h.frameName=s,h.data=l,h.questId=l.questId,h.anchor.setTo(0,.5),h.animations.add("new-waypoint",Phaser.Animation.generateFrameNames("ui-waypoint-new-0",1,7,".png"),8,!0),h.animations.add("active-waypoint",Phaser.Animation.generateFrameNames("ui-waypoint-active-onscreen-0",1,7,".png"),8,!0),"new"===h.data.status?(h.y=i-56,h.animations.play("new-waypoint")):"active"===h.data.status&&(h.y=i-56,h.animations.play("active-waypoint")),h}return i(t,e),r(t,[{key:"update",value:function(){this.visible&&null!==this.data.target&&(this.data.target.inCamera?(this.angle=0,this.anchor.setTo(0,.5),this.position.setTo(this.data.target.x-18,this.data.target.y-56)):(this.anchor.setTo(.5),this.frameName="ui-waypoint-"+this.data.status+".png",this.position.setTo(this.returnX(),this.returnY()),this.angle=this.returnAngle()-90))}}]),t}(Phaser.Sprite)},,function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BattleState=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(1),h=(n(l),a(0)),c=(n(h),a(9)),u=a(4),d=(a(8),a(5)),g=a(10),m=a(3);a(11),t.BattleState=function(e){function t(){var e,a,n,r;o(this,t);for(var s=arguments.length,l=Array(s),h=0;h<s;h++)l[h]=arguments[h];return a=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.fadeScreen=null,n.ndpGroup=null,n.ucpGroup=null,n.fadeScreen=null,n.bg=null,n.update=function(){1===n.game.battleScene?(n.bg.tilePosition.y-=2,n.dragon.visible=!0,n.ndpGroup.visible=!0,n.ucpGroup.visible=!1):2===n.game.battleScene?(n.bg.tilePosition.y+=2,n.dragon.visible=!1,n.ndpGroup.visible=!1,n.ucpGroup.visible=!0):3===n.game.battleScene&&(n.bg.tilePosition.y=0,n.dragon.visible=!0,n.ndpGroup.visible=!0)},n.createWorld=function(){n.game.world.width=940,n.game.world.height=2500,n.bg=n.game.add.tileSprite(0,0,n.game.world.width,n.game.world.height,"bg-textures","grass.png"),n.game.player=new d.Player(n.game,0,0,"sprites","",n.game.data.players.jasonKenney),n.game.player.alpha=0,n.game.sceneItemsGroup=n.game.add.group(),n.game.sceneItemsGroup.add(n.bg),n.game.sceneItemsGroup.add(n.game.player),n.ndpGroup=n.game.add.group(),n.ucpGroup=n.game.add.group(),n.game.dialogue=new c.Dialogue(n.game),n.game.sfx=n.game.add.audioSprite("sfx")},n.createNDPArmy=function(){var e=["truck","truck","truck","siege-tower","smartcar","truck","smartcar","smartcar","truck","truck"],t=["smartcar","truck","smartcar","truck","truck","smartcar","siege-tower","truck","truck","smartcar"];e.forEach(function(e,t){n.setVehicle(e,t,"drive-down",100)}),t.forEach(function(e,t){n.setVehicle(e,t,"drive-down",320)}),n.dragon=new g.Dragon(n.game,n.game.camera.width/2,-n.game.camera.height/2,"sprites","");var a={character:"Rachel Notley",dI:15,id:16,key:"npc",name:"Rachel Notley",portrait:"notley",static:!0,type:"npc"},o=new m.NPC(n.game,0,-50,"sprites","",a);o.body.collideWorldBounds=!1,n.dragon.addChild(o);var i=n.dragon.children[12];n.dragon.children[12]=n.dragon.children[13],n.dragon.children[13]=i,n.ndpGroup.add(n.dragon)},n.createUCPArmy=function(){var e=new u.Obj(n.game,n.game.camera.width/2,180,"sprites","",{objectType:"truck",colour:"blue",type:"object",direction:"0,1"});e.animations.play("drive-up"),n.ucpGroup.add(e);var t=["truck","truck","siege-tower","truck","truck","truck","siege-tower","truck","truck","truck"],a=["truck","truck","truck","truck","siege-tower","truck","truck","truck","truck","truck"];t.forEach(function(e,t){n.setVehicle(e,t,"drive-up",400)}),a.forEach(function(e,t){n.setVehicle(e,t,"drive-up",560)})},n.startSequence=function(){n.game.time.events.add(1200,function(){n.game.add.tween(n.dragon.cameraOffset).to({y:n.game.camera.height/2-100},1800,Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){n.dragon.scream(600,function(){var e=n.dragon.children[12];n.game.dialogue.initDialogue(null,e,!1,!0,!0)})})})},n.setVehicle=function(e,t,a,o){var i={objectType:e,type:"object"};"truck"===e?(i.colour=n.selectRandomColour(e),i.direction="0,"+("drive-down"===a?-1:1)):"smartcar"===e&&(i.colour=n.selectRandomColour(e));var r=new u.Obj(n.game,parseInt(90*t+(n.game.rnd.integerInRange(-12,12)+60)),parseInt(o+n.game.rnd.integerInRange(-12,12)),"sprites","",i);"truck"===e?r.animations.play(a):r.animations.play("drive"),"drive-down"===a?n.ndpGroup.add(r):n.ucpGroup.add(r),console.log("!!!NEW OBJECT",r)},n.selectRandomColour=function(e){var t=[];return t="truck"===e?["blue","red","black","green","yellow","grey"]:["green","orange"],t[n.game.rnd.integerInRange(0,t.length-1)]},r=a,i(n,r)}return r(t,e),s(t,[{key:"create",value:function(){this.game.battleScene=1,this.createWorld(),this.createNDPArmy(),this.createUCPArmy(),this.game.world.sendToBack(this.game.sceneItemsGroup),this.game.world.bringToTop(this.game.objGroup),this.game.world.bringToTop(this.ndpGroup),this.game.world.bringToTop(this.ucpGroup),this.game.world.bringToTop(this.game.dialogueGroup),console.log("!!!WORLD!!!!",this.game.world),this.startSequence()}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BootstrapState=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(1),l=function(e){return e&&e.__esModule?e:{default:e}}(s),h=a(6);t.BootstrapState=function(e){function t(){var e,a,i,r;n(this,t);for(var s=arguments.length,l=Array(s),h=0;h<s;h++)l[h]=arguments[h];return a=i=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.Webfontconfig=null,i.blackScreen=null,i.warningText=null,r=a,o(i,r)}return i(t,e),r(t,[{key:"preload",value:function(){this.load.image("loader","assets/images/loader.png")}},{key:"create",value:function(){this.game.stage.backgroundColor="#000000",this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.device.desktop||(this.orientation=new h.Orientation(this.game)),this.game.scale.refresh(),this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.trigger(l.default.BOOTSTRAP_COMPLETED)}},{key:"update",value:function(){}},{key:"render",value:function(){}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ExampleState=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(14),h=(n(l),a(1)),c=n(h),u=a(0),d=n(u),g=a(5),m=a(6),p=a(9),y=a(16),f=a(40),v=a(50),b=a(39),w=a(8);t.ExampleState=function(e){function t(){var e,a,n,r;o(this,t);for(var s=arguments.length,l=Array(s),h=0;h<s;h++)l[h]=arguments[h];return a=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.map=null,n.layer=null,n.pad=null,n.playerMovement={},n.healthPanel=null,r=a,i(n,r)}return r(t,e),s(t,[{key:"create",value:function(){var e=this;console.log("!!!GAME START!!!",this.game),d.default.mixin(this),this.physics.startSystem(Phaser.Physics.ARCADE),this.physics.arcade.gravity.y=0,console.log("stageInitFunction is:",this.game.stageInitFunction[0]),this.game.currentStage=this.game.currentStage||"kq02-calgary-00",this.game.currentCharacter=this.game.currentCharacter||"jasonKenney",this.game.player=new g.Player(this.game,this.game.startingPosition[0],this.game.startingPosition[1],"sprites","",this.game.data.players[this.game.currentCharacter]),this.game.mapWorld=new w.Map(this,this.game,this.game.currentStage,"_WORLD-TILES-MASTER"),this.game.mapWorld.isDungeon=this.game.atlas[this.game.currentStage].isDungeon,this.game.mapWorld.isDungeon?(this.playerMovement={forward:"armed-forward",backward:"armed-backward",right:"armed-left",left:"armed-right"},this.game.player.animations.play("armed-forward").stop()):(this.playerMovement={forward:"walk-forward",backward:"walk-backward",right:"walk-left",left:"walk-right"},this.game.player.animations.play("walk-forward").stop()),this.camera.follow(this.game.player),this.game.foregroundLayer.bringToTop(),this.game.world.bringToTop(this.game.waypointGroup),this.game.projectileGroup=this.add.group(),this.game.UIGroup=this.add.group(),this.game.inventoryButton=new f.InventoryButton(this.game,this.game.camera.width-55,55,"sprites"),this.game.UIGroup.add(this.game.inventoryButton),this.game.questsButton=new v.QuestsButton(this.game,this.game.camera.width-155,55,"sprites"),this.game.UIGroup.add(this.game.questsButton),this.game.healthIconGroup=this.game.add.group(),this.game.healthPanel=new b.HealthPanel(this.game,this),this.game.dialogue=new p.Dialogue(this.game),this.game.scale.compatibility.supportsFullScreen&&(this.game.fullscreenButton=new y.FullscreenButton(this.game,20,25,"sprites")),this.game.globalAchievements.crystalsLive&&"jasonKenney"===this.game.currentCharacter&&this.game.player.displayCrystals(),this.game.device.desktop?(this.game.controls.dpad=this.game.input.keyboard.createCursorKeys(),console.log(this.game.controls.dpad),this.game.controls.apad=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.game.controls.apad.onDown.add(this.pressButtonA,this),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.SPACEBAR,Phaser.Keyboard.DOWN,Phaser.Keyboard.UP]),this.game.controls.inventory=this.game.input.keyboard.addKey(Phaser.Keyboard.I),this.game.controls.quests=this.game.input.keyboard.addKey(Phaser.Keyboard.U),this.game.controls.inventory.onDown.add(this.game.inventoryButton.initInventory,this.game.inventoryButton),this.game.controls.quests.onDown.add(this.game.questsButton.initQuests,this.game.questsButton)):(this.orientation=new m.Orientation(this.game),this.game.controls.pad&&this.game.controls.pad.destroy(),this.game.controls.pad=this.game.plugins.add(Phaser.VirtualJoystick),this.game.controls.stick=this.game.controls.pad.addStick(0,0,100,"generic"),this.game.controls.stick.alignBottomLeft(20),this.game.controls.buttonA=this.game.controls.pad.addButton(0,0,"generic","button1-up","button1-down"),this.game.controls.buttonA.alignBottomRight(20),this.game.controls.buttonA.onDown.add(this.pressButtonA,this)),this.game.dialogue.on("dialogueEngaged",this.pauseSprites,this),this.game.inventoryButton.on("inventoryEngaged",this.pauseSprites,this),this.game.questsButton.on("questsEngaged",this.pauseSprites,this),this.game.dialogue.on("dialogueClosed",this.activateSprites,this),this.game.inventoryButton.on("inventoryClosed",this.activateSprites,this),this.game.questsButton.on("questsClosed",this.activateSprites,this),this.game.toggleInput=function(t){null===t?e.game.device.desktop?e.game.input.keyboard.enabled:e.game.input.touch.enabled:e.game.device.desktop?e.game.input.keyboard.enabled=t:e.game.input.touch.enabled=t},this.game.globalAchievements.marchToWar||(this.game.musicHandler.musicSprite=this.game.add.audioSprite("music"),this.game.musicHandler.play()),this.game.sfx=this.game.add.audioSprite("sfx"),this.game.onBlur.add(this.inactive,this),this.game.onFocus.add(this.resume,this),this.game.scale.refresh(),this.game.trigger(c.default.EXAMPLE_COMPLETED),console.log(this.game.stageInitFunction),this.game.stageDismissFunction[0]="",""!==this.game.stageInitFunction[0]&&(this.game.stageInitFunction[0](),this.game.stageInitFunction[0]="",console.log(this.game.stageInitFunction)),console.log("!!!GAME SETUP END!!!",this.game)}},{key:"inactive",value:function(){this.game.musicHandler.pause()}},{key:"resume",value:function(){this.game.musicHandler.resume()}},{key:"resize",value:function(){}},{key:"update",value:function(){if(this.game.foregroundLayer.alpha=1,this.physics.arcade.collide(this.game.player,this.game.enemyGroup),this.physics.arcade.collide(this.game.player,this.game.NPCGroup,this.playerNpcCollision),this.physics.arcade.collide(this.game.player,this.game.collisionLayer),this.physics.arcade.collide(this.game.player,this.game.projectileGroup,this.hitPlayer,null,this),this.physics.arcade.collide(this.game.player,this.game.objGroup),this.physics.arcade.collide(this.game.NPCGroup,this.game.collisionLayer),this.physics.arcade.collide(this.game.enemyGroup,this.game.collisionLayer),this.physics.arcade.overlap(this.game.player,this.game.stagesGroup,this.game.mapWorld.changeStage,null,this),this.physics.arcade.collide(this.game.player,this.game.foregroundLayer,this.game.mapWorld.fadeForeground,null,this),this.physics.arcade.overlap(this.game.player,this.game.pickupGroup,this.game.mapWorld.pickupItem,null,this),this.physics.arcade.overlap(this.game.player,this.game.triggerGroup,this.game.mapWorld.triggerFunction,null,this),this.game.player.health<=0)return void this.gameOver();this.game.player.isAttacking||this.game.player.isHit||this.game.player.isTalking||this.game.player.inventoryActive||this.game.player.questsActive||(this.game.device.desktop?this.game.controls.dpad.up.isDown?this.game.controls.dpad.left.isDown?this.game.player.body.velocity.set(-this.game.player.maxSpeed,-this.game.player.maxSpeed):this.game.controls.dpad.right.isDown?this.game.player.body.velocity.set(this.game.player.maxSpeed,-this.game.player.maxSpeed):(this.game.player.body.velocity.set(0,-this.game.player.maxSpeed),this.game.player.animations.play(this.playerMovement.backward)):this.game.controls.dpad.down.isDown?this.game.controls.dpad.left.isDown?this.game.player.body.velocity.set(-this.game.player.maxSpeed,this.game.player.maxSpeed):this.game.controls.dpad.right.isDown?this.game.player.body.velocity.set(this.game.player.maxSpeed,this.game.player.maxSpeed):(this.game.player.body.velocity.set(0,this.game.player.maxSpeed),this.game.player.animations.play(this.playerMovement.forward)):this.game.controls.dpad.left.isDown?(this.game.player.body.velocity.set(-this.game.player.maxSpeed,0),this.game.player.animations.play(this.playerMovement.left)):this.game.controls.dpad.right.isDown?(this.game.player.body.velocity.set(this.game.player.maxSpeed,0),this.game.player.animations.play(this.playerMovement.right)):this.game.player.isHit||this.game.player.isAttacking||(this.game.player.body.velocity.set(0),this.game.player.animations.stop()):this.game.controls.stick.isDown?(this.physics.arcade.velocityFromRotation(this.game.controls.stick.rotation,280*this.game.controls.stick.force,this.game.player.body.velocity),this.game.controls.stick.rotation>-.75&&this.game.controls.stick.rotation<=.75?this.game.player.animations.play(this.playerMovement.right):this.game.controls.stick.rotation>.75&&this.game.controls.stick.rotation<=2.25?this.game.player.animations.play(this.playerMovement.forward):this.game.controls.stick.rotation>-2.25&&this.game.controls.stick.rotation<=-.75?this.game.player.animations.play(this.playerMovement.backward):this.game.player.animations.play(this.playerMovement.left)):this.game.player.isHit||(this.game.player.body.velocity.set(0),this.game.player.animations.stop()))}},{key:"pressButtonA",value:function(){var e=this;if(!this.game.dialogue.windowTween.isRunning){this.game.globalAchievements.marchToWar||(this.game.player.isTalking?function(){e.game.player.isTalking&&!e.game.player.inventoryActive?e.game.dialogue.nextDialogue():e.game.inventoryButton.select()}():this.game.player.engage())}}},{key:"playerMove",value:function(){console.log("hey ho")}},{key:"render",value:function(){}},{key:"gameOver",value:function(){this.game.musicHandler.stop(),this.game.state.start("Gameover")}},{key:"togglePlayerControls",value:function(e){}},{key:"playerNpcCollision",value:function(e,t){e.body.velocity.set(0)}},{key:"toggleMobileControls",value:function(e){this.game.controls.stick.visible=e,this.game.controls.buttonA.visible=e}},{key:"pauseSprites",value:function(){this.game.player.body.velocity.setTo(0),this.game.player.animations.stop(),this.game.device.desktop||this.toggleMobileControls(!1),this.game.enemyGroup.children.forEach(function(e){e.data&&e.data.isShooter&&e.shootingTimer.pause()})}},{key:"activateSprites",value:function(){this.game.device.desktop||this.toggleMobileControls(!0),this.game.enemyGroup.children.forEach(function(e){e.data&&e.data.isShooter&&e.shootingTimer.resume()}),this.game.NPCGroup.children.forEach(function(e){})}},{key:"hitPlayer",value:function(e,t){t.hitPlayer()}},{key:"killProjectile",value:function(e,t){e.kill()}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GameoverState=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(1),l=(function(e){e&&e.__esModule}(s),a(5));t.GameoverState=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),r(t,[{key:"create",value:function(){var e=this;this.game.player=new l.Player(this.game,(this.game.camera.x+this.game.camera.width)/2,(this.game.camera.y+this.game.camera.height)/2,"sprites","",this.game.data.players.jasonKenney),this.game.musicHandler.play("theme-gameOver"),this.game.player.animations.play("death"),this.game.add.tween(this.game.player.position).to({x:this.game.camera.width/2,y:this.game.camera.height/2},2e3,"Quad.easeOut").start().onComplete.addOnce(function(){e.gameoverSetup()})}},{key:"gameoverSetup",value:function(){this.game.player.animations.stop(),this.game.player.frameName="hero-death/_01.png",this.gameoverText=this.game.add.bitmapText(this.game.camera.width/2,100,"VT323","Game Over",42),this.gameoverText.fixedToCamera=!0,this.gameoverText.anchor.setTo(.5),this.gameoverText.align="center",this.gameoverText.scale.setTo(1.2),this.continueButton=this.game.add.bitmapText(this.game.camera.width/2,this.game.camera.height/2+100,"VT323","Continue?",36),this.continueButton.fixedToCamera=!0,this.continueButton.align="center",this.continueButton.anchor.setTo(.5),this.continueButton.inputEnabled=!0,this.continueButton.useHandCursor=!0,this.continueButton.events.onInputDown.add(this.continueGame,this);var e=this.game.add.sprite(this.continueButton.x-72,this.continueButton.y,"pointer");e.fixedToCamera=!0,e.scale.setTo(.26),e.anchor.setTo(1,.5),this.game.controls.apad=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.game.controls.apad.onDown.add(this.continueGame,this)}},{key:"continueGame",value:function(){this.game.controls.apad.onDown.removeAll(),this.game.data.players.jasonKenney.health=this.game.data.players.jasonKenney.maxHealth,this.game.state.start("Game")}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.IntroState=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(1),h=(n(l),a(0)),c=(n(h),a(6),a(9)),u=(a(16),a(4)),d=a(8),g=a(5),m=a(10),p=a(3),y=a(11);t.IntroState=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),s(t,[{key:"create",value:function(){var e=this;this.game.musicHandler.musicSprite=this.game.add.audioSprite("music"),this.game.musicHandler.play("theme-intro"),this.game.controls.apad=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.game.controls.apad.onDown.addOnce(this.skipIntroAction,this),this.game.stage.disableVisibilityChange=!0,this.cutscene=!1,this.fadeScreen=this.game.add.graphics(),this.fadeScreen.beginFill(0),this.fadeScreen.drawRect(0,0,this.game.camera.width,this.game.camera.height),this.fadeScreen.endFill(),this.fadeScreen.fixedToCamera=!0,this.fadeScreen.alpha=0,this.fadeScreen.visible=!1,this.cutTime=41500,this.game.time.events.add(this.cutTime,function(){console.log("FIRE!@!!!"),e.fadeScreen.visible=!0,e.fadeTween=e.game.add.tween(e.fadeScreen).to({alpha:1},2e3,"Quad.easeOut").start(),e.fadeTween.onComplete.add(function(){e.game.musicHandler.stop(),e.bmd.clear(),e.scene1Group.visible=!1,e.trees.destroy(),e.g1.destroy(),e.cloud1.destroy(),e.screenText.destroy(),e.secondaryText.destroy(),e.bmd.clear(0,0,0,0),e.cutScene()}),console.log("Switching scene")}),this.game.objGroup=this.game.add.group(),this.text=["'Alberta cries out...","...and my destiny grows clearer.'","The National Post presents","Kenney's Quest","Episode 2"],this.bmd=this.game.add.bitmapData(this.game.camera.width,this.game.camera.height),this.createGradientBG(857382,2175574),this.textGroup=this.game.add.group(),this.scene1Group=this.game.add.group(),this.scene1Group.visible=!1,this.screenText=this.add.bitmapText(this.game.camera.width/2,this.game.camera.height/2,"VT323",this.text[0],32,this.textGroup),this.screenText.alpha=0,this.screenText.fixedToCamera=!0,this.screenText.anchor.setTo(.5),this.game.world.add(this.screenText),this.m3=this.game.add.tileSprite(0,this.game.camera.height/2+20,this.game.camera.width,this.game.camera.height/2,"bg-textures","intro-mountains-03.png"),this.m2=this.game.add.tileSprite(0,this.game.camera.height/2+4,this.game.camera.width,this.game.camera.height/2,"bg-textures","intro-mountains-02.png"),this.m1=this.game.add.tileSprite(0,0,this.game.camera.width,this.game.camera.height/1.5,"bg-textures","intro-mountains-01.png"),this.g1=this.game.add.tileSprite(this.game.camera.width/2,this.game.camera.height,this.game.camera.width,this.game.camera.height/1.3,"bg-textures","snow.png"),this.bg1=this.game.add.sprite(0,0,"bg-textures","intro-clouds-01.png"),this.g1.visible=!1,this.g1.fixedToCamera=!0,this.g1.anchor.setTo(.5),this.bg1.visible=!1,this.bg1.fixedToCamera=!0,this.bg1.scale.setTo(2),this.m1.visible=!1,this.m1.tileScale={x:2.8,y:2.8},this.m2.tileScale={x:2.24,y:2.24},this.m3.tileScale={x:2,y:2},this.mountainsMovingX=!0,this.mountainsMovingY=!1,this.m1.fixedToCamera=!0,this.m2.fixedToCamera=!0,this.m3.fixedToCamera=!0,this.scene1Group.add(this.m3),this.scene1Group.add(this.m2),this.scene1Group.add(this.m1),this.scene1Group.add(this.bg1);var t={objectType:"truck",type:"object",colour:"blue",direction:"1,1"};this.truck=new u.Obj(this.game,this.game.camera.width/2,this.game.camera.height/1.26,"sprites","",t),this.truck.animations.play("drive-up"),this.truck.fixedToCamera=!0,this.truck.visible=!1;var a=this.game.camera;this.cloud1=this.game.add.sprite(-80,-80,"bg-textures","cloud-01.png"),this.cloud1.fixedToCamera=!0,this.cloud1.alpha=.8,this.cloud1.scale.setTo(3),this.cloud1.anchor.setTo(.5),this.cloud1.visible=!1,this.cloud2=this.game.add.sprite(a.width/1.5,-100,"bg-textures","cloud-01.png"),this.cloud2.fixedToCamera=!0,this.cloud2.alpha=.6,this.cloud2.scale.setTo(3.2),this.cloud2.anchor.setTo(.5),this.cloud2.visible=!1,this.cloud3=this.game.add.sprite(a.width/2.1,a.height+120,"bg-textures","cloud-01.png"),this.cloud3.fixedToCamera=!0,this.cloud3.alpha=.85,this.cloud3.scale.setTo(3.35),this.cloud3.anchor.setTo(.5),this.cloud3.visible=!1,this.skipButton=new y.NextButton(this.game,this.game.camera.width-80,this.game.camera.height-80),this.skipText=this.add.bitmapText(this.skipButton.x-55,this.skipButton.y,"VT323","SKIP",38),this.skipText.anchor.setTo(1,.5),this.skipButton.events.onInputDown.add(this.skipIntroAction,this),this.timing=200;var n=Phaser.Device.firefox?3100:800;this.game.time.events.add(n,function(){e.firstStep()})}},{key:"update",value:function(){this.fadeScreen&&this.game.world.bringToTop(this.fadeScreen),this.skipButton&&(this.game.world.bringToTop(this.skipButton),this.game.world.bringToTop(this.skipText)),this.cutscene||(this.mountainsMovingX?(this.m1.tilePosition.x-=.5,this.m2.tilePosition.x-=.28,this.m3.tilePosition.x-=.06):this.mountainsMovingY?(this.m2.cameraOffset.y-=.1,this.m3.cameraOffset.y-=.05,this.g1.tilePosition.y+=.42):this.g1MovingX?this.g1.tilePosition.x-=2.5:this.g1MovingY&&(this.g1.tilePosition.y-=2),this.trees&&(this.trees.tilePosition.x-=3))}},{key:"skipIntroAction",value:function(){var e=this;console.log("skipping"),this.camera.fade(0,300),this.camera.onFadeComplete.add(function(){e.game.musicHandler.stop(),e.game.state.start("StartMenu")})}},{key:"firstStep",value:function(){var e=this;this.textTween=this.game.add.tween(this.screenText).to({alpha:1},800,"Quad.easeOut").start(),this.textTween.onComplete.add(function(){e.game.time.events.add(2800,function(){e.secondStep()})})}},{key:"secondStep",value:function(){var e=this;this.textTween=this.game.add.tween(this.screenText).to({alpha:0},600,"Quad.easeOut").start(),this.textTween.onComplete.add(function(){e.game.time.events.add(500,function(){e.screenText.setText(e.text[1]),e.thirdStep()})})}},{key:"thirdStep",value:function(){var e=this;this.textTween=this.game.add.tween(this.screenText).to({alpha:1},600,"Quad.easeOut").start(),this.textTween.onComplete.add(function(){e.game.time.events.add(2500,function(){e.fourthStep()})})}},{key:"fourthStep",value:function(){var e=this;this.textTween=this.game.add.tween(this.screenText).to({alpha:0},600,"Quad.easeOut").start(),this.textTween.onComplete.add(function(){e.fifthStep()})}},{key:"fifthStep",value:function(){var e=this;this.bmd.addToWorld(),this.game.world.bringToTop(this.scene1Group),this.game.world.bringToTop(this.textGroup),this.screenText=this.add.bitmapText(this.game.camera.width/2,this.game.camera.height/2-100,"kingsQuest",this.text[2],32,this.textGroup),this.screenText.anchor.setTo(.5),this.screenText.alpha=1,this.scene1Group.visible=!0,this.game.time.events.add(5e3,function(){e.textTween=e.game.add.tween(e.screenText).to({alpha:0},600,"Quad.easeOut").start(),e.textTween.onComplete.add(function(){e.game.time.events.add(500,e.sixthStep,e)})})}},{key:"sixthStep",value:function(){var e=this;this.screenText.fontSize=48,this.screenText.position.y=140,this.screenText.setText(this.text[3]),this.m2.height=this.game.camera.height/3,this.m3.height=this.game.camera.height/3,this.game.world.bringToTop(this.g1),this.g1.visible=!0,this.truck.visible=!0,this.game.world.bringToTop(this.game.objGroup),this.m2.tileScale={x:1.5,y:1.5},this.m3.tileScale={x:1.2,y:1.2},this.mountainsMovingX=!1,this.mountainsMovingY=!0,this.game.add.tween(this.screenText).to({alpha:1},600,"Quad.easeOut").start().onComplete.add(function(){e.secondaryText=e.add.bitmapText(e.game.camera.width/2,210,"kingsQuest",e.text[4],18,e.textGroup),e.secondaryText.fixedToCamera=!0,e.secondaryText.anchor.setTo(.5),e.secondaryText.alpha=0,e.game.add.tween(e.secondaryText).to({alpha:1},600,"Quad.easeOut").start(),e.game.time.events.add(5e3,function(){e.seventhStep()})})}},{key:"seventhStep",value:function(){var e=this;this.newTextTween=this.game.add.tween(this.textGroup).to({alpha:0},800,"Quad.easeOut").start(),this.newTextTween.onComplete.add(function(){e.m2.visible=!1,e.m3.visible=!1,e.mountainsMovingY=!1,e.g1MovingX=!0,e.truck.cameraOffset={x:-100,y:e.game.camera.height/1.5},e.truck.play("drive-LR"),e.game.world.bringToTop(e.game.objGroup),e.textTween=e.game.add.tween(e.truck.cameraOffset).to({x:e.game.camera.width+240},6e3).start(),e.createGradientBG(1734590,48013615,e.game.camera.height/1.5),e.g1.frameName="sunset-grass.png",e.g1.cameraOffset.y=e.game.camera.height-e.game.camera.height/10,e.bg1.visible=!0,2!==e.game.objGroup.children.length&&e.textTween.onComplete.add(function(){e.eighthStep()})})}},{key:"eighthStep",value:function(){var e=this;this.bg1.visible=!1,this.truck.cameraOffset.x=this.game.camera.width/2,this.truck.cameraOffset.y=this.game.camera.height/2,this.truck.play("drive-down"),this.g1.frameName="grass.png",this.g1.cameraOffset.x=this.game.camera.width/2,this.g1.cameraOffset.y=this.game.camera.height/2,this.g1.width=2*this.game.camera.width,this.g1.height=2*this.game.camera.height,this.g1MovingX=!1,this.g1MovingY=!0;var t=this.game.camera;this.cloud1.visible=!0,this.cloud2.visible=!0,this.cloud3.visible=!0,this.game.world.bringToTop(this.cloud1),this.game.world.bringToTop(this.cloud2),this.game.world.bringToTop(this.cloud3),this.game.time.events.add(1600,function(){e.game.add.tween(e.cloud1.scale).to({x:1.6,y:1.6},6e3,"Quad.easeOut").start(),e.game.add.tween(e.cloud1.cameraOffset).to({x:t.width/6,y:t.height/6},6e3,"Quad.easeOut").start(),e.game.add.tween(e.cloud2.scale).to({x:1.9,y:1.9},6e3,"Quad.easeOut").start(),e.game.add.tween(e.cloud2.cameraOffset).to({x:t.width/1.8,y:80},6e3,"Quad.easeOut").start(),e.game.add.tween(e.cloud3.scale).to({x:2.1,y:2.1},6e3,"Quad.easeOut").start(),e.game.add.tween(e.cloud3.cameraOffset).to({x:t.width/1.9,y:t.height-60},6e3,"Quad.easeOut").start(),e.scaleTween=e.game.add.tween(e.g1.scale).to({x:.75,y:.75},6e3,"Quad.easeOut").start(),e.textTween=e.game.add.tween(e.truck.scale).to({x:.75,y:.75},6e3,"Quad.easeOut").start(),e.game.time.events.add(6e3,function(){e.ninthStep()})})}},{key:"ninthStep",value:function(){this.cloud1.kill(),this.cloud2.kill(),this.cloud3.kill(),this.g1.frameName="grass.png",this.g1.tileScale={x:1,y:1},this.g1.anchor.setTo(.5,0),this.g1.cameraOffset.y=this.game.camera.height/2,this.g1MovingY=!1,this.g1MovingX=!0,this.m1.frameName="intro-mountains-01.png",this.m1.visible=!0,this.m1.tileScale={x:1.4,y:1.4},this.m1.height=this.game.camera.height/5,this.m1.cameraOffset.y=this.game.camera.height/2+30,this.m1.tilePosition.x=0,this.m1.anchor.setTo(0,1),this.trees=this.game.add.tileSprite(0,this.game.camera.height/2+50,this.game.camera.width,46,"bg-textures","trees.png"),this.trees.tileScale={x:2,y:2},this.trees.anchor.setTo(0,1),this.trees.fixedToCamera=!0,this.truck.cameraOffset.x=this.game.camera.width/2,this.truck.cameraOffset.y=this.game.camera.height/2,this.truck.play("drive-LR"),this.game.world.bringToTop(this.game.objGroup)}},{key:"cutScene",value:function(){var e=this;this.cutscene=!0,this.skipButton.destroy(),this.skipText.destroy(),this.trees.destroy(),this.cloud1.destroy(),this.cloud2.destroy(),this.cloud3.destroy(),this.g1.destroy(),this.game.sfx=this.game.add.audioSprite("sfx"),this.game.controls.apad.onDown.remove(this.skipIntroAction,this),this.game.player=new g.Player(this.game,645,1500,"sprites","",this.game.data.players.jasonKenney),this.game.mapWorld=new d.Map(this,this.game,"kq02-intro","_WORLD-TILES-MASTER"),this.game.mapWorld.isDungeon=this.game.atlas["kq02-intro"],this.playerMovement={forward:"armed-forward",backward:"armed-backward",left:"armed-left",right:"armed-right"},this.game.player.play("armed-forward").stop(),this.game.player.alpha=0,this.game.camera.follow(this.game.player),this.game.dialogue=new c.Dialogue(this.game),this.truck.fixedToCamera=!1,this.truck.position.setTo(0,1500),this.scene1Group.visible=!0,this.m2.visible=!0,this.m3.visible=!0,this.scene1Group.bringToTop(this.m1),this.m1.cameraOffset.y=this.game.camera.width/1.8,this.m2.cameraOffset.y=this.game.camera.height/3.3,this.m3.cameraOffset.y=this.game.camera.height/3.9,this.game.world.moveUp(this.scene1Group),this.game.dragon=new m.Dragon(this.game,this.game.camera.width/2,-this.game.camera.height/2,"sprites","");var t={character:"Rachel Notley",dI:0,id:16,key:"npc",name:"Rachel Notley",portrait:"notley",static:!0,type:"npc"};this.game.camera.height;this.game.notley=new p.NPC(this.game,0,-50,"sprites","",t),this.game.dragon.addChild(this.game.notley);var a=this.game.dragon.children[12];this.game.dragon.children[12]=this.game.dragon.children[13],this.game.dragon.children[13]=a,this.game.sfx=this.game.add.audioSprite("sfx"),this.game.sfx.play("sfx_wind",.6),this.game.world.sendToBack(this.scene1Group),this.game.world.bringToTop(this.game.dragonGroup),this.fadeTween=this.game.add.tween(this.fadeScreen).to({alpha:0},1200,"Quad.easeOut").start(),this.fadeTween.onComplete.add(function(){e.fadeScreen.destroy(),e.cutSceneStart()})}},{key:"cutSceneStart",value:function(){var e=this;this.truck.visible=!0,this.truck.animations.play("drive-LR"),this.truckTween=this.game.add.tween(this.truck.position).to({x:this.game.world.width/2-100},2e3,"Quad.easeOut").start(),this.game.sfx.play("sfx_truck"),this.truckTween.onComplete.add(function(){e.truck.animations.stop(),e.game.time.events.add(1e3,function(){e.game.player.alpha=1,e.game.sfx.play("sfx_exit"),e.game.time.events.add(1200,function(){e.game.player.frameName="hero-mab/_01.png",e.game.actions.jump(e.game.player,110,200,function(){e.game.actions.walk(e.game.player,{x:0,y:-110},1e3,200,function(){e.game.dragon.dramaticEntrance(5e3,function(){e.game.time.events.add(1e3,function(){e.game.dragon.scream(1200,function(){e.game.actions.walk(e.game.notley,{x:60,y:0},200,300,function(){e.game.actions.walk(e.game.notley,{x:0,y:120},500,0,function(){e.game.dialogue=new c.Dialogue(e.game),e.game.controls.apad.onDown.add(e.game.dialogue.nextDialogue,e.game.dialogue),e.game.dialogue.initDialogue(null,e.game.notley,!0)})})})})})})})})})})}},{key:"cutScene1",value:function(){}},{key:"createGradientBG",value:function(e,t,a){for(var n=[],o=a||this.game.camera.height,i=o/60,r=0,s=0;s<60;s++){var l=Phaser.Color.interpolateColor(e,t,60,s);this.bmd.rect(0,r,this.game.camera.width,r+i,Phaser.Color.getWebRGB(l)),n.push(Phaser.Color.getWebRGB(l)),r+=i}}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingState=void 0;var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(1),l=function(e){return e&&e.__esModule?e:{default:e}}(s);t.LoadingState=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),r(t,[{key:"preload",value:function(){var e=this.add.image(this.world.centerX,this.world.centerY,"loader");e.anchor.set(.5,.5),this.load.setPreloadSprite(e),this.load.bitmapFont("VT323","assets/fonts/vt323.png","assets/fonts/vt323.xml"),this.load.bitmapFont("kingsQuest","assets/fonts/kingsQuest.png","assets/fonts/kingsQuest.xml"),this.load.image("_WORLD-TILES-MASTER","assets/images/_WORLD-TILES-MASTER.png"),this.load.image("pointer","assets/images/pointer.png"),this.load.atlas("generic","assets/skins/generic-joystick.png","assets/skins/generic-joystick.json"),this.load.atlas("sprites","assets/images/spriteAtlas_test.png","assets/maps/spriteAtlas_test.json"),this.load.atlas("portraits","assets/images/portraits-atlas.png","assets/maps/portraits-atlas.json"),this.load.atlas("bg-textures","assets/images/bg-textures.png","assets/maps/bg-textures.json"),this.load.atlas("bc-ndp","assets/images/bc-ndp-atlas.png","assets/maps/bc-ndp-atlas.json"),this.load.atlas("bosses-atlas","assets/images/bosses-atlas.png","assets/maps/bosses-atlas.json");var t=["assets/audio/music/musicSprite.ogg","assets/audio/music/musicSprite.mp3"];this.load.audiosprite("music",t,"assets/audio/music/musicSprite.json");var a=["assets/audio/sfx/sfxSprite.ogg","assets/audio/sfx/sfxSprite.mp3"];this.load.audiosprite("sfx",a,"assets/audio/sfx/sfxSprite.json"),this.load.image("bg-pantheon","assets/images/bg-pantheon.png"),this.load.image("bg-clouds","assets/images/bg-clouds.png"),this.load.tilemap("kq02-intro","assets/maps/kq02-intro.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-calgary-00","assets/maps/kq02-calgary-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-calgary-01","assets/maps/kq02-calgary-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-calgary-02","assets/maps/kq02-calgary-02.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-calgary-03","assets/maps/kq02-calgary-03.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-pantheon-00","assets/maps/kq02-pantheon-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-palace-00","assets/maps/kq02-palace-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-mountains-00","assets/maps/kq02-mountains-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-mountains-01","assets/maps/kq02-mountains-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-forest-00","assets/maps/kq02-forest-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-badlands-00","assets/maps/kq02-badlands-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-badlands-01","assets/maps/kq02-badlands-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-caves-00","assets/maps/kq02-caves-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-caves-01","assets/maps/kq02-caves-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-edmonton-00","assets/maps/kq02-edmonton-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-edmonton-01","assets/maps/kq02-edmonton-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-edmonton-02","assets/maps/kq02-edmonton-02.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-edmonton-03","assets/maps/kq02-edmonton-03.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-battle-00","assets/maps/kq02-battle-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-battle-01","assets/maps/kq02-battle-01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-airship-00","assets/maps/kq02-airship-00.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("kq02-truckstop-00","assets/maps/kq02-truckstop-00.json",null,Phaser.Tilemap.TILED_JSON)}},{key:"create",value:function(){var e=this;this.time.events.add(200,function(){e.game.trigger(l.default.LOADING_COMPLETED)})}},{key:"update",value:function(){}},{key:"render",value:function(){}}]),t}(Phaser.State)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StartMenuState=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(1),h=(n(l),a(0));n(h),a(6),a(8),a(5),t.StartMenuState=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),s(t,[{key:"create",value:function(){var e=this;this.game.musicHandler.play("theme-main"),this.sfx=this.game.add.audioSprite("sfx"),this.fadeScreen=this.add.graphics(),this.fadeScreen.beginFill(0),this.fadeScreen.drawRect(0,0,this.game.camera.width,this.game.camera.height),this.fadeScreen.endFill(),this.fadeScreen.fixedToCamera=!0,this.add.tween(this.fadeScreen).to({alpha:0},1e3,"Quad.easeOut",!0,100),this.bg=this.add.sprite(0,0,"bg-textures","startScreen-bg.png"),this.bg.fixedToCamera=!0,this.kenney=this.add.sprite(-this.game.camera.width/3.2,this.game.camera.height,"bg-textures","startScreen-kenney.png"),this.kenney.anchor.setTo(0,1),this.kenney.alpha=0,this.add.tween(this.kenney.position).to({x:0},600,"Quad.easeOut",!0,300),this.add.tween(this.kenney).to({alpha:1},600,"Quad.easeOut",!0,300),this.newGameButton=this.add.bitmapText(this.game.camera.width/1.5,this.game.camera.height/2.2,"kingsQuest","New Game",32),this.newGameButton.tint=0,this.newGameButton.alpha=0,this.newGameButton.inputEnabled=!0,this.newGameButton.anchor.setTo(0,.5),this.newGameButton.input.useHandCursor=!0,this.newGameButton.events.onInputDown.add(this.select,this),this.logo=this.add.sprite(this.newGameButton.x+40,this.game.camera.height/5.6,"bg-textures","logo.png"),this.logo.scale.setTo(.85),this.logo.anchor.setTo(.5),this.logo.alpha=0,this.logoTween=this.add.tween(this.logo).to({alpha:1},600,"Quad.easeOut",!0,300),this.ep2=this.add.bitmapText(this.logo.x+60,this.logo.y+62,"kingsQuest","Episode 2",18),this.ep2.tint=0,this.ep2.alpha=0,this.add.tween(this.ep2).to({alpha:1},1200,"Quad.easeOut",!0,1100),this.logoTween.onComplete.add(function(){e.pointer=e.add.sprite(e.newGameButton.x-25,e.newGameButton.y,"sprites","ui-pointer.png"),e.pointer.anchor.setTo(1,.5),e.pointer.alpha=0,e.add.tween(e.newGameButton).to({alpha:1},500,"Quad.easeOut",!0,200),e.add.tween(e.pointer).to({alpha:1},500,"Quad.easeOut",!0,200),e.game.controls.apad=e.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),e.game.controls.up=e.game.input.keyboard.addKey(Phaser.Keyboard.UP),e.game.controls.down=e.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),e.game.input.keyboard.addKeyCapture(Phaser.Keyboard.SPACEBAR,Phaser.Keyboard.UP,Phaser.Keyboard.DOWN),e.game.controls.apad.onDown.add(e.select,e),e.game.controls.up.onDown.add(e.down,e),e.game.controls.down.onDown.add(e.down,e),e.fadeScreen.destroy()})}},{key:"update",value:function(){this.fadeScreen&&this.game.world.bringToTop(this.fadeScreen)}},{key:"poop",value:function(){console.log("poop")}},{key:"select",value:function(){var e=this;this.sfx.play("sfx_dialogue_up"),this.camera.fade(0,800),this.camera.onFadeComplete.add(function(){e.game.musicHandler.stop(),e.game.stageInitFunction[0]=e.game.npcFunctions.newGameInitFunction_calgary_00,e.game.state.start("Game")})}},{key:"up",value:function(){this.sfx.play("sfx_dialogue_next")}},{key:"down",value:function(){this.sfx.play("sfx_dialogue_next")}}]),t}(Phaser.State)}]);